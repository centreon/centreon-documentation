"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[59921],{40113:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>p,default:()=>u,frontMatter:()=>o,metadata:()=>m,toc:()=>k});n(67294);var a=n(3905);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}function i(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},l=Object.keys(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}const o={id:"developer-broker-bbdo",title:"The BBDO protocol"},p=void 0,m={unversionedId:"developer/developer-broker-bbdo",id:"version-23.10/developer/developer-broker-bbdo",title:"The BBDO protocol",description:"The BBDO protocol has been created to be the default protocol of Centreon",source:"@site/versioned_docs/version-23.10/developer/developer-broker-bbdo.md",sourceDirName:"developer",slug:"/developer/developer-broker-bbdo",permalink:"/centreon-documentation/pr-preview/staging/pr-2806/docs/developer/developer-broker-bbdo",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/versioned_docs/version-23.10/developer/developer-broker-bbdo.md",tags:[],version:"23.10",lastUpdatedAt:1699872045,formattedLastUpdatedAt:"Nov 13, 2023",frontMatter:{id:"developer-broker-bbdo",title:"The BBDO protocol"},sidebar:"version-23.10/docs",previous:{title:"Stream connectors",permalink:"/centreon-documentation/pr-preview/staging/pr-2806/docs/developer/developer-broker-stream-connector"},next:{title:"Centreon Broker Event Mapping",permalink:"/centreon-documentation/pr-preview/staging/pr-2806/docs/developer/developer-broker-mapping"}},d={},k=[{value:"Introduction",id:"introduction",level:2},{value:"Types",id:"types",level:2},{value:"Packet format",id:"packet-format",level:2},{value:"Packet ID",id:"packet-id",level:3},{value:"Event categories",id:"event-categories",level:2},{value:"NEB",id:"neb",level:3},{value:"Storage",id:"storage",level:3},{value:"BBDO",id:"bbdo",level:3},{value:"BAM",id:"bam",level:3},{value:"Event serialization",id:"event-serialization",level:2},{value:"Example",id:"example",level:2},{value:"Connection establishment",id:"connection-establishment",level:2},{value:"Example",id:"example-1",level:3},{value:"Acknowledgement",id:"acknowledgement",level:2},{value:"Switching versions of BBDO",id:"switching-versions-of-bbdo",level:2}],N={toc:k},s="wrapper";function u(t){var{components:e}=t,n=i(t,["components"]);return(0,a.kt)(s,l(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),a.forEach((function(e){r(t,e,n[e])}))}return t}({},N,n),{components:e,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"The BBDO protocol has been created to be the default protocol of Centreon\nBroker. It is lightweight on the wire and easy to decode. It is especially\ndesigned for monitoring resources with Centreon Broker."),(0,a.kt)("h2",{id:"introduction"},"Introduction"),(0,a.kt)("p",null,'BBDO stands for Broker Binary Data Object. BBDO is designed to transfer\n"data packets" from one node to another. These "data packets" spend most of\nthe time monitoring information provided by the monitoring engine (e.g.\nCentreon Engine or Nagios). It uses mostly raw binary values, which\nallows it to consume very little memory.'),(0,a.kt)("p",null,"With Broker 22.04.0, we introduced a new version of BBDO. It is based on\n",(0,a.kt)("a",{parentName:"p",href:"https://developers.google.com/protocol-buffers"},"Google Protobuf 3"),". The new\nprotocol remains compatible with the previous one, but introduces\nnew events. For example, PbService and PbServiceStatus events are\nsent instead of Service and ServiceStatus events. Configured with BBDO 3, Broker\nstill understands Service and ServiceStatus events, but by default it should\nsend the new versions."),(0,a.kt)("h2",{id:"types"},"Types"),(0,a.kt)("p",null,"This section is about BBDO 2."),(0,a.kt)("p",null,"As a binary protocol, BBDO uses data types to serialize data. They are\nwritten in a Big Endian format and described in the following table."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Representation"),(0,a.kt)("th",{parentName:"tr",align:null},"Size (bytes)"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"integer"),(0,a.kt)("td",{parentName:"tr",align:null},"binary"),(0,a.kt)("td",{parentName:"tr",align:null},"4")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"short integer"),(0,a.kt)("td",{parentName:"tr",align:null},"binary"),(0,a.kt)("td",{parentName:"tr",align:null},"2")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"long integer"),(0,a.kt)("td",{parentName:"tr",align:null},"binary"),(0,a.kt)("td",{parentName:"tr",align:null},"8")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"time"),(0,a.kt)("td",{parentName:"tr",align:null},"binary (timestamp)"),(0,a.kt)("td",{parentName:"tr",align:null},"8")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"boolean"),(0,a.kt)("td",{parentName:"tr",align:null},"binary (0 is false, everything else is true)"),(0,a.kt)("td",{parentName:"tr",align:null},"1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"string"),(0,a.kt)("td",{parentName:"tr",align:null},"nul-terminated UTF-8 string"),(0,a.kt)("td",{parentName:"tr",align:null},"variable")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"real"),(0,a.kt)("td",{parentName:"tr",align:null},"nul-terminated UTF-8 string (either in fixed (2013) or scientific (2.013e+3) format)"),(0,a.kt)("td",{parentName:"tr",align:null},"variable")))),(0,a.kt)("h2",{id:"packet-format"},"Packet format"),(0,a.kt)("p",null,"The packet format of Centreon Broker introduces only 16 bytes of header\nto transmit each monitoring event (usually about 100-200 bytes each).\nFields are provided in the big endian format."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Field"),(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"checksum"),(0,a.kt)("td",{parentName:"tr",align:null},"unsigned short integer"),(0,a.kt)("td",{parentName:"tr",align:null},"CRC-16-CCITT X.25 of size, id, source and destination. The checksum can be used to recover from an incomplete data packet sent in the stream by dropping bytes one by one.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"size"),(0,a.kt)("td",{parentName:"tr",align:null},"unsigned short integer"),(0,a.kt)("td",{parentName:"tr",align:null},"Size of the packet, excluding header.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"id"),(0,a.kt)("td",{parentName:"tr",align:null},"unsigned integer"),(0,a.kt)("td",{parentName:"tr",align:null},"ID of the event.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"source_id"),(0,a.kt)("td",{parentName:"tr",align:null},"unsigned integer"),(0,a.kt)("td",{parentName:"tr",align:null},"The id of the source instance of this event.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"destination_id"),(0,a.kt)("td",{parentName:"tr",align:null},"unsigned integer"),(0,a.kt)("td",{parentName:"tr",align:null},"The id of the destination instance for this event.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"data"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"Payload data.")))),(0,a.kt)("p",null,"Here, the only difference between BBDO 3 and the previous versions is the data\ncontent. In BBDO 3, this part is a serialized Protobuf object, whereas in\nprevious versions it is data serialized as explained in the Types section."),(0,a.kt)("h3",{id:"packet-id"},"Packet ID"),(0,a.kt)("p",null,"As seen in the previous paragraph, every packet holds an ID that expresses\nby itself how data is encoded. This ID can be split into two 16-bit\ncomponents. The 16 most significant bits are the event category and the\n16 least significant bits the event type."),(0,a.kt)("p",null,"The event categories serialize event properties one after the other, so\norder is very important to not lose track when unserializing events."),(0,a.kt)("h2",{id:"event-categories"},"Event categories"),(0,a.kt)("p",null,"The current available categories are described in the table below."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Category"),(0,a.kt)("th",{parentName:"tr",align:null},"API macro"),(0,a.kt)("th",{parentName:"tr",align:null},"Value"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"NEB"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO_NEB_TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"Classical monitoring events (hosts, services, notifications, event handlers, plugin execution, ...).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"BBDO"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO_BBDO_TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"Category internal to the BBDO protocol.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Storage"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO_STORAGE_TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"Category related to RRD graph building.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Correlation"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO_CORRELATION_TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"4"),(0,a.kt)("td",{parentName:"tr",align:null},"Status correlation (deprecated).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dumper"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO_DUMPER_TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"5"),(0,a.kt)("td",{parentName:"tr",align:null},"Dumper events (only used for tests).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Bam"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO_BAM_TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"6"),(0,a.kt)("td",{parentName:"tr",align:null},"Bam events.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Extcmd"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO_EXTCMD_TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"7"),(0,a.kt)("td",{parentName:"tr",align:null},"Centreon Broker external commands (deprecated).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Internal"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO_INTERNAL_TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"65535"),(0,a.kt)("td",{parentName:"tr",align:null},"Reserved for internal protocol use.")))),(0,a.kt)("h3",{id:"neb"},"NEB"),(0,a.kt)("p",null,"The table below lists event types available in the NEB category. They\nmust be mixed with the BBDO_NEB_TYPE category to get a BBDO event ID."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Value"),(0,a.kt)("th",{parentName:"tr",align:null},"Uses Protobuf"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Acknowledgement"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Comment"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Custom variable"),(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Custom variable status"),(0,a.kt)("td",{parentName:"tr",align:null},"4"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Downtime"),(0,a.kt)("td",{parentName:"tr",align:null},"5"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Event handler"),(0,a.kt)("td",{parentName:"tr",align:null},"6"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host check"),(0,a.kt)("td",{parentName:"tr",align:null},"8"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host dependency"),(0,a.kt)("td",{parentName:"tr",align:null},"9"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host group"),(0,a.kt)("td",{parentName:"tr",align:null},"10"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host group member"),(0,a.kt)("td",{parentName:"tr",align:null},"11"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host"),(0,a.kt)("td",{parentName:"tr",align:null},"12"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host parent"),(0,a.kt)("td",{parentName:"tr",align:null},"13"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host status"),(0,a.kt)("td",{parentName:"tr",align:null},"14"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Instance"),(0,a.kt)("td",{parentName:"tr",align:null},"15"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Instance status"),(0,a.kt)("td",{parentName:"tr",align:null},"16"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Log entry"),(0,a.kt)("td",{parentName:"tr",align:null},"17"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Module"),(0,a.kt)("td",{parentName:"tr",align:null},"18"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service check"),(0,a.kt)("td",{parentName:"tr",align:null},"19"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service dependency"),(0,a.kt)("td",{parentName:"tr",align:null},"20"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service group"),(0,a.kt)("td",{parentName:"tr",align:null},"21"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service group member"),(0,a.kt)("td",{parentName:"tr",align:null},"22"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service"),(0,a.kt)("td",{parentName:"tr",align:null},"23"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service status"),(0,a.kt)("td",{parentName:"tr",align:null},"24"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Instance Configuration"),(0,a.kt)("td",{parentName:"tr",align:null},"25"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Responsive Instance"),(0,a.kt)("td",{parentName:"tr",align:null},"26"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Service"),(0,a.kt)("td",{parentName:"tr",align:null},"27"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Adaptive Service"),(0,a.kt)("td",{parentName:"tr",align:null},"28"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Service Status"),(0,a.kt)("td",{parentName:"tr",align:null},"29"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Host"),(0,a.kt)("td",{parentName:"tr",align:null},"30"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Adaptive Host"),(0,a.kt)("td",{parentName:"tr",align:null},"31"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Host Status"),(0,a.kt)("td",{parentName:"tr",align:null},"32"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Severity"),(0,a.kt)("td",{parentName:"tr",align:null},"33"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Tag"),(0,a.kt)("td",{parentName:"tr",align:null},"34"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Comment"),(0,a.kt)("td",{parentName:"tr",align:null},"35"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Downtime"),(0,a.kt)("td",{parentName:"tr",align:null},"36"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Custom variable"),(0,a.kt)("td",{parentName:"tr",align:null},"37"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Custom variable status"),(0,a.kt)("td",{parentName:"tr",align:null},"38"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Host check"),(0,a.kt)("td",{parentName:"tr",align:null},"39"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Service check"),(0,a.kt)("td",{parentName:"tr",align:null},"40"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Log entry"),(0,a.kt)("td",{parentName:"tr",align:null},"41"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Instance Status"),(0,a.kt)("td",{parentName:"tr",align:null},"42"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Instance"),(0,a.kt)("td",{parentName:"tr",align:null},"44"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Acknowledgement"),(0,a.kt)("td",{parentName:"tr",align:null},"45"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Responsive Instance"),(0,a.kt)("td",{parentName:"tr",align:null},"46"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")))),(0,a.kt)("h3",{id:"storage"},"Storage"),(0,a.kt)("p",null,"The table below lists event types available in the Storage category.\nThey must be mixed with the BBDO","_","STORAGE","_","TYPE category to get a BBDO\nevent ID."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Value"),(0,a.kt)("th",{parentName:"tr",align:null},"Uses Protobuf"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Metric"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Rebuild"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Remove","_","graph"),(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Status"),(0,a.kt)("td",{parentName:"tr",align:null},"4"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Index mapping"),(0,a.kt)("td",{parentName:"tr",align:null},"5"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Metric mapping"),(0,a.kt)("td",{parentName:"tr",align:null},"6"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Rebuild Message"),(0,a.kt)("td",{parentName:"tr",align:null},"7"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Remove Graph Message"),(0,a.kt)("td",{parentName:"tr",align:null},"8"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Metric"),(0,a.kt)("td",{parentName:"tr",align:null},"9"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Status"),(0,a.kt)("td",{parentName:"tr",align:null},"10"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Index mapping"),(0,a.kt)("td",{parentName:"tr",align:null},"11"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Metric mapping"),(0,a.kt)("td",{parentName:"tr",align:null},"12"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")))),(0,a.kt)("h3",{id:"bbdo"},"BBDO"),(0,a.kt)("p",null,"The table below lists event types available in the BBDO category.\nThey must be mixed with the BBDO","_","BBDO","_","TYPE category to get a BBDO\nevent ID."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Value"),(0,a.kt)("th",{parentName:"tr",align:null},"Uses Protobuf"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"version response"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"ack"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"stop"),(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb ack"),(0,a.kt)("td",{parentName:"tr",align:null},"8"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb stop"),(0,a.kt)("td",{parentName:"tr",align:null},"9"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")))),(0,a.kt)("h3",{id:"bam"},"BAM"),(0,a.kt)("p",null,"The table below lists event types available in the BAM category.\nThey must be mixed with the BBDO","_","BAM","_","TYPE category to get a\nBBDO event ID."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Value"),(0,a.kt)("th",{parentName:"tr",align:null},"Uses Protobuf"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"BA status"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"KPI status"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Meta Service Status"),(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"BA event"),(0,a.kt)("td",{parentName:"tr",align:null},"4"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"KPI event"),(0,a.kt)("td",{parentName:"tr",align:null},"5"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"BA Duration Event"),(0,a.kt)("td",{parentName:"tr",align:null},"6"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension BA Event"),(0,a.kt)("td",{parentName:"tr",align:null},"7"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension KPI Event"),(0,a.kt)("td",{parentName:"tr",align:null},"8"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension BA BV Relation Event"),(0,a.kt)("td",{parentName:"tr",align:null},"9"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension BV Event"),(0,a.kt)("td",{parentName:"tr",align:null},"10"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension Truncate Table Signal"),(0,a.kt)("td",{parentName:"tr",align:null},"11"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Rebuild"),(0,a.kt)("td",{parentName:"tr",align:null},"12"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension Timeperiod"),(0,a.kt)("td",{parentName:"tr",align:null},"13"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension BA Timeperiod Relation"),(0,a.kt)("td",{parentName:"tr",align:null},"14"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Inherited Downtime"),(0,a.kt)("td",{parentName:"tr",align:null},"17"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Inherited Downtime"),(0,a.kt)("td",{parentName:"tr",align:null},"18"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb BA status"),(0,a.kt)("td",{parentName:"tr",align:null},"19"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb BA event"),(0,a.kt)("td",{parentName:"tr",align:null},"20"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb KPI event"),(0,a.kt)("td",{parentName:"tr",align:null},"21"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension BV Event"),(0,a.kt)("td",{parentName:"tr",align:null},"22"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension BA BV Relation Event"),(0,a.kt)("td",{parentName:"tr",align:null},"23"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension Timeperiod"),(0,a.kt)("td",{parentName:"tr",align:null},"24"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension BA Event"),(0,a.kt)("td",{parentName:"tr",align:null},"25"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension KPI Event"),(0,a.kt)("td",{parentName:"tr",align:null},"26"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb KPI status"),(0,a.kt)("td",{parentName:"tr",align:null},"27"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb BA Duration Event"),(0,a.kt)("td",{parentName:"tr",align:null},"28"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension BA Timeperiod Relation"),(0,a.kt)("td",{parentName:"tr",align:null},"29"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension Truncate Table Signal"),(0,a.kt)("td",{parentName:"tr",align:null},"30"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")))),(0,a.kt)("h2",{id:"event-serialization"},"Event serialization"),(0,a.kt)("p",null,"Most events listed in each ",(0,a.kt)("a",{parentName:"p",href:"#event-categories"},"event category")," have a mapping used to serialize their content. In fact,\ntheir content is directly serialized in the ",(0,a.kt)("a",{parentName:"p",href:"#packet-format"},"packet payload data"),", one field after the other in the\norder described in the ",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2806/docs/developer/developer-broker-mapping"},"mapping tables"),". They are encoded according to the rules described in the\n",(0,a.kt)("a",{parentName:"p",href:"#types"},"types paragraph"),"."),(0,a.kt)("h2",{id:"example"},"Example"),(0,a.kt)("p",null,"Let's take an example and see how a ",(0,a.kt)("em",{parentName:"p"},"host check event")," is sent in a\npacket. Its mapping is as follows:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Property"),(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Value in example"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"active","_","checks","_","enabled"),(0,a.kt)("td",{parentName:"tr",align:null},"boolean"),(0,a.kt)("td",{parentName:"tr",align:null},"True.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"check","_","type"),(0,a.kt)("td",{parentName:"tr",align:null},"short integer"),(0,a.kt)("td",{parentName:"tr",align:null},"0 (active host check).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"host","_","id"),(0,a.kt)("td",{parentName:"tr",align:null},"unsigned integer"),(0,a.kt)("td",{parentName:"tr",align:null},"42")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"next","_","check"),(0,a.kt)("td",{parentName:"tr",align:null},"time"),(0,a.kt)("td",{parentName:"tr",align:null},"1365080225")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"command","_","line"),(0,a.kt)("td",{parentName:"tr",align:null},"string"),(0,a.kt)("td",{parentName:"tr",align:null},"./my","_","plugin -H 127.0.0.1")))),(0,a.kt)("p",null,"And gives the following packet with values in hexadecimal."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"+-----------------+-----------------+-----------------------------------+\n|      CRC16      |      SIZE       |                ID                 |\n+========+========+========+========+========+========+========+========+\n|   0A   |   23   |   00   |   28   |   00   |   01   |   00   |   09   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n\n+--------+-----------------+-----------------------------------+--------\n| active_|                 |                                   |\n| checks_|    check_type   |              host_id              |    =>\n| enabled|                 |                                   |\n+========+========+========+========+==========================+========+\n|   01   |   00   |   00   |   00   |   00   |   00   |   2A   |   00   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n\n--------------------------+--------------------------------------------\n                            =>  next_check                      |    =>\n+========+========+========+========+========+========+========+========+\n|   00   |   00   |   00   |   51   |   5D   |   78   |   A1   |   2E   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n\n-----------------------------------------------------------------------\n                            => command_line =>\n+========+========+========+========+========+========+========+========+\n|   2F   |   6D   |   79   |   5F   |   70   |   6C   |   75   |   67   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n\n-----------------------------------------------------------------------\n                            => command_line =>\n+========+========+========+========+========+========+========+========+\n|   69   |   6E   |   20   |   2D   |   48   |   20   |   31   |   32   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n\n-----------------------------------------------------------------------+\n                            => command_line                              |\n+========+========+========+========+========+========+========+========+\n|   37   |   2E   |   30   |   2E   |   30   |   2E   |   31   |   00   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n")),(0,a.kt)("h2",{id:"connection-establishment"},"Connection establishment"),(0,a.kt)("p",null,"BBDO is a protocol that can negotiate features. When establishing a\nconnection, a ",(0,a.kt)("em",{parentName:"p"},"version_response")," packet is sent by the client. It\nprovides its supported BBDO protocol version and extensions. The server\nreplies to this message with another ",(0,a.kt)("em",{parentName:"p"},"version_response")," packet\ncontaining its own supported protocol version and extensions. If\nprotocol versions match, then the extension negotiation begins."),(0,a.kt)("p",null,"Currently, two extensions are supported: ",(0,a.kt)("strong",{parentName:"p"},"TLS")," and ",(0,a.kt)("strong",{parentName:"p"},"COMPRESSION"),". Right\nafter the ",(0,a.kt)("strong",{parentName:"p"},"version_response")," packet, each peer searches in the other\npeer's extension list for the extensions it supports. When one is found, it\nis enabled (i.e., it immediately starts)."),(0,a.kt)("h3",{id:"example-1"},"Example"),(0,a.kt)("p",null,"Let us call the client ",(0,a.kt)("strong",{parentName:"p"},"C")," and the server ",(0,a.kt)("em",{parentName:"p"},"S"),". The following steps are\nperformed sequentially."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"C")," initiates a TCP connection with ",(0,a.kt)("strong",{parentName:"li"},"S")," and the connection is established"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"C")," sends a ",(0,a.kt)("em",{parentName:"li"},"version_response")," packet with the following attributes",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"protocol major: 1"),(0,a.kt)("li",{parentName:"ul"},"protocol minor: 0"),(0,a.kt)("li",{parentName:"ul"},"protocol patch: 0"),(0,a.kt)("li",{parentName:"ul"},'extensions: "TLS COMPRESSION"'))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"S")," sends its own ",(0,a.kt)("strong",{parentName:"li"},"version_response")," packet in reply to ",(0,a.kt)("strong",{parentName:"li"},"C"),"'s",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"protocol major: 1"),(0,a.kt)("li",{parentName:"ul"},"protocol minor: 0"),(0,a.kt)("li",{parentName:"ul"},"protocol patch: 0"),(0,a.kt)("li",{parentName:"ul"},'extensions: "TLS COMPRESSION"'))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"C")," and ",(0,a.kt)("strong",{parentName:"li"},"S")," determine which extensions they have in common (here TLS\nand COMPRESSION)"),(0,a.kt)("li",{parentName:"ul"},"if order is important, extensions are applied in the order provided\nby the server"),(0,a.kt)("li",{parentName:"ul"},"TLS connection is initiated, handshake performed, etc."),(0,a.kt)("li",{parentName:"ul"},"compression connection is opened"),(0,a.kt)("li",{parentName:"ul"},"now data transmitted between ",(0,a.kt)("strong",{parentName:"li"},"C")," and ",(0,a.kt)("strong",{parentName:"li"},"S")," is both encrypted and\ncompressed!")),(0,a.kt)("h2",{id:"acknowledgement"},"Acknowledgement"),(0,a.kt)("p",null,"So called 'clever' clients/servers can acknowledge packets sent to them.\nThis is used by Centreon Broker to ensure every packet is accounted\nfor, and to start a retention procedure in case the other side is unresponsive."),(0,a.kt)("p",null,"To do so, the other side must periodically send a BBDO 'ack' packet back\non the same TCP channel. This packet has the number of packets acknowledged\nby the client."),(0,a.kt)("p",null,"'Clever'/'Dumb' modes are configured on each TCP output, on a per Broker\nbasis."),(0,a.kt)("h2",{id:"switching-versions-of-bbdo"},"Switching versions of BBDO"),(0,a.kt)("p",null,"BBDO must have the same version for all servers in your architecture (central server, remote servers, pollers)."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"If you use BBDO v2 with this version of Centreon, you will not be able to use the ",(0,a.kt)("strong",{parentName:"p"},"Resources Status")," page.")),(0,a.kt)("p",null,"If you want to switch versions of BBDO (either switch from v3 to v2 or from v2 to v3), follow this procedure:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"On the central server, go to ",(0,a.kt)("strong",{parentName:"p"},"Configuration > Pollers > Broker configuration"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Select the server you want, and on the ",(0,a.kt)("strong",{parentName:"p"},"General")," tab, in ",(0,a.kt)("strong",{parentName:"p"},"Advanced options"),", select the version of BBDO you want from the ",(0,a.kt)("strong",{parentName:"p"},"BBDO version")," list. Then click ",(0,a.kt)("strong",{parentName:"p"},"Save"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Do the same with all the elements listed on the **Configuration > Pollers > Broker configuration page")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Restart gorgoned on each server:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart gorgoned\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2806/docs/monitoring/monitoring-servers/deploying-a-configuration"},"Deploy the configuration")," for all servers.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Stop the following services:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"On the central server and on remote servers:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl stop cbd centengine\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"On the pollers:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl stop centengine\n"))))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Start the following services:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"On the central server and on remote servers:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl start cbd centengine\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"On the pollers:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl start centengine\n")))))),(0,a.kt)("p",null,"You can check in the logs which version of BBDO is active for a server:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"central broker:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"tail /var/log/centreon-broker/central-{broker,rrd,module}-master.log\n\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"remote broker:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"tail /var/log/centreon-broker/<remote_name>-{broker,rrd,module}-master.log\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"poller module:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"tail /var/log/centreon-broker/<poller_name>-module.log\n")))),(0,a.kt)("p",null,"The following line states which version is used for each server:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"[2022-05-17T14:53:44.828+00:00] [bbdo] [info] BBDO: peer is using protocol version 2.0.0, we're using version 2.0.0\n")))}u.isMDXComponent=!0}}]);