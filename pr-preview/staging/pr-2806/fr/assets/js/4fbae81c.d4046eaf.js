"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[23157],{74249:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>u,default:()=>N,frontMatter:()=>p,metadata:()=>c,toc:()=>d});n(67294);var a=n(3905),r=n(51715),l=n(7626);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const p={id:"map-web-troubleshooting",title:"D\xe9pannage de MAP"},u=void 0,c={unversionedId:"graph-views/map-web-troubleshooting",id:"version-23.10/graph-views/map-web-troubleshooting",title:"D\xe9pannage de MAP",description:"Cette page pr\xe9sente quelques recommandations pour r\xe9soudre des incidents lors de l'installation de MAP.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-23.10/graph-views/map-web-troubleshooting.md",sourceDirName:"graph-views",slug:"/graph-views/map-web-troubleshooting",permalink:"/centreon-documentation/pr-preview/staging/pr-2806/fr/docs/graph-views/map-web-troubleshooting",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/i18n/fr/docusaurus-plugin-content-docs/version-23.10/graph-views/map-web-troubleshooting.md",tags:[],version:"23.10",lastUpdatedAt:1699631982,formattedLastUpdatedAt:"10 nov. 2023",frontMatter:{id:"map-web-troubleshooting",title:"D\xe9pannage de MAP"},sidebar:"version-23.10/docs",previous:{title:"Probl\xe8mes connus dans MAP",permalink:"/centreon-documentation/pr-preview/staging/pr-2806/fr/docs/graph-views/map-web-known-issues"},next:{title:"Introduction \xe0 Centreon MAP (Legacy)",permalink:"/centreon-documentation/pr-preview/staging/pr-2806/fr/docs/graph-views/introduction"}},m={},d=[{value:"La configuration MAP ne fonctionne pas en HTTPS",id:"la-configuration-map-ne-fonctionne-pas-en-https",level:2},{value:"Sympt\xf4me",id:"sympt\xf4me",level:3},{value:"Probl\xe8me",id:"probl\xe8me",level:3},{value:"Solution",id:"solution",level:3},{value:"V\xe9rifier que vous avez install\xe9 les bons RPMs",id:"v\xe9rifier-que-vous-avez-install\xe9-les-bons-rpms",level:2},{value:"Augmenter le niveau des logs",id:"augmenter-le-niveau-des-logs",level:2},{value:"Ex\xe9cuter notre outil de diagnostic",id:"ex\xe9cuter-notre-outil-de-diagnostic",level:2},{value:"D\xe9panner \xe0 l&#39;aide de l&#39;interface web",id:"d\xe9panner-\xe0-laide-de-linterface-web",level:2},{value:"Toujours bloqu\xe9 ?",id:"toujours-bloqu\xe9-",level:2},{value:"R\xe9sultat du script diagnostic.sh",id:"r\xe9sultat-du-script-diagnosticsh",level:3},{value:"Captures d&#39;\xe9cran de l&#39;interface web",id:"captures-d\xe9cran-de-linterface-web",level:3},{value:"R\xe9sultat de la commande <code>yum list</code>",id:"r\xe9sultat-de-la-commande-yum-list",level:3}],k={toc:d},g="wrapper";function N(e){var{components:t}=e,n=s(e,["components"]);return(0,a.kt)(g,i(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){o(e,t,n[t])}))}return e}({},k,n),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Cette page pr\xe9sente quelques recommandations pour r\xe9soudre des incidents lors de l'installation de MAP."),(0,a.kt)("h2",{id:"la-configuration-map-ne-fonctionne-pas-en-https"},"La configuration MAP ne fonctionne pas en HTTPS"),(0,a.kt)("h3",{id:"sympt\xf4me"},"Sympt\xf4me"),(0,a.kt)("p",null,"La configuration du module MAP ne fonctionne pas. Ce probl\xe8me se produit lorsque le module MAP est install\xe9 sur le serveur central Centreon alors que la plateforme MAP est s\xe9curis\xe9e en HTTPS."),(0,a.kt)("h3",{id:"probl\xe8me"},"Probl\xe8me"),(0,a.kt)("p",null,"La configuration MAP n'est pas d\xe9finie en TLS."),(0,a.kt)("h3",{id:"solution"},"Solution"),(0,a.kt)("p",null,"Si vous utilisez IPv6, vous devez forcer le serveur MAP \xe0 utiliser IPv4. "),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Acc\xe9dez au fichier ",(0,a.kt)("strong",{parentName:"p"},"/etc/centreon-map/centreon-map.conf"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Modifiez le fichier en ajoutant l'option suivante :"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'RUN_ARGS="--spring.profiles.active=prod,tls"\nJAVA_OPTS="-Djava.net.preferIPv4Stack=true -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/var/log/centreon-map -Dcentreon-map.signing-key=8uT4BM1RsXRmIPQbTEazUAhQHtyM7xZ4nlFMIUqQ7lRkbWz24yemkGs9tS4eOwDfF -Dcentreon-map.access-token-validity-seconds=15552000 -Xms512m -Xmx4G"\n')))),(0,a.kt)("h2",{id:"v\xe9rifier-que-vous-avez-install\xe9-les-bons-rpms"},"V\xe9rifier que vous avez install\xe9 les bons RPMs"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Ex\xe9cutez la commande suivante :"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf info centreon-map-web-client\ndnf info centreon-map-engine\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf info centreon-map-web-client\ndnf info centreon-map-engine\n"))),(0,a.kt)(l.Z,{value:"Debian",label:"Debian",mdxType:"TabItem"},(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt info centreon-map-web-client\napt info centreon-map-engine\n"))))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"En sortie, ",(0,a.kt)("strong",{parentName:"p"},"Repository")," doit afficher ",(0,a.kt)("strong",{parentName:"p"},"centreon-stable-noarch"),". Si ce n'est pas le cas, vous n'avez pas install\xe9 les bons paquets. Proc\xe9dez donc comme suit :"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"sudo dnf install centreon-map-web-client\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"sudo dnf install centreon-map-web-client\n"))),(0,a.kt)(l.Z,{value:"Debian",label:"Debian",mdxType:"TabItem"},(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"sudo apt install centreon-map-web-client\n")))))),(0,a.kt)("h2",{id:"augmenter-le-niveau-des-logs"},"Augmenter le niveau des logs"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Pour augmenter le niveau des logs, \xe9ditez le fichier ",(0,a.kt)("strong",{parentName:"p"},"/etc/centreon-map/map-log.xml")," en passant les entr\xe9es suivantes en INFO :"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'<logger name="com.centreon.studio" level="INFO" />\n<logger name="org.springframework" level="INFO" />\n<logger name="org.springframework.web" level="INFO" />\n<logger name="org.apache" level="INFO" />\n'))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Red\xe9marrez le serveur ",(0,a.kt)("strong",{parentName:"p"},"centreon-map-engine")," :"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart centreon-map-engine\n")))),(0,a.kt)("h2",{id:"ex\xe9cuter-notre-outil-de-diagnostic"},"Ex\xe9cuter notre outil de diagnostic"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Ex\xe9cutez le script suivant :"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cd /etc/centreon-map\n./diagnostic.sh\n")),(0,a.kt)("p",{parentName:"li"},"Toutes les entr\xe9es doivent avoir pour valeur ",(0,a.kt)("strong",{parentName:"p"},"OK")," ou ",(0,a.kt)("strong",{parentName:"p"},"INFO"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Essayez de r\xe9soudre les erreurs en suivant les instructions ci-dessous."))),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Si l'erreur persiste, envoyez-nous les r\xe9sultats complets du script (voir la section ",(0,a.kt)("a",{parentName:"p",href:"#toujours-bloqu%C3%A9"},"Toujours bloqu\xe9 ?"),").")),(0,a.kt)("p",null,"Voici les principales erreurs que vous pouvez rencontrer :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Connexion \xe0 la base de donn\xe9es ou authentification : si la connexion ne fonctionne pas, v\xe9rifiez vos informations d'identification, votre r\xe9seau et vos utilisateurs mysql."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"########## Database connection ##########\n\n[ok]   Connection to centreon\n[ok]   Connection to centreon_storage\n[ok]   Connection to centreon_map\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Connexion \xe0 la sortie Broker : si elle ne fonctionne pas, v\xe9rifiez la configuration de la sortie Broker, le r\xe9seau et la configuration TLS (si utilis\xe9e)."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"########## Broker connection ##########\n\n[ok]   Connection to 127.0.0.1 5758 port\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Connexion ou authentification de MAP au serveur central : si cela ne fonctionne pas, v\xe9rifiez vos informations d'identification, votre r\xe9seau, vos proxys et votre configuration TLS (si vous l'utilisez)."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"########## Authentication ##########\n\n[ok]   Centreon Central authentication using user admin\n")))),(0,a.kt)("h2",{id:"d\xe9panner-\xe0-laide-de-linterface-web"},"D\xe9panner \xe0 l'aide de l'interface web"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Assurez-vous que l'URL sp\xe9cifi\xe9e dans ",(0,a.kt)("strong",{parentName:"p"},"Administration > Extensions > MAP > Options")," est accessible (\xe0 la fois accessible et r\xe9solue) depuis l'ordinateur acc\xe9dant \xe0 l'interface web.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"V\xe9rifiez le statut de MAP en acc\xe9dant \xe0 l'URL suivante dans le navigateur (utilisez les m\xeames valeurs pour ",(0,a.kt)("strong",{parentName:"p"},"MAP_IP_ADDRESS")," et ",(0,a.kt)("strong",{parentName:"p"},"MAP_PORT")," que celles d\xe9finies dans ",(0,a.kt)("strong",{parentName:"p"},"Administration > Extensions > MAP > Options"),")."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"http://[MAP_IP_ADDRESS]:[MAP_PORT]/centreon-map/api/actuator/health\n")),(0,a.kt)("p",{parentName:"li"},"Exemple:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"http://10.0.0.2:8081/centreon-map/api/actuator/health\n")),(0,a.kt)("p",{parentName:"li"},"Le r\xe9sultat doit \xeatre le suivant :"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'{\n  "status" : "UP"\n}\n')),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"Si ce n'est pas le cas, veuillez envoyer une capture d'\xe9cran de l'erreur (voir la section ",(0,a.kt)("a",{parentName:"p",href:"#toujours-bloqu%C3%A9"},"Toujours bloqu\xe9 ?"),").")))),(0,a.kt)("h2",{id:"toujours-bloqu\xe9-"},"Toujours bloqu\xe9 ?"),(0,a.kt)("p",null,"Si vous avez toujours besoin d'aide, veuillez contacter l'",(0,a.kt)("a",{parentName:"p",href:"https://support.centreon.com/"},"\xe9quipe support de Centreon")," en fournissant les informations de base sur la mani\xe8re dont Centreon MAP est install\xe9."),(0,a.kt)("p",null,"Voici un exemple d'installation standard :"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null}),(0,a.kt)("th",{parentName:"tr",align:null},"Central"),(0,a.kt)("th",{parentName:"tr",align:null},"MAP"),(0,a.kt)("th",{parentName:"tr",align:null},"MAP (Legacy)"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Y a-t-il une connexion directe entre cet \xe9l\xe9ment et le central (sont-ils sur le m\xeame r\xe9seau ?)"),(0,a.kt)("td",{parentName:"tr",align:null},"n/a"),(0,a.kt)("td",{parentName:"tr",align:null},"Y"),(0,a.kt)("td",{parentName:"tr",align:null},"Y")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Cet \xe9l\xe9ment est-il install\xe9 sur le m\xeame serveur que le central ?"),(0,a.kt)("td",{parentName:"tr",align:null},"n/a"),(0,a.kt)("td",{parentName:"tr",align:null},"Y"),(0,a.kt)("td",{parentName:"tr",align:null},"N")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Le protocole HTTPS est-il activ\xe9 ?"),(0,a.kt)("td",{parentName:"tr",align:null},"Y"),(0,a.kt)("td",{parentName:"tr",align:null},"Y"),(0,a.kt)("td",{parentName:"tr",align:null},"Y")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Est-ce une nouvelle installation ?"),(0,a.kt)("td",{parentName:"tr",align:null},"N"),(0,a.kt)("td",{parentName:"tr",align:null},"Y"),(0,a.kt)("td",{parentName:"tr",align:null},"N")))),(0,a.kt)("h3",{id:"r\xe9sultat-du-script-diagnosticsh"},"R\xe9sultat du script diagnostic.sh"),(0,a.kt)("p",null,"Voir ci-dessus ",(0,a.kt)("a",{parentName:"p",href:"#ex%C3%A9cuter-notre-outil-de-diagnostic"},"Ex\xe9cuter notre outil de diagnostic")," et envoyez le r\xe9sultat complet du script \xe0 l'",(0,a.kt)("a",{parentName:"p",href:"https://support.centreon.com/"},"\xe9quipe support de Centreon"),"."),(0,a.kt)("p",null,"Fournissez les fichiers de logs suivants (chemins par d\xe9faut) :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Centreon MAP Engine server :"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"/var/log/centreon-map/centreon-map-engine.log\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Centreon Central server :"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"/var/log/php-fpm/centreon-error.log\n")))),(0,a.kt)("h3",{id:"captures-d\xe9cran-de-linterface-web"},"Captures d'\xe9cran de l'interface web"),(0,a.kt)("p",null,"Si vous rencontrez des probl\xe8mes sur l'interface web, veuillez fournir des captures d'\xe9cran de l'interface pr\xe9sentant l'erreur, avec l'outil de d\xe9veloppement du navigateur ouvert sur les onglets suivants :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Onglet R\xe9seau (touche F12), si possible filtr\xe9 sur les requ\xeates qui \xe9chouent."),(0,a.kt)("li",{parentName:"ul"},"Onglet Console (touche F12), si possible filtr\xe9 sur les erreurs.")),(0,a.kt)("h3",{id:"r\xe9sultat-de-la-commande-yum-list"},"R\xe9sultat de la commande ",(0,a.kt)("inlineCode",{parentName:"h3"},"yum list")),(0,a.kt)("p",null,"Ex\xe9cutez les commandes suivantes et transmettez le r\xe9sultat au support :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Sur le central :"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yum list centreon-map-web-client --showduplicates -q\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Sur le serveur o\xf9 ",(0,a.kt)("strong",{parentName:"p"},"centreon-map-engine")," est install\xe9 :"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yum list centreon-map-engine --showduplicates -q\n")))))}N.isMDXComponent=!0}}]);