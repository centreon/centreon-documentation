<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-23.10 plugin-docs plugin-id-default docs-doc-id-installation/installation-of-centreon-ha/installation-4-nodes" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Installing a Centreon HA 4-nodes cluster | Centreon Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.centreon.com/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-4-nodes/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="23.10"><meta data-rh="true" name="docusaurus_tag" content="docs-default-23.10"><meta data-rh="true" name="docsearch:version" content="23.10"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-23.10"><meta data-rh="true" property="og:title" content="Installing a Centreon HA 4-nodes cluster | Centreon Documentation"><meta data-rh="true" name="description" content="Prerequisites"><meta data-rh="true" property="og:description" content="Prerequisites"><link data-rh="true" rel="icon" href="/centreon-documentation/pr-preview/staging/pr-2806/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.centreon.com/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-4-nodes/"><link data-rh="true" rel="alternate" href="https://docs.centreon.com/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-4-nodes/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.centreon.com/centreon-documentation/pr-preview/staging/pr-2806/fr/docs/installation/installation-of-centreon-ha/installation-4-nodes/" hreflang="fr"><link data-rh="true" rel="alternate" href="https://docs.centreon.com/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-4-nodes/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://3WEC6XPLDB-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-8418698-13","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BGL69N5GPJ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BGL69N5GPJ",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Centreon Documentation" href="/centreon-documentation/pr-preview/staging/pr-2806/opensearch.xml"><link rel="stylesheet" href="/centreon-documentation/pr-preview/staging/pr-2806/assets/css/styles.86f4f2b4.css">
<link rel="preload" href="/centreon-documentation/pr-preview/staging/pr-2806/assets/js/runtime~main.0e131920.js" as="script">
<link rel="preload" href="/centreon-documentation/pr-preview/staging/pr-2806/assets/js/main.c16a1087.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/centreon-documentation/pr-preview/staging/pr-2806/"><div class="navbar__logo"><img src="/centreon-documentation/pr-preview/staging/pr-2806/img/logo_centreon_dark.png" alt="Logo Centreon Docs" class="themedImage_ToTc themedImage--light_HNdA"><img src="/centreon-documentation/pr-preview/staging/pr-2806/img/logo_centreon.png" alt="Logo Centreon Docs" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/getting-started/welcome/">Centreon OnPrem</a><a class="navbar__item navbar__link" href="/centreon-documentation/pr-preview/staging/pr-2806/pp/integrations/plugin-packs/getting-started/introduction/">Monitoring Connectors</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/getting-started/welcome/">23.10</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-4-nodes/">23.10</a></li><li><hr class="dropdown-separator"></li><li class="dropdown-archived-versions"><b>Archived versions</b></li><li><a href="https://archives-docs.centreon.com/21.04/" target="_blank" rel="noopener noreferrer" class="dropdown__link">21.04<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://archives-docs.centreon.com/20.10/" target="_blank" rel="noopener noreferrer" class="dropdown__link">20.10<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://archives-docs.centreon.com/20.04/" target="_blank" rel="noopener noreferrer" class="dropdown__link">20.04<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://docs-older.centreon.com" target="_blank" rel="noopener noreferrer" class="dropdown__link">Older<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>ðŸ‡¬ðŸ‡§ English</a><ul class="dropdown__menu"><li><a href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-4-nodes/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">ðŸ‡¬ðŸ‡§ English</a></li><li><a href="/centreon-documentation/pr-preview/staging/pr-2806/fr/docs/installation/installation-of-centreon-ha/installation-4-nodes/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">ðŸ‡«ðŸ‡· FranÃ§ais</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/getting-started/welcome/">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/introduction/">Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/administration/secure-platform/">Secure your platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/monitoring/about/">Monitoring resources</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/alerts-notifications/concepts/">Managing events and alerts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/monitoring/basic-objects/contacts/">Managing Centreon users</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/metrology/chart-management/">Performance graphs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/service-mapping/introduction/">Service Mapping</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/category/graphical-views/">Graphical views</a><button aria-label="Toggle the collapsible sidebar category &#x27;Graphical views&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/reporting/introduction/">Reporting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/administration/parameters/centreon-ui/">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/update/update-centreon-platform/">Update, Upgrade &amp; Migrate</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/centreon-documentation/pr-preview/staging/pr-2806/pp/integrations/plugin-packs/getting-started/introduction/">Monitoring Connectors</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/integrations/introduction-integrations/">Integrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/mobile/introduction/">Centreon mobile</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/category/developer-resources/">Developer resources</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer resources&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/overview/">Centreon HA</a><button aria-label="Toggle the collapsible sidebar category &#x27;Centreon HA&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-2-nodes/">Installing Centreon HA</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-2-nodes/">Installing a Centreon HA 2-nodes cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-4-nodes/">Installing a Centreon HA 4-nodes cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/integrating-pollers/">Integrating new pollers in a Centreon-HA cluster</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha-manual/centreon-ha-2-nodes-installation-manual-failover/">Installing a manual Centreon HA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/administration/centreon-ha/acceptance-guide/">Operating Centreon HA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/update/update-centreon-ha/">Updating Centreon HA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/upgrade/centreon-ha/upgrade-centreon-ha-from-21-04/">Upgrading Centreon HA</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/health/centreon-agent/">Monitoring your platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/releases/introduction/">Releases</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/security/">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/resources/known-issues/">Resources</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Installing a Centreon HA 4-nodes cluster</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding">Understanding<a href="#understanding" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>Before applying this procedure, you should have a good knowledge of Linux OS, Centreon,
and Pacemaker clustering tools in order to have a proper understanding of what is being done.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-flows">Network Flows<a href="#network-flows" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>In addition to the necessary flows described in the <a href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/architectures/#tables-of-network-flows">official documentation</a>,
you will need to open the following flows:</p><table><thead><tr><th align="left">From</th><th align="left">Destination</th><th align="left">Protocol</th><th align="left">Port</th><th align="left">Application</th></tr></thead><tbody><tr><td align="left">Active Central Server</td><td align="left">Passive Central Server</td><td align="left">SSH</td><td align="left">TCP 22</td><td align="left">Synchronization of configuration files (Must also be open from passive to active node)</td></tr><tr><td align="left">Active Central Server</td><td align="left">Passive Central Server</td><td align="left">BDDO</td><td align="left">TCP 5670</td><td align="left">RRDs synchronization (Must also be open from passive to active node)</td></tr><tr><td align="left">Active Database Server</td><td align="left">Passive Database Server</td><td align="left">MySQL</td><td align="left">TCP 3306</td><td align="left">MySQL synchronization (Must also be open from passive to active node)</td></tr><tr><td align="left">Active Database Server</td><td align="left">Passive Database Server</td><td align="left">SSH</td><td align="left">TCP 22</td><td align="left">MySQL synchronization (Must also be open from passive to active node)</td></tr><tr><td align="left">Central Servers + DB + QDevice</td><td align="left">Central Servers + DB + QDevice</td><td align="left">Corosync</td><td align="left">UDP 5404</td><td align="left">Communication inside the cluster (Multicast)</td></tr><tr><td align="left">Central Servers + DB + QDevice</td><td align="left">Central Servers + DB + QDevice</td><td align="left">Corosync</td><td align="left">UDP 5405</td><td align="left">Communication inside the cluster (Unicast)</td></tr><tr><td align="left">Central Servers + DB + QDevice</td><td align="left">Central Servers + DB + QDevice</td><td align="left">PCS</td><td align="left">TCP 2224</td><td align="left">Communication inside the cluster</td></tr><tr><td align="left">Central Servers + DB + QDevice</td><td align="left">Central Servers + DB + QDevice</td><td align="left">Corosync</td><td align="left">TCP 5403</td><td align="left">Communication with the QDevice</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installed-centreon-platform">Installed Centreon platform<a href="#installed-centreon-platform" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>A Centreon HA cluster can only be installed on top of an operating Centreon platform. Before following this procedure, it is mandatory that <strong><a href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/introduction/">this installation procedure</a></strong> has already been completed and that <strong>about 5 GB free space has been spared on the LVM volume group</strong> that carries the MariaDB data directory (<code>/var/lib/mysql</code> mount point by default).</p><p>The output of the <code>vgs</code> command must look like this: (pay attention to the value under <code>VFree</code>):</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  VG                    #PV #LV #SN Attr   VSize   VFree </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  centos_centreon-c1      1   5   0 wz--n- &lt;31,00g &lt;5,00g</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>MariaDB files <code>ibdata*</code> and <code>ib_logfile*</code> must be in the &quot;datadir&quot; directory or in a subdirectory (scripts <code>centreondb-smooth-backup.sh</code> and <code>mysql-sync-bigdb.sh</code> are not compatible with this operation);</li><li>MariaDB files <code>log-bin*</code> and <code>relay-log*</code> can be located in a directory (or a subdirectory) different from &quot;datadir&quot;. They can also be on a different logical volume (<code>lvm</code>) than &quot;datadir&quot;. However, the logical volume must be located in the volume group where &quot;datadir&quot; is stored.</li></ul><blockquote><p><strong>WARNING:</strong> If these particular prerequisites are not effective, the database synchronization method described below will not work.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="quorum-device">Quorum Device<a href="#quorum-device" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>In order to keep the cluster safe from split-brain issues, a third server is mandatory to resolve the master&#x27;s election in the event of a connection loss. The role of Quorum Device can be held by a poller of the monitoring platform.</p><p>In order to adhere to best practices and be as resilient as possible, the Quorum server
should be at a different site than the two primary nodes, with independent network connections.</p><blockquote><p><strong>WARNING:</strong> Make sure SELinux and Firewalld are disabled.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="defining-hosts-names-and-addresses">Defining hosts&#x27; names and addresses<a href="#defining-hosts-names-and-addresses" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>In this procedure, we will refer to characteristics that are bound to change from one platform to another (such as IP addresses) by the following macros:</p><ul><li><code>@CENTRAL_MASTER_IPADDR@</code>: primary central server&#x27;s IP address</li><li><code>@CENTRAL_MASTER_NAME@</code>: primary central server&#x27;s name (must be identical to <code>hostname -s</code>)</li><li><code>@CENTRAL_SLAVE_IPADDR@</code>: secondary central server&#x27;s IP address</li><li><code>@CENTRAL_SLAVE_NAME@</code>: secondary central server&#x27;s name (must be identical to <code>hostname -s</code>)</li><li><code>@DATABASE_MASTER_IPADDR@</code>: primary database server&#x27;s IP address</li><li><code>@DATABASE_MASTER_NAME@</code>: primary database server&#x27;s FQDN (must be identical to: <code>hostname -s</code>)</li><li><code>@DATABASE_SLAVE_IPADDR@</code>: secondary database server&#x27;s IP address </li><li><code>@DATABASE_SLAVE_NAME@</code>: secondary database server&#x27;s FQDN (must be identical to: <code>hostname -s</code>)</li><li><code>@QDEVICE_IPADDR@</code>: quorum device&#x27;s IP address</li><li><code>@QDEVICE_NAME@</code>: quorum device&#x27;s name (must be identical to <code>hostname -s</code>)</li><li><code>@MARIADB_REPL_USER@</code>:  MariaDB replication login (default: <code>centreon-repl</code>)</li><li><code>@MARIADB_REPL_PASSWD@</code>: MariaDB replication password</li><li><code>@MARIADB_CENTREON_USER@</code>: MariaDB Centreon login (default: <code>centreon</code>)</li><li><code>@MARIADB_CENTREON_PASSWD@</code>: MariaDB Centreon </li><li><code>@VIP_IPADDR@</code>: virtual IP address of the cluster</li><li><code>@VIP_IFNAME@</code>: network device carrying the cluster&#x27;s VIP</li><li><code>@VIP_CIDR_NETMASK@</code>: subnet mask length in bits (e.g. 24)</li><li><code>@VIP_BROADCAST_IPADDR@</code>: cluster&#x27;s VIP broadcast address</li><li><code>@VIP_SQL_IPADDR@</code>: virtual IP address of the SQL cluster</li><li><code>@VIP_SQL_IFNAME@</code>: network device carrying the SQL cluster&#x27;s VIP</li><li><code>@VIP_SQL_CIDR_NETMASK@</code>: SQL Cluster subnet mask length in bits (e.g. 24)</li><li><code>@VIP_SQL_BROADCAST_IPADDR@</code>: cluster&#x27;s VIP SQL broadcast address</li><li><code>@CENTREON_CLUSTER_PASSWD@</code>: <code>hacluster</code> user&#x27;s password</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-centreon-broker">Configuring centreon-broker<a href="#configuring-centreon-broker" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="link-to-cbd-service">Link to cbd service<a href="#link-to-cbd-service" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>On a standard Centreon platform, cbd service manages two processes of <code>centreon-broker-daemon</code> (<code>cbd</code>):</p><ul><li><code>central-broker-master</code>: also called &quot;central broker&quot; or &quot;SQL broker&quot;, redirects input-output from pollers to database, RRD broker, and so on.</li><li><code>central-rrd-master</code>: also called &quot;RRD broker&quot;, receives the stream from the central broker and updates the RRD binary data files (used to display graphs).</li></ul><p>In the context of a <em>Centreon HA</em> cluster, both broker processes will be handled by a separate service, managed by the cluster.</p><ul><li><code>central-broker-master</code> known as the resource <code>cbd_central_broker</code>, linked to <em>systemd</em> service <code>cbd-sql</code></li><li><code>central-rrd-master</code> known as the clone resource <code>cbd_rrd</code>, linked to <em>systemd</em> <code>cbd</code> service, the standard broker service of Centreon.</li></ul><p>To ensure that everything goes well, you will have to unlink central-broker-master from the <code>cbd</code> service by checking &quot;No&quot; for parameter &quot;Link to cbd service&quot; in <em>Configuration</em> &gt; <em>Pollers</em> &gt; <em>Broker configuration</em> &gt; <em>central-broker-master</em> under the <em>General</em> tab.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="double-output-stream-toward-rrd">Double output stream toward RRD<a href="#double-output-stream-toward-rrd" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>In the event of a cluster switch, you will expect the newly elected master central server to be able to display the metrics graphs, which requires all RRD data files to be up to date on both nodes. In order to fulfill this condition, you will double the central broker output stream and send it to both RRD broker processes. You can configure this in the same menu as above, this time under the <em>Output</em> tab. The parameters that must be changed are:</p><ul><li>In the first &quot;IPv4&quot; output, replace &quot;localhost&quot; with <code>@CENTRAL_MASTER_IPADDR@</code> in the &quot;Host to connect to&quot; field.</li></ul><table><thead><tr><th>Output IPv4</th><th></th></tr></thead><tbody><tr><td>Name</td><td>centreon-broker-master-rrd</td></tr><tr><td>Connection port</td><td>5670</td></tr><tr><td>Host to connect to</td><td><code>@CENTRAL_MASTER_IPADDR@</code></td></tr><tr><td>Buffering timeout</td><td>0</td></tr><tr><td>Retry interval</td><td>60</td></tr></tbody></table><ul><li>Add another &quot;IPv4&quot; output, similar to the first one, named &quot;centreon-broker-slave-rrd&quot; for example, directed toward <code>@CENTRAL_SLAVE_IPADDR@</code>.</li></ul><table><thead><tr><th>Output IPv4</th><th></th></tr></thead><tbody><tr><td>Name</td><td>centreon-broker-slave-rrd</td></tr><tr><td>Connection port</td><td>5670</td></tr><tr><td>Host to connect to</td><td><code>@CENTRAL_SLAVE_IPADDR@</code></td></tr><tr><td>Buffering timeout</td><td>0</td></tr><tr><td>Retry interval</td><td>60</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="export-the-configuration">Export the configuration<a href="#export-the-configuration" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>Once the above actions have been done, export the central poller configuration files to apply these changes. Select the central poller and export the configuration with the &quot;Move Export Files&quot; option checked.</p><p>All the above actions should be applied either to both nodes or to <code>@CENTRAL_MASTER_NAME@</code> only, and the exported files should be copied to <code>@CENTRAL_SLAVE_NAME@</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">rsync</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> /etc/centreon-broker/*json @CENTRAL_SLAVE_IPADDR@:/etc/centreon-broker/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="customizing-poller-reload-command">Customizing poller reload command<a href="#customizing-poller-reload-command" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>You might not be aware that the central broker daemon must be reloaded every time you update your central poller&#x27;s configuration, hence the &quot;Centreon Broker reload command&quot; parameter in <em>Configuration &gt; Pollers &gt; Central</em>.</p><p>As stated above, the centreon-broker processes will be divided into <code>cbd</code> (for RRD) and <code>cbd-sql</code> (for central broker) services. With this in mind, the service that needs to be reloaded is <code>cbd-sql</code>, and no longer <code>cbd</code>. So you will have to set the &quot;Centreon Broker reload command&quot; parameter to <code>service cbd-sql reload</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="system-settings">System settings<a href="#system-settings" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>Before actually setting the cluster up, some system prerequisites must be satisfied.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kernel-network-tuning">Kernel network tuning<a href="#kernel-network-tuning" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>In order to improve the reliability of the cluster, and since <em>Centreon HA</em> only supports IPv4, we recommend applying the following kernel settings to all your Centreon servers (including pollers):</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> /etc/sysctl.conf </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token string" style="color:#e3116c">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv6.conf.all.disable_ipv6 = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv6.conf.default.disable_ipv6 = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv4.tcp_retries2 = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv4.tcp_keepalive_time = 200</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv4.tcp_keepalive_probes = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv4.tcp_keepalive_intvl = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart NetworkManager</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> /etc/sysctl.conf </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token string" style="color:#e3116c">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv6.conf.all.disable_ipv6 = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv6.conf.default.disable_ipv6 = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv4.tcp_retries2 = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv4.tcp_keepalive_time = 200</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv4.tcp_keepalive_probes = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">net.ipv4.tcp_keepalive_intvl = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">reboot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="name-resolution">Name resolution<a href="#name-resolution" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>So that the <em>Centreon HA</em> cluster can stay in operation in the event of a DNS service breakdown, all the cluster nodes must know each other by name without DNS, using <code>/etc/hosts</code>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/etc/hosts </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token string" style="color:#e3116c">&quot;EOF&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">@CENTRAL_MASTER_IPADDR@ @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">@CENTRAL_SLAVE_IPADDR@ @CENTRAL_SLAVE_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">@DATABASE_MASTER_IPADDR@ @DATABASE_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">@DATABASE_SLAVE_IPADDR@ @DATABASE_SLAVE_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">@QDEVICE_IPADDR@ @QDEVICE_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>From here, <code>@CENTRAL_MASTER_NAME@</code> will be named the &quot;primary server/node&quot; and <code>@CENTRAL_SLAVE_NAME@</code> the &quot;secondary server/node&quot;. This designation is arbitrary; the two nodes will of course be interchangeable once the setup is complete.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-system-packages">Installing system packages<a href="#installing-system-packages" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>Centreon offers a package named <code>centreon-ha-web</code> for the Central Servers and a package <code>centreon-ha-common</code> for the Database servers, providing all the files and dependencies required by a Centreon cluster.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="central-servers">Central Servers<a href="#central-servers" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>These packages must be installed on both Central Servers (Except Quorum):</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">RHEL 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf config-manager </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> ha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> centreon-ha-web pcs pacemaker corosync corosync-qdevice</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> dnf-plugins-core https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subscription-manager repos </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> rhel-8-for-x86_64-highavailability-rpms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> centreon-ha-web pcs pacemaker corosync corosync-qdevice</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf config-manager </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> ol8_addons</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> centreon-ha-web pcs pacemaker corosync corosync-qdevice</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> centreon-ha-web pcs pacemaker corosync corosync-qdevice </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="database-servers">Database Servers<a href="#database-servers" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>These packages must be installed on both Database Servers (Except Quorum):</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">RHEL 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf config-manager </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> ha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> centreon-ha-common pcs pacemaker corosync corosync-qdevice</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> dnf-plugins-core https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subscription-manager repos </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> rhel-8-for-x86_64-highavailability-rpms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> centreon-ha-common pcs pacemaker corosync corosync-qdevice</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf config-manager </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> ol8_addons</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> centreon-ha-common pcs pacemaker corosync corosync-qdevice</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> centreon-ha-common pcs pacemaker corosync corosync-qdevice </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-keys-exchange">SSH keys exchange<a href="#ssh-keys-exchange" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>SSH key-based authentication must be set so that files and commands can be sent from one node to another by UNIX accounts:</p><ul><li><code>mysql</code></li><li><code>centreon</code></li></ul><p>There are two ways of exchanging such keys:</p><ul><li>By using the <code>ssh-copy-id</code> command: needs to be able to log in to remote host using a password. It is however unsafe for such system accounts to have a password authentication available. If you choose this method, we advise you to revoke the password afterward with these commands: <code>passwd -d centreon</code> and <code>passwd -d mysql</code>.</li><li>By manually copying the public key in <code>~/.ssh/authorized_keys</code>. This method is safer.</li></ul><p>The second method will be documented below.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="centreon-account"><code>centreon</code> account<a href="#centreon-account" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>Switch to <code>centreon</code>&#x27;s bash environment on both nodes:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">su</span><span class="token plain"> - centreon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then run these commands on both nodes:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> ed25519 </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> ~/.ssh/id_ed25519.pub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once done, copy the content of the public key file displayed by <code>cat</code> and paste it to <code>~/.ssh/authorized_keys</code> (must be created) on the other node, and then apply the correct file permissions (still as user <code>centreon</code>):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> ~/.ssh/authorized_keys</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The key exchange must be validated by an initial connection from each node to the other in order to accept and register the peer node&#x27;s SSH fingerprint (still as user <code>centreon</code>):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">peer </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> hostname</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then exit the <code>centreon</code> session by typing <code>exit</code> or <code>Ctrl-D</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mysql-account"><code>mysql</code> account<a href="#mysql-account" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>For the <code>mysql</code> account, the procedure is slightly different because this user normally has neither a home directory nor the ability to open a Shell session. These commands must be run on both nodes as well:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl stop mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> /home/mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> mysql: /home/mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> /home/mysql mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> /bin/bash mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">su</span><span class="token plain"> - mysql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once in <code>mysql</code>&#x27;s <code>bash</code> envinronment, run these commands on both nodes:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> ed25519 </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> ~/.ssh/id_ed25519.pub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once done, copy the content of the public key file displayed by <code>cat</code> and paste it to <code>~/.ssh/authorized_keys</code> (must be created) on the other node, and then apply the correct file permissions (still as user<code>mysql</code>):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> ~/.ssh/authorized_keys</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The key exchange must be validated by an initial connection from each node to the other in order to accept and register the peer node&#x27;s SSH fingerprint (still as user <code>mysql</code>):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">peer </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> hostname</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then exit the <code>mysql</code> session by typing <code>exit</code> or <code>Ctrl-D</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-the-mariadb-database-replication">Configuring the MariaDB database replication<a href="#configuring-the-mariadb-database-replication" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>A Master-Slave MariaDB cluster will be set up so that everything is synchronized in real time. </p><p><strong>Note</strong>: unless otherwise stated, each of the following steps must be run <strong>on both database nodes</strong>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-mariadb">Configuring MariaDB<a href="#configuring-mariadb" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>For both optimization and cluster reliability purposes, you need to add these tuning options to the MariaDB configuration in the <code>/etc/my.cnf.d/server.cnf</code> file. By default, the <code>[server]</code> section of this file is empty. Paste the following lines (some need to be modified) into this section:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server-id=1 # SET TO 1 FOR MASTER AND 2 FOR SLAVE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#read_only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log-bin=mysql-bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binlog-do-db=centreon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binlog-do-db=centreon_storage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_flush_log_at_trx_commit=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sync_binlog=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binlog_format=MIXED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">slave_compressed_protocol=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">slave_parallel_mode=conservative</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">datadir=/var/lib/mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pid-file=/var/lib/mysql/mysql.pid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">skip-slave-start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log-slave-updates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gtid_strict_mode=ON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expire_logs_days=7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ignore-db-dir=lost+found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Tuning standard Centreon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_file_per_table=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">open_files_limit=32000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key_buffer_size=256M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort_buffer_size=32M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">join_buffer_size=4M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thread_cache_size=64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_buffer_size=512K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_rnd_buffer_size=256K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_allowed_packet=64M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Uncomment for 4 Go Ram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#innodb_buffer_pool_size=512M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Uncomment for 8 Go Ram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#innodb_buffer_pool_size=1G</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>For both optimization and cluster reliability purposes, you need to add these tuning options to the MariaDB configuration in the <code>/etc/mysql/mariadb.conf.d/50-server.cnf</code> file. By default, the <code>[server]</code> section of this file is empty. Paste the following lines (some need to be modified) into this section:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server-id=1 # SET TO 1 FOR MASTER AND 2 FOR SLAVE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#read_only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log-bin=mysql-bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binlog-do-db=centreon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binlog-do-db=centreon_storage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_flush_log_at_trx_commit=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sync_binlog=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binlog_format=MIXED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">slave_compressed_protocol=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">slave_parallel_mode=conservative</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">datadir=/var/lib/mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pid-file=/run/mysqld/mysql.pid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">skip-slave-start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log-slave-updates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gtid_strict_mode=ON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expire_logs_days=7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ignore-db-dir=lost+found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Tuning standard Centreon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_file_per_table=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">open_files_limit=32000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key_buffer_size=256M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort_buffer_size=32M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">join_buffer_size=4M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thread_cache_size=64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_buffer_size=512K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_rnd_buffer_size=256K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_allowed_packet=64M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Uncomment for 4 Go Ram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#innodb_buffer_pool_size=512M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Uncomment for 8 Go Ram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#innodb_buffer_pool_size=1G</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><blockquote><p><strong>Important:</strong> the value of <code>server-id</code> must be different from one server to the other. The values suggested in the comment 1 =&gt; Master and 2 =&gt; Slave are not mandatory, but recommended.</p></blockquote><p><strong>Reminder:</strong> Remember to uncomment the right value for <code>innodb_buffer_pool_size</code> according to your own servers&#x27; memory size.</p><p>To apply the new configuration, restart the database server:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart mysql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure the restart went well:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status mysql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>Warning:</strong> Other files in <code>/etc/my.cnf.d/</code>, such as <code>centreon.cnf</code>, will be ignored from now on. Any customization will have to be added to <code>server.cnf</code>.</p></blockquote><blockquote><p><strong>Warning:</strong> Remember to change the parameter <code>Mysql configuration file path</code> in <strong>Administration &gt; Parameters &gt; Backup</strong></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="securing-the-database-server">Securing the database server<a href="#securing-the-database-server" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>To avoid unnecessary exposure of your database, you should restrict access to it as much as possible. The <code>mysql_secure_installation</code> command will help you apply some basic security principles. You just need to run this command and let yourself be guided, choosing the recommended option at every step. We suggest you choose a strong password.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql_secure_installation</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-centreon-mariadb-account">Creating the <code>centreon</code> MariaDB account<a href="#creating-the-centreon-mariadb-account" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>First log in as <code>root</code> on both database servers (using the newly-defined password):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql </span><span class="token parameter variable" style="color:#36acaa">-p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, on both sides, paste the following SQL commands to the MariaDB prompt to create the application user (default: <code>centreon</code>). Of course, you will replace the macros first:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">USER</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@DATABASE_SLAVE_IPADDR@&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> centreon</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@DATABASE_SLAVE_IPADDR@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> centreon_storage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@DATABASE_SLAVE_IPADDR@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">USER</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@DATABASE_MASTER_IPADDR@&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> centreon</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@DATABASE_MASTER_IPADDR@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> centreon_storage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@DATABASE_MASTER_IPADDR@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Optionally, you can allow these privileges to be used from the Central Cluster.  This will make some administration scripts runnable from every node.</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">USER</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@CENTRAL_SLAVE_IPADDR@&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> centreon</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@CENTRAL_SLAVE_IPADDR@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> centreon_storage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@CENTRAL_SLAVE_IPADDR@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">USER</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@CENTRAL_MASTER_IPADDR@&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> centreon</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@CENTRAL_MASTER_IPADDR@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> centreon_storage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@CENTRAL_MASTER_IPADDR@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When upgrading to centreon-ha from an existing Centreon platform or an OVA/OVF VM deployment, update the <code>&#x27;@MARIADB_CENTREON_USER@&#x27;@&#x27;localhost&#x27;</code> password:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">USER</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;localhost&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-mariadb-replication-account">Creating the MariaDB replication account<a href="#creating-the-mariadb-replication-account" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>Still in the same prompt, create the replication user (default: <code>centreon-repl</code>):</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SHUTDOWN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PROCESS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> RELOAD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SUPER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLICATION</span><span class="token plain"> CLIENT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLICATION</span><span class="token plain"> SLAVE </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;localhost&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SHUTDOWN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PROCESS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> RELOAD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SUPER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLICATION</span><span class="token plain"> CLIENT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLICATION</span><span class="token plain"> SLAVE </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@DATABASE_SLAVE_IPADDR@&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SHUTDOWN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PROCESS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> RELOAD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SUPER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLICATION</span><span class="token plain"> CLIENT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLICATION</span><span class="token plain"> SLAVE </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@DATABASE_MASTER_IPADDR@&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Optionally, you can allow these privileges to be used from the Central Cluster. This will make some administration scripts runnable from every node.</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SHUTDOWN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PROCESS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> RELOAD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SUPER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLICATION</span><span class="token plain"> CLIENT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLICATION</span><span class="token plain"> SLAVE </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@CENTRAL_SLAVE_IPADDR@&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SHUTDOWN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PROCESS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> RELOAD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SUPER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLICATION</span><span class="token plain"> CLIENT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLICATION</span><span class="token plain"> SLAVE </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_USER@&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;@CENTRAL_MASTER_IPADDR@&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-the-mariadb-scripts-environment-variables">Configuring the MariaDB scripts environment variables<a href="#configuring-the-mariadb-scripts-environment-variables" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>The <code>/etc/centreon-ha/mysql-resources.sh</code> file declares environment variables that must be configured so that the <em>Centreon HA</em> scripts dedicated to MariaDB can work properly. These variables must be assigned the chosen values for the macros.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">###############################</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Database access credentials #</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">###############################</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DBHOSTNAMEMASTER</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;@DATABASE_MASTER_NAME@&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DBHOSTNAMESLAVE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;@DATABASE_SLAVE_NAME@&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DBREPLUSER</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_USER@&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DBREPLPASSWORD</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DBROOTUSER</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_USER@&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DBROOTPASSWORD</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">CENTREON_DB</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;centreon&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">CENTREON_STORAGE_DB</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;centreon_storage&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">###############################</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To make sure that all the previous steps have been successful, and that the correct names, logins and passwords have been entered in the configuration bash file, run this command on database nodes:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/centreon-ha/bin/mysql-check-status.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The expected output is:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Connection MASTER Status &#x27;@DATABASE_MASTER_NAME@&#x27; [OK]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection SLAVE Status &#x27;@DATABASE_SLAVE_NAME@&#x27; [OK]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slave Thread Status [KO]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error reports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    No slave (maybe because we cannot check a server).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Position Status [SKIP]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!Error reports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Skip because we can&#x27;t identify a unique slave.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>What matters here is that the first two connection tests are <code>OK</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="switching-to-read-only-mode">Switching to read-only mode<a href="#switching-to-read-only-mode" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>Now that everything is well configured, enable the <code>read_only</code> on both database servers by uncommenting (<em>i.e.</em> removing the <code>#</code> at the beginning of the line) this instruction in the <code>/etc/my.cnf.d/server.cnf</code> file:</p><ul><li>Primary node:</li></ul><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server-id=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log-bin=mysql-bin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Secondary node:</li></ul><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server-id=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log-bin=mysql-bin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then apply this change by restarting MariaDB on both nodes:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart mysql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Now that everything is well configured, enable the <code>read_only</code> on both database servers by uncommenting (<em>i.e.</em> removing the <code>#</code> at the beginning of the line) this instruction in the <code>/etc/mysql/mariadb.conf.d/50-server.cnf</code> file:</p><ul><li>Primary node</li></ul><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server-id=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log-bin=mysql-bin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Secondary node</li></ul><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server-id=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log-bin=mysql-bin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, apply this change by restarting MariaDB on both nodes:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart mariadb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="synchronizing-the-databases-and-enabling-mariadb-replication">Synchronizing the databases and enabling MariaDB replication<a href="#synchronizing-the-databases-and-enabling-mariadb-replication" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>In the process of synchronizing the databases, you will first stop the secondary database process so that its data can be overwritten by the primary node&#x27;s data. </p><p>Run this command <strong>on the secondary node:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl stop mysql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It is important to make sure that MariaDB is completely shut down. Run this command and check that it returns no output:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-ef</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> mariadb</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">d</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In case one or more processes are still alive, run this other command (it will prompt for the MariaDB root password):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysqladmin </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">shutdown</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once the service is stopped <strong>on the secondary node</strong>, run the synchronization script <strong>from the primary database node</strong>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/centreon-ha/bin/mysql-sync-bigdb.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This script will perform the following actions:</p><ul><li>checking that MariaDB is stopped on the secondary node</li><li>stopping MariaDB on the primary node</li><li>mounting an LVM snapshot on the same volume group that holds <code>/var/lib/mysql</code> (or whatever mount point holds the MariaDB data files)</li><li>starting MariaDB again on the primary node</li><li>recording the current position in the binary log</li><li>disabling the <code>read_only</code> mode on the primary node (this node will now be able to write to its database)</li><li>synchronizing/overwriting all the data files (except for the <code>mysql</code> system database) </li><li>unmounting the LVM snapshot</li><li>creating the replication thread that will keep both databases synchronized</li></ul><p>This script&#x27;s output is very verbose and you can&#x27;t expect to understand everything, so to make sure it went well, focus on the last lines of its output, checking that it looks like this:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Umount and Delete LVM snapshot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Logical volume &quot;dbbackupdatadir&quot; successfully removed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Start MySQL Slave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Start Replication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Id  User    Host    db  Command Time    State   Info    Progress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[variable number of lines]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The important thing to check is that <code>Start MySQL Slave</code> and <code>Start Replication</code> are present and are not followed by any errors.</p><p>In addition, the output of this command must display only <code>OK</code> results:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/centreon-ha/bin/mysql-check-status.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The expected output is:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Connection MASTER Status &#x27;@DATABASE_MASTER_NAME@&#x27; [OK]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection SLAVE Status &#x27;@DATABASE_SLAVE_NAME@&#x27; [OK]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slave Thread Status [OK]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Position Status [OK]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-the-centreon-cluster">Setting up the <em>Centreon</em> cluster<a href="#setting-up-the-centreon-cluster" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p><strong>Note</strong>: unless otherwise stated, each of the following steps must be run <strong>on both central nodes (<code>@CENTRAL_MASTER_NAME@</code> and <code>@CENTRAL_SLAVE_NAME@</code>)</strong>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-the-file-synchronization-service">Configuring the file synchronization service<a href="#configuring-the-file-synchronization-service" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>The file synchronization <code>centreon-central-sync</code> service needs the IP address of the peer node to be entered in its configuration file (<code>/etc/centreon-ha/centreon_central_sync.pm</code>).</p><p>So, on the <code>@CENTRAL_MASTER_NAME@</code> server, the configuration file should look like this:</p><div class="language-perl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-perl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">our</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">%centreon_central_sync_config</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    peer_addr </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_SLAVE_IPADDR@&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And on <code>@CENTRAL_SLAVE_NAME@</code>:</p><div class="language-perl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-perl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">our</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">%centreon_central_sync_config</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    peer_addr </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_MASTER_IPADDR@&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="removing-legacy-centreon-cron-jobs">Removing legacy Centreon cron jobs<a href="#removing-legacy-centreon-cron-jobs" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>In a high-availability setup, gorgone daemon manages all cron-based scheduled tasks. To avoid cron on both nodes, remove all Centreon-related cron from the /etc/cron.d/ directory:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> /etc/cron.d/centreon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> /etc/cron.d/centstorage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> /etc/cron.d/centreon-auto-disco</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> /etc/cron.d/centreon-ha-mysql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="permission-modifications">Permission modifications<a href="#permission-modifications" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>Modifications must be made to the permissions for the <code>/var/log/centreon-engine</code> and <code>/tmp/centreon-autodisco</code> directories.</p><p>In a clustered setup, it is a requirement to obtain a fully functional file sync and discovery scheduled task. </p><ul><li>File synchronization</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">775</span><span class="token plain"> /var/log/centreon-engine/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> /var/log/centreon-engine/archives</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> centreon-engine: /var/log/centreon-engine/archives</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">775</span><span class="token plain"> /var/log/centreon-engine/archives/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> /var/log/centreon-engine/ </span><span class="token parameter variable" style="color:#36acaa">-type</span><span class="token plain"> f </span><span class="token parameter variable" style="color:#36acaa">-exec</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">664</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> /usr/share/centreon/www/img/media </span><span class="token parameter variable" style="color:#36acaa">-type</span><span class="token plain"> d </span><span class="token parameter variable" style="color:#36acaa">-exec</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">775</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> /usr/share/centreon/www/img/media </span><span class="token parameter variable" style="color:#36acaa">-type</span><span class="token plain"> f </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-iname</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.keep&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-iname</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.htaccess&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-exec</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">664</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Service discovery</li></ul><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> /tmp/centreon-autodisco/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> apache: /tmp/centreon-autodisco/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">775</span><span class="token plain"> /tmp/centreon-autodisco/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> /tmp/centreon-autodisco/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> www-data: /tmp/centreon-autodisco/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">775</span><span class="token plain"> /tmp/centreon-autodisco/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stopping-and-disabling-the-services">Stopping and disabling the services<a href="#stopping-and-disabling-the-services" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p><strong>Information:</strong> These operations must be applied to all nodes <code>@CENTRAL_MASTER_NAME@</code>, <code>@CENTRAL_SLAVE_NAME@</code>, <code>@DATABASE_MASTER_NAME@</code> and <code>@DATABASE_SLAVE_NAME@</code>. The entire Centreon suite is installed as a dependency of centreon-ha, but it will not be used on the database nodes and will not cause any trouble.</p><p>Centreon&#x27;s application services will no longer be launched at boot time; they will be managed by the clustering tools. These services must therefore be stopped and disabled:</p><p>For <strong> Central nodes </strong></p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl stop centengine snmptrapd centreontrapd gorgoned cbd httpd php-fpm centreon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl disable centengine snmptrapd centreontrapd gorgoned cbd httpd php-fpm centreon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl stop centengine snmptrapd centreontrapd gorgoned cbd apache2 php8.1-fpm centreon </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl disable centengine snmptrapd centreontrapd gorgoned cbd apache2 php8.1-fpm centreon </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>And for <strong>Database nodes</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl stop mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl disable mysql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>By default, the <code>mysql</code> service is enabled in both systemd and system V perspectives, so you should make sure it is disabled:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chkconfig</span><span class="token plain"> mysql off</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>By default, the <code>mysql</code> service is enabled in both systemd and system V perspectives, so you should make sure it is disabled:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">update-rc.d </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> mariadb remove</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-cluster">Creating the cluster<a href="#creating-the-cluster" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="activating-the-clustering-services">Activating the clustering services<a href="#activating-the-clustering-services" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>First we enable all the services and start <code>pcsd</code> on <strong>all nodes</strong>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start pcsd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="preparing-the-server-that-will-function-as-the-quorum-device">Preparing the server that will function as the <em>quorum device</em><a href="#preparing-the-server-that-will-function-as-the-quorum-device" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>You can use one of your pollers to play this role. It must be prepared with the commands below: </p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">RHEL 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf config-manager </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> ha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> pcs corosync-qnetd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start pcsd.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> pcsd.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs qdevice setup model net </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs qdevice status net </span><span class="token parameter variable" style="color:#36acaa">--full</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> dnf-plugins-core https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subscription-manager repos </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> rhel-8-for-x86_64-highavailability-rpms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> pcs corosync-qnetd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start pcsd.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> pcsd.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs qdevice setup model net </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs qdevice status net </span><span class="token parameter variable" style="color:#36acaa">--full</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dnf config-manager </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> ol8_addons</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnf </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> pcs corosync-qnetd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start pcsd.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> pcsd.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs qdevice setup model net </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs qdevice status net </span><span class="token parameter variable" style="color:#36acaa">--full</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> pcs corosync-qnetd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start pcsd.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> pcsd.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs qdevice setup model net </span><span class="token parameter variable" style="color:#36acaa">--enable</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs qdevice status net </span><span class="token parameter variable" style="color:#36acaa">--full</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>Modify the parameter <code>COROSYNC_QNETD_OPTIONS</code> in the file <code>/etc/sysconfig/corosync-qnetd</code> to make sure the service will be listening to the connections on Ipv4 only:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">COROSYNC_QNETD_OPTIONS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-4&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Modify the parameter <code>COROSYNC_QNETD_OPTIONS</code> in the file <code>/etc/default/corosync-qnetd</code> to make sure the service will be listening to the connections on Ipv4 only</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">COROSYNC_QNETD_OPTIONS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-4&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="authenticating-to-the-clusters-members">Authenticating to the cluster&#x27;s members<a href="#authenticating-to-the-clusters-members" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>For the sake of simplicity, the <code>hacluster</code> user will be assigned the same password on <strong> all nodes, <code>@QDEVICE_NAME@</code> included</strong>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> hacluster</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now that both central nodes <strong>and</strong> the <em>quorum device</em> server share the same password, you will run this command <strong>only on one of the nodes</strong> in order to authenticate on all the hosts taking part in the cluster.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> auth </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_MASTER_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_SLAVE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@DATABASE_MASTER_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@DATABASE_SLAVE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@QDEVICE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hacluster&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@CENTREON_CLUSTER_PASSWD@&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>On Debian, the cluster is autoconfigured with default values. In order to install our cluster, we need to destroy this setup using the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs cluster destroy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then you can start the authentication of the cluster:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> auth </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_MASTER_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_SLAVE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@DATABASE_MASTER_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@DATABASE_SLAVE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@QDEVICE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hacluster&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@CENTREON_CLUSTER_PASSWD@&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-cluster-1">Creating the cluster<a href="#creating-the-cluster-1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>The following command creates the cluster. It must be run <strong>only on one of the nodes</strong>.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs cluster setup </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    centreon_cluster </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_MASTER_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_SLAVE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@DATABASE_MASTER_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@DATABASE_SLAVE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--force</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs cluster setup </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    centreon_cluster </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_MASTER_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_SLAVE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@DATABASE_MASTER_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;@DATABASE_SLAVE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--force</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>Then start the <code>pacemaker</code> service <strong>on both central and database nodes</strong>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> pacemaker pcsd corosync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start pacemaker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And afterward define these properties <strong>only on one node</strong>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs property </span><span class="token builtin class-name">set</span><span class="token plain"> symmetric-cluster</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs property </span><span class="token builtin class-name">set</span><span class="token plain"> stonith-enabled</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;false&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource defaults resource-stickiness</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;100&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can now monitor the state of the cluster with the <code>crm_mon -f</code> command, which will display new resources as they appear.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-quorum-device">Creating the <em>Quorum Device</em><a href="#creating-the-quorum-device" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>Run this command on one of the central nodes:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs quorum device </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> model net </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">host</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@QDEVICE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">algorithm</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;ffsplit&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-mariadb-cluster-resources">Creating the MariaDB cluster resources<a href="#creating-the-mariadb-cluster-resources" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>All commands within this section should be exectued on <strong>only one Cluster node</strong>. The configuration will be spread automatically.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="primary--secondary-mysql-processes">Primary &amp; Secondary MySQL Processes<a href="#primary--secondary-mysql-processes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create </span><span class="token string" style="color:#e3116c">&quot;ms_mysql&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ocf:heartbeat:mariadb-centreon </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">config</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/etc/my.cnf.d/server.cnf&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">pid</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/var/lib/mysql/mysql.pid&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">datadir</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/var/lib/mysql&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">socket</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/var/lib/mysql/mysql.sock&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">binary</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/usr/bin/mysqld_safe&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">node_list</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@DATABASE_MASTER_NAME@ @DATABASE_SLAVE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">replication_user</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@MARIADB_REPL_USER@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">replication_passwd</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">test_user</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@MARIADB_REPL_USER@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">test_passwd</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">test_table</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;centreon.host&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create </span><span class="token string" style="color:#e3116c">&quot;ms_mysql&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ocf:heartbeat:mariadb-centreon </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">config</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/etc/mysql/mariadb.conf.d/50-server.cnf&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">pid</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/run/mysqld/mysqld.pid&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">datadir</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/var/lib/mysql&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">socket</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/run/mysqld/mysqld.sock&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">binary</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/usr/bin/mysqld_safe&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">node_list</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">replication_user</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@MARIADB_REPL_USER@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">replication_passwd</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">test_user</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@MARIADB_REPL_USER@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">test_passwd</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_REPL_PASSWD@&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">test_table</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;centreon.host&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><blockquote><p><strong>WARNING:</strong> the syntax of the following command depends on the Linux Distribution you are using.</p></blockquote><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource promotable ms_mysql </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    master-node-max</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">clone_max</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    globally-unique</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;false&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clone-node-max</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">notify</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource promotable ms_mysql </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    master-node-max</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">clone_max</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    globally-unique</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;false&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clone-node-max</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">notify</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mariadb-virtual-ip-address">MariaDB Virtual IP Address<a href="#mariadb-virtual-ip-address" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create vip_mysql </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ocf:heartbeat:IPaddr2 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">ip</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@VIP_SQL_IPADDR@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">nic</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@VIP_SQL_IFNAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">cidr_netmask</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@VIP_SQL_CIDR_NETMASK@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">broadcast</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@VIP_SQL_BROADCAST_IPADDR@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">flush_routes</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;stopped&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;10s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-clone-resources">Creating the clone resources<a href="#creating-the-clone-resources" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>Some resources must be running on only one node at a time (<code>centengine</code>, <code>gorgone</code>, <code>httpd</code>, ...), but some others can be running on both (the RRD broker and PHP). For the second kind, you must declare <em>clone</em> resources.</p><blockquote><p><strong>Warning:</strong> All the commands in this chapter should be run only once on the central node of your choice.</p></blockquote><h5 class="anchor anchorWithStickyNavbar_LWe7" id="php8-resource">PHP8 resource<a href="#php8-resource" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h5><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6">```bash pcs resource create &quot;php&quot; \ systemd:php-fpm \ meta target-role=&quot;started&quot; \ op start interval=&quot;0s&quot; timeout=&quot;30s&quot; \ stop interval=&quot;0s&quot; timeout=&quot;30s&quot; \ monitor interval=&quot;5s&quot; timeout=&quot;30s&quot; \ clone ```</div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create </span><span class="token string" style="color:#e3116c">&quot;php&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd:php8.1-fpm </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;5s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clone</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="rrd-broker-resource">RRD broker resource<a href="#rrd-broker-resource" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h5><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create </span><span class="token string" style="color:#e3116c">&quot;cbd_rrd&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd:cbd </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;stopped&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;90s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;90s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clone</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-centreon-resource-group">Creating the <em>centreon</em> resource group<a href="#creating-the-centreon-resource-group" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="web-vip-address">Web VIP address<a href="#web-vip-address" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create vip </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ocf:heartbeat:IPaddr2 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">ip</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@VIP_IPADDR@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">nic</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@VIP_IFNAME@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">cidr_netmask</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@VIP_CIDR_NETMASK@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">broadcast</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;@VIP_BROADCAST_IPADDR@&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">flush_routes</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;stopped&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;10s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--group</span><span class="token plain"> centreon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="httpd-service">Httpd service<a href="#httpd-service" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create http </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd:httpd </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;40s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;40s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;5s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--group</span><span class="token plain"> centreon </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--force</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create http </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd:apache2 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;40s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;40s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;5s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--group</span><span class="token plain"> centreon </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--force</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="gorgone-service">Gorgone service<a href="#gorgone-service" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create gorgone </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd:gorgoned </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;stopped&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;90s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;90s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;5s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--group</span><span class="token plain"> centreon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="centreon-central-sync-service">centreon-central-sync service<a href="#centreon-central-sync-service" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>This service only exists in the context of <em>Centreon HA</em>. It provides real-time synchronization for configuration files, images, etc.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create centreon_central_sync </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd:centreon-central-sync </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;stopped&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;90s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;90s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;5s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--group</span><span class="token plain"> centreon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="sql-broker">SQL Broker<a href="#sql-broker" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create cbd_central_broker </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd:cbd-sql </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;stopped&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;90s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;90s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;5s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--group</span><span class="token plain"> centreon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="centengine-service">Centengine service<a href="#centengine-service" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create centengine </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd:centengine </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta multiple-active</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;stop_start&quot;</span><span class="token plain"> target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;stopped&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;90s&quot;</span><span class="token plain"> stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;90s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;5s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--group</span><span class="token plain"> centreon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="centreontrapd-service">Centreontrapd service<a href="#centreontrapd-service" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create centreontrapd </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd:centreontrapd </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;stopped&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;5s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--group</span><span class="token plain"> centreon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="snmptrapd-service">Snmptrapd service<a href="#snmptrapd-service" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create snmptrapd </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd:snmptrapd </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;stopped&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">op</span><span class="token plain"> start </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stop </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;30s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    monitor </span><span class="token assign-left variable" style="color:#36acaa">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;5s&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;20s&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">--group</span><span class="token plain"> centreon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="resource-constraints">Resource constraints<a href="#resource-constraints" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>When using the four-node architecture, you must define some specific constraints to specify where resources could run. </p><p>In order to colocate the Primary Database role with the Virtual IP, define a mutual constraint:</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint colocation </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;vip_mysql&quot;</span><span class="token plain"> with master </span><span class="token string" style="color:#e3116c">&quot;ms_mysql-clone&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint colocation </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> master </span><span class="token string" style="color:#e3116c">&quot;ms_mysql-clone&quot;</span><span class="token plain"> with </span><span class="token string" style="color:#e3116c">&quot;vip_mysql&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint colocation </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;vip_mysql&quot;</span><span class="token plain"> with master </span><span class="token string" style="color:#e3116c">&quot;ms_mysql-clone&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint colocation </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> master </span><span class="token string" style="color:#e3116c">&quot;ms_mysql-clone&quot;</span><span class="token plain"> with </span><span class="token string" style="color:#e3116c">&quot;vip_mysql&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>Create the constraint that prevents Centreon Processes from running on Database nodes and vice-versa: </p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint location centreon avoids @DATABASE_MASTER_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY @DATABASE_SLAVE_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint location ms_mysql-clone avoids @CENTRAL_MASTER_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY @CENTRAL_SLAVE_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint location cbd_rrd-clone avoids @DATABASE_MASTER_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY @DATABASE_SLAVE_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint location php-clone avoids @DATABASE_MASTER_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY @DATABASE_SLAVE_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint location centreon avoids @DATABASE_MASTER_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY @DATABASE_SLAVE_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint location ms_mysql-clone avoids @CENTRAL_MASTER_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY @CENTRAL_SLAVE_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint location cbd_rrd-clone avoids @DATABASE_MASTER_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY @DATABASE_SLAVE_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs constraint location php-clone avoids @DATABASE_MASTER_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY @DATABASE_SLAVE_NAME@</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">INFINITY</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="activate-the-cluster-and-check-the-operating-state-of-the-resources">Activate the cluster and check the operating state of the resources<a href="#activate-the-cluster-and-check-the-operating-state-of-the-resources" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enable-resources">Enable resources<a href="#enable-resources" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource </span><span class="token builtin class-name">enable</span><span class="token plain"> php-clone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource </span><span class="token builtin class-name">enable</span><span class="token plain"> cbd_rrd-clone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource meta vip target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource meta vip_mysql target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource meta centreontrapd target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource meta snmptrapd target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource meta centengine target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource meta cbd_central_broker target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource meta gorgone target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource meta centreon_central_sync target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource meta http target-role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;started&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="checking-the-state-of-the-cluster">Checking the state of the cluster<a href="#checking-the-state-of-the-cluster" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="checking-the-states-of-the-resources">Checking the states of the resources<a href="#checking-the-states-of-the-resources" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>You can monitor the cluster&#x27;s resources in real time using the <code>crm_mon -fr</code> command:</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cluster Summary:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Stack: corosync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Current DC: @CENTRAL_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">version </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain">.5-9.0.1.el8_4.1-ba59be7122</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> - partition with quorum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Last updated: Wed Sep </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">:00:13 </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Last change:  Wed Sep </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token plain">:26:53 </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain"> by root via crm_attribute on @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> nodes configured</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> resource instances configured</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Node List:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Online: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> @DATABASE_MASTER_NAME@ @DATABASE_SLAVE_NAME@ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Active Resources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Clone Set: ms_mysql-clone </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ms_mysql</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">promotable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Masters: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> @DATABASE_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Slaves: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> @DATABASE_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * vip_mysql   </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ocf::heartbeat:IPaddr2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:        Started @DATABASE_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Clone Set: php-clone </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">php</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Started: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Clone Set: cbd_rrd-clone </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbd_rrd</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Started: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Resource Group: centreon:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * vip       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ocf::heartbeat:IPaddr2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:        Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * http      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:httpd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:         Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * gorgone   </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:gorgoned</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:      Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * centreon_central_sync     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:centreon-central-sync</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:         Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * cbd_central_broker        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:cbd-sql</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:       Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * centengine        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:centengine</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:    Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * centreontrapd     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:centreontrapd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:         Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * snmptrapd </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:snmptrapd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:     Started @CENTRAL_MASTER_NAME@</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cluster Summary:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Stack: corosync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Current DC: @CENTRAL_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">version </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain">.5-9.0.1.el8_4.1-ba59be7122</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> - partition with quorum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Last updated: Wed Sep </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">:00:13 </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Last change:  Wed Sep </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token plain">:26:53 </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain"> by root via crm_attribute on @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> nodes configured</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> resource instances configured</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Node List:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Online: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> @DATABASE_MASTER_NAME@ @DATABASE_SLAVE_NAME@ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Active Resources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Clone Set: ms_mysql-clone </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ms_mysql</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">promotable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Masters: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> @DATABASE_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Slaves: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> @DATABASE_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * vip_mysql   </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ocf::heartbeat:IPaddr2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:        Started @DATABASE_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Clone Set: php-clone </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">php</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Started: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Clone Set: cbd_rrd-clone </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbd_rrd</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Started: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Resource Group: centreon:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * vip       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ocf::heartbeat:IPaddr2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:        Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * http      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:httpd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:         Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * gorgone   </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:gorgoned</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:      Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * centreon_central_sync     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:centreon-central-sync</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:         Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * cbd_central_broker        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:cbd-sql</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:       Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * centengine        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:centengine</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:    Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * centreontrapd     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:centreontrapd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:         Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * snmptrapd </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">systemd:snmptrapd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:     Started @CENTRAL_MASTER_NAME@</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>If <strong>centreon_central_sync</strong> won&#x27;t start, check if the folder <code>/usr/share/centreon-broker/lua</code> exists <strong>on both central nodes</strong>.</p><p>If not, you can create it with this command: <code>mkdir -p /usr/share/centreon-broker/lua</code>. And launch a cleanup with this command: <code>pcs resource cleanup</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="disabled-resources">Disabled resources<a href="#disabled-resources" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>When you do a <code>crm_mon -fr</code> and you have a resource that is disabled:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Master/Slave Set: ms_mysql-master [ms_mysql]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Masters: [ @DATABASE_MASTER_NAME@ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Slaves: [ @DATABASE_SLAVE_NAME@ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Stopped: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vip_mysql       (ocf::heartbeat:IPaddr2):       Stopped (disabled)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You must enable the resource with the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource </span><span class="token builtin class-name">enable</span><span class="token plain"> @RESSOURCE_NAME@</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In our case:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource </span><span class="token builtin class-name">enable</span><span class="token plain"> vip_mysql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="checking-the-database-replication-thread">Checking the database replication thread<a href="#checking-the-database-replication-thread" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>The MariaDB replication state can be monitored at any time with the <code>mysql-check-status.sh</code> command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/centreon-ha/bin/mysql-check-status.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The expected output is:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Connection MASTER Status </span><span class="token string" style="color:#e3116c">&#x27;@DATABASE_MASTER_NAME@&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection SLAVE Status </span><span class="token string" style="color:#e3116c">&#x27;@DATABASE_SLAVE_NAME@&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slave Thread Status </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Position Status </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It can happen that the replication thread does not run properly after installation.  Restarting the <code>ms_mysql</code> resource may fix it.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource restart ms_mysql-clone</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource restart ms_mysql-clone</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="checking-the-constraints">Checking the constraints<a href="#checking-the-constraints" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4><p>Normally, the two colocation constraints created during the setup should be the only constraints the <code>pcs constraint</code> command displays:</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Alma / RHEL / Oracle Linux 8</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Debian 11</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Location Constraints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource: cbd_rrd-clone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource: centreon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource: ms_mysql-clone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @CENTRAL_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @CENTRAL_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource: php-clone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ordering Constraints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Colocation Constraints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vip_mysql with ms_mysql-clone </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rsc-role:Started</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">with-rsc-role:Master</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ms_mysql-clone with vip_mysql </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rsc-role:Master</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">with-rsc-role:Started</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ticket Constraints:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Location Constraints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource: cbd_rrd-clone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource: centreon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource: ms_mysql-clone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @CENTRAL_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @CENTRAL_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource: php-clone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_MASTER_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Disabled on: @DATABASE_SLAVE_NAME@ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:-INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ordering Constraints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Colocation Constraints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vip_mysql with ms_mysql-clone </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rsc-role:Started</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">with-rsc-role:Master</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ms_mysql-clone with vip_mysql </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score:INFINITY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rsc-role:Master</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">with-rsc-role:Started</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ticket Constraints:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="modifying-the-centreon-configuration-files">Modifying the Centreon configuration files<a href="#modifying-the-centreon-configuration-files" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>Following the installation of the cluster and the <em>vip_mysql</em>, it is necessary to modify the output of the Centreon Broker and three configuration files of the Central. These elements will have to point to the <em>vip_mysql</em> in order to always point to the active MariaDB node.
These three files are:</p><ul><li>/etc/centreon/centreon.conf.php</li><li>/etc/centreon/conf.pm</li><li>/etc/centreon/config.d/10-database.yaml
You will need to replace the IP of the previous database with the IP of the <em>vip_mysql</em></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modifying-central-broker-master-outputs">Modifying central-broker-master outputs<a href="#modifying-central-broker-master-outputs" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>This is configured in the Centreon Broker configuration menu in the <em>Output</em> tab of <em>Configuration &gt; Collectors &gt; Centreon Broker Configuration</em>.</p><ul><li>Modify the &quot;IPv4&quot; output by replacing &quot;@DATABASE_MASTER_IPADDR@&quot; with @VIP_SQL_IPADDR@ in <em>central-broker-master</em> configuration:</li></ul><table><thead><tr><th>Broker Output</th><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Unified SQL</td><td>DB host</td><td>@VIP_SQL_IPADDR@</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="exporting-configuration">Exporting configuration<a href="#exporting-configuration" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>Once the actions in the previous paragraph have been completed, the configuration must be exported (first three boxes for the &quot;Central&quot; poller export) for it to take effect.</p><p>These actions must be performed only on <code>@CENTRAL_MASTER_NAME@</code> and then the broker configuration files must be copied to <code>@CENTRAL_SLAVE_NAME@</code>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">rsync</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> /etc/centreon-broker/*json @CENTRAL_SLAVE_IPADDR@:/etc/centreon-broker/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modification-of-the-three-configuration-files">Modification of the three configuration files<a href="#modification-of-the-three-configuration-files" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3><p>After modifying the output of the broker, we must modify the Centreon configuration files.
To do this, first, edit the file <code>/etc/centreon/conf.pm</code> and replace @DATABASE<em>MASTER_IPADDR@ with the address of the _vip-mysql</em>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#############################################</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># File Added by Centreon</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$centreon_config</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       VarLib </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/var/lib/centreon&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       CentreonDir </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/usr/share/centreon/&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       CacheDir </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/var/cache/centreon/&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string" style="color:#e3116c">&quot;centreon_db&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;centreon&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string" style="color:#e3116c">&quot;centstorage_db&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;centreon_storage&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string" style="color:#e3116c">&quot;db_host&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@VIP_SQL_IPADDR@:3306&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string" style="color:#e3116c">&quot;db_user&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@MARIADB_CENTREON_USER@&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string" style="color:#e3116c">&quot;db_passwd&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_PASSWD@&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Central or Poller?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$instance_mode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;central&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Centreon Centcore Command File</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$cmdFile</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/var/lib/centreon/centcore.cmd&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Deprecated format of Config file.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$mysql_user</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@MARIADB_CENTREON_USER@&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$mysql_passwd</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$mysql_host</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@VIP_SQL_IPADDR@:3306&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$mysql_database_oreon</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;centreon&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$mysql_database_ods</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;centreon_storage&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then perform the same operation in the file <code>/etc/centreon/centreon.conf.php</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Centreon is developed with GPL Licence </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Developed by: Julien Mathis - Romain Le Merlus - Christophe Coraboeuf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * The Software is provided to you AS IS and WITH ALL FAULTS.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Centreon makes no representation and gives no warranty whatsoever,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * whether express or implied, and without limitation, with regard to the quality,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * safety, contents, performance, merchantability, non-infringement or suitability </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * any particular or intended purpose of the Software found on the Centreon website.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * In no event will Centreon be liable </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> any direct, indirect, punitive, special,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * incidental or consequential damages however they may arise and even </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> Centreon has</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * been previously advised of the possibility of such damages.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * For information: contact@centreon.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*      Database */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$conf_centreon</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;hostCentreon&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@VIP_SQL_IPADDR@&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$conf_centreon</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;hostCentstorage&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@VIP_SQL_IPADDR@&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$conf_centreon</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;user&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@MARIADB_CENTREON_USER@&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$conf_centreon</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@MARIADB_CENTREON_PASSWD@&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$conf_centreon</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;db&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;centreon&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$conf_centreon</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;dbcstg&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;centreon_storage&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$conf_centreon</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;port&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3306&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* path to classes */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$classdir</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;./class&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* Centreon Path */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$centreon_path</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;/usr/share/centreon/&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And finish with the last file <code>/etc/centreon/config.d/10-database.yaml</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">database:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  db_configuration:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dsn: </span><span class="token string" style="color:#e3116c">&quot;mysql:host=@VIP_SQL_IPADDR@:3306;dbname=centreon&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    username: </span><span class="token string" style="color:#e3116c">&quot;@MARIADB_CENTREON_USER@&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    password: </span><span class="token string" style="color:#e3116c">&quot;@MARIADB_CENTREON_PASSWD@&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  db_realtime:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dsn: </span><span class="token string" style="color:#e3116c">&quot;mysql:host=@VIP_SQL_IPADDR@:3306;dbname=centreon_storage&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    username: </span><span class="token string" style="color:#e3116c">&quot;@MARIADB_CENTREON_USER@&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    password: </span><span class="token string" style="color:#e3116c">&quot;@MARIADB_CENTREON_PASSWD@&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And then you need to restart the gorgone and cbd_central_broker resources for changes to take effect.
Use the following command to restart the gorgone resource and all subsequent resources:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource restart gorgone</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After resources are restarted, verify if all is OK using the command <code>crm_mon -fr</code>. The result should look like this:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cluster Summary:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Stack: corosync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Current DC: @CENTRAL_MASTER_NAME@ (version 2.1.4-5.el8_7.2-dc6eb4362e) - partition with quoru</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Last updated: Wed Nov 23 10:27:48 2022</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Last change:  Wed Nov 23 10:27:43 2022 by hacluster via crmd on @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * 4 nodes configured</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * 21 resource instances configured</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Node List:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Online: [ @CENTRAL_MASTER_NAME@ centreon-rhel8-pri-bdd @CENTRAL_SLAVE_NAME@ @DATABASE_SLAVE_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Full List of Resources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Clone Set: ms_mysql-clone [ms_mysql] (promotable):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Masters: [ centreon-rhel8-pri-bdd ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Slaves: [ @DATABASE_SLAVE_NAME@ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Stopped: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * vip_mysql   (ocf::heartbeat:IPaddr2):        Started centreon-rhel8-pri-bdd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Clone Set: php-clone [php]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Started: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Stopped: [ centreon-rhel8-pri-bdd @DATABASE_SLAVE_NAME@ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Clone Set: cbd_rrd-clone [cbd_rrd]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Started: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Stopped: [ centreon-rhel8-pri-bdd @DATABASE_SLAVE_NAME@ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Resource Group: centreon:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * vip       (ocf::heartbeat:IPaddr2):        Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * http      (systemd:httpd):         Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * gorgone   (systemd:gorgoned):      Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * centreon_central_sync     (systemd:centreon-central-sync):         Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * cbd_central_broker        (systemd:cbd-sql):       Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * centengine        (systemd:centengine):    Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * centreontrapd     (systemd:centreontrapd):         Started@CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * snmptrapd (systemd:snmptrapd):     Started @CENTRAL_MASTER_NAME@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Migration Summary:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If an error is found while your resources are running, try doing some &quot;cleaning&quot; using this command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource cleanup</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="integrating-pollers">Integrating pollers<a href="#integrating-pollers" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2><p>You can now <a href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/integrating-pollers/">add your pollers</a> and begin to monitor!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/centreon/centreon-documentation/edit/staging/versioned_docs/version-23.10/installation/installation-of-centreon-ha/installation-4-nodes.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col"><svg id="feedback" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 24 24" xml:space="preserve" fill="none" style="height:24px;width:24px;vertical-align:text-top;margin-right:4px"><rect y="0" class="st0" width="24" height="24"></rect><rect x="2" y="2" class="st0" width="20" height="20"></rect><path fill="none" stroke="currentColor" stroke-miterlimit="10" d="M16.14,9.08c0,3.09-2.76,5.6-6.16,5.6c-1.11,0-5.45,0-5.45,0s1.36-1.38,0.93-1.79c-1.02-1-1.64-2.34-1.64-3.81 c0-3.09,2.76-5.6,6.16-5.6S16.14,5.99,16.14,9.08z"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" d="M8.61,16.28c0.76,2.31,3.12,4,5.91,4c1.11,0,5.45,0,5.45,0s-1.36-1.38-0.93-1.79c1.02-1,1.64-2.34,1.64-3.81 c0-2-1.15-3.75-2.88-4.74"></path><line fill="none" stroke="currentColor" stroke-linecap="round" x1="6.78" y1="6.86" x2="13.55" y2="6.86"></line><line fill="none" stroke="currentColor" stroke-linecap="round" x1="6.78" y1="8.74" x2="13.55" y2="8.74"></line><line fill="none" stroke="currentColor" stroke-linecap="round" x1="6.78" y1="10.62" x2="13.55" y2="10.62"></line></svg><a rel="noreferrer noopener" href="https://docs.google.com/forms/d/e/1FAIpQLSdeKkEHWbxn4ZweR1M4OEMzP_QoqKmjl6t4iC_yKeX2CFjzAw/viewform?usp=pp_url&amp;entry.371845164=docs.centreon.com/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-4-nodes/" target="_blank">Give feedback on this page</a></div><div class="col lastUpdated_VsjB"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-11-13T10:40:45.000Z">Nov 13, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/installation-2-nodes/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Installing a Centreon HA 2-nodes cluster</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/centreon-documentation/pr-preview/staging/pr-2806/docs/installation/installation-of-centreon-ha/integrating-pollers/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Integrating new pollers in a Centreon-HA cluster</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a><ul><li><a href="#understanding" class="table-of-contents__link toc-highlight">Understanding</a></li><li><a href="#network-flows" class="table-of-contents__link toc-highlight">Network Flows</a></li><li><a href="#installed-centreon-platform" class="table-of-contents__link toc-highlight">Installed Centreon platform</a></li><li><a href="#quorum-device" class="table-of-contents__link toc-highlight">Quorum Device</a></li><li><a href="#defining-hosts-names-and-addresses" class="table-of-contents__link toc-highlight">Defining hosts&#39; names and addresses</a></li><li><a href="#configuring-centreon-broker" class="table-of-contents__link toc-highlight">Configuring centreon-broker</a></li><li><a href="#customizing-poller-reload-command" class="table-of-contents__link toc-highlight">Customizing poller reload command</a></li></ul></li><li><a href="#system-settings" class="table-of-contents__link toc-highlight">System settings</a><ul><li><a href="#kernel-network-tuning" class="table-of-contents__link toc-highlight">Kernel network tuning</a></li><li><a href="#name-resolution" class="table-of-contents__link toc-highlight">Name resolution</a></li><li><a href="#installing-system-packages" class="table-of-contents__link toc-highlight">Installing system packages</a></li><li><a href="#ssh-keys-exchange" class="table-of-contents__link toc-highlight">SSH keys exchange</a></li></ul></li><li><a href="#configuring-the-mariadb-database-replication" class="table-of-contents__link toc-highlight">Configuring the MariaDB database replication</a><ul><li><a href="#configuring-mariadb" class="table-of-contents__link toc-highlight">Configuring MariaDB</a></li><li><a href="#securing-the-database-server" class="table-of-contents__link toc-highlight">Securing the database server</a></li><li><a href="#creating-the-centreon-mariadb-account" class="table-of-contents__link toc-highlight">Creating the <code>centreon</code> MariaDB account</a></li><li><a href="#creating-the-mariadb-replication-account" class="table-of-contents__link toc-highlight">Creating the MariaDB replication account</a></li><li><a href="#configuring-the-mariadb-scripts-environment-variables" class="table-of-contents__link toc-highlight">Configuring the MariaDB scripts environment variables</a></li><li><a href="#switching-to-read-only-mode" class="table-of-contents__link toc-highlight">Switching to read-only mode</a></li><li><a href="#synchronizing-the-databases-and-enabling-mariadb-replication" class="table-of-contents__link toc-highlight">Synchronizing the databases and enabling MariaDB replication</a></li></ul></li><li><a href="#setting-up-the-centreon-cluster" class="table-of-contents__link toc-highlight">Setting up the <em>Centreon</em> cluster</a><ul><li><a href="#configuring-the-file-synchronization-service" class="table-of-contents__link toc-highlight">Configuring the file synchronization service</a></li><li><a href="#removing-legacy-centreon-cron-jobs" class="table-of-contents__link toc-highlight">Removing legacy Centreon cron jobs</a></li><li><a href="#permission-modifications" class="table-of-contents__link toc-highlight">Permission modifications</a></li><li><a href="#stopping-and-disabling-the-services" class="table-of-contents__link toc-highlight">Stopping and disabling the services</a></li><li><a href="#creating-the-cluster" class="table-of-contents__link toc-highlight">Creating the cluster</a></li><li><a href="#creating-the-mariadb-cluster-resources" class="table-of-contents__link toc-highlight">Creating the MariaDB cluster resources</a></li><li><a href="#creating-the-clone-resources" class="table-of-contents__link toc-highlight">Creating the clone resources</a></li><li><a href="#creating-the-centreon-resource-group" class="table-of-contents__link toc-highlight">Creating the <em>centreon</em> resource group</a></li><li><a href="#resource-constraints" class="table-of-contents__link toc-highlight">Resource constraints</a></li><li><a href="#activate-the-cluster-and-check-the-operating-state-of-the-resources" class="table-of-contents__link toc-highlight">Activate the cluster and check the operating state of the resources</a></li><li><a href="#checking-the-state-of-the-cluster" class="table-of-contents__link toc-highlight">Checking the state of the cluster</a></li></ul></li><li><a href="#modifying-the-centreon-configuration-files" class="table-of-contents__link toc-highlight">Modifying the Centreon configuration files</a><ul><li><a href="#modifying-central-broker-master-outputs" class="table-of-contents__link toc-highlight">Modifying central-broker-master outputs</a></li><li><a href="#exporting-configuration" class="table-of-contents__link toc-highlight">Exporting configuration</a></li><li><a href="#modification-of-the-three-configuration-files" class="table-of-contents__link toc-highlight">Modification of the three configuration files</a></li></ul></li><li><a href="#integrating-pollers" class="table-of-contents__link toc-highlight">Integrating pollers</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.centreon.com/en/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Corporate Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.centreon.com/en/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://download.centreon.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Download<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/centreon-documentation/pr-preview/staging/pr-2806/img/logo_centreon.png" alt="Centreon Open Source Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/centreon-documentation/pr-preview/staging/pr-2806/img/logo_centreon.png" alt="Centreon Open Source Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">Copyright Â© 2005 - 2023 Centreon</div></div></div></footer></div>
<script src="/centreon-documentation/pr-preview/staging/pr-2806/assets/js/runtime~main.0e131920.js"></script>
<script src="/centreon-documentation/pr-preview/staging/pr-2806/assets/js/main.c16a1087.js"></script>
</body>
</html>