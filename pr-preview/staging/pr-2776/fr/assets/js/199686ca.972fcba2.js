"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[67313],{52146:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>o,default:()=>N,frontMatter:()=>p,metadata:()=>u,toc:()=>m});n(67294);var a=n(3905);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}function i(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},l=Object.keys(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}const p={id:"developer-broker-bbdo",title:"Le protocole BBDO"},o=void 0,u={unversionedId:"developer/developer-broker-bbdo",id:"version-23.10/developer/developer-broker-bbdo",title:"Le protocole BBDO",description:"Le protocole BBDO a \xe9t\xe9 cr\xe9\xe9 pour \xeatre le protocole par d\xe9faut de Centreon Broker. Il est l\xe9ger, facile \xe0 d\xe9coder et sp\xe9cialement con\xe7u pour la surveillance des ressources avec Centreon Broker.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-23.10/developer/developer-broker-bbdo.md",sourceDirName:"developer",slug:"/developer/developer-broker-bbdo",permalink:"/centreon-documentation/pr-preview/staging/pr-2776/fr/docs/developer/developer-broker-bbdo",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/i18n/fr/docusaurus-plugin-content-docs/version-23.10/developer/developer-broker-bbdo.md",tags:[],version:"23.10",lastUpdatedAt:1699395750,formattedLastUpdatedAt:"7 nov. 2023",frontMatter:{id:"developer-broker-bbdo",title:"Le protocole BBDO"},sidebar:"version-23.10/docs",previous:{title:"Stream Connectors",permalink:"/centreon-documentation/pr-preview/staging/pr-2776/fr/docs/developer/developer-broker-stream-connector"},next:{title:"Mapping d\u2019\xe9v\xe8nements Centreon Broker",permalink:"/centreon-documentation/pr-preview/staging/pr-2776/fr/docs/developer/developer-broker-mapping"}},d={},m=[{value:"Introduction",id:"introduction",level:2},{value:"Types",id:"types",level:2},{value:"Format de paquet",id:"format-de-paquet",level:2},{value:"ID de paquet",id:"id-de-paquet",level:3},{value:"Cat\xe9gories d\u2019\xe9v\xe9nements",id:"cat\xe9gories-d\xe9v\xe9nements",level:2},{value:"NEB",id:"neb",level:3},{value:"Storage",id:"storage",level:3},{value:"BBDO",id:"bbdo",level:3},{value:"BAM",id:"bam",level:3},{value:"S\xe9rialisation des \xe9v\xe9nements",id:"s\xe9rialisation-des-\xe9v\xe9nements",level:2},{value:"Exemple",id:"exemple",level:2},{value:"\xc9tablissement de la connexion",id:"\xe9tablissement-de-la-connexion",level:2},{value:"Exemple",id:"exemple-1",level:3},{value:"Acquittement",id:"acquittement",level:2},{value:"Changement de version de BBDO",id:"changement-de-version-de-bbdo",level:2}],s={toc:m},k="wrapper";function N(t){var{components:e}=t,n=i(t,["components"]);return(0,a.kt)(k,l(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),a.forEach((function(e){r(t,e,n[e])}))}return t}({},s,n),{components:e,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Le protocole BBDO a \xe9t\xe9 cr\xe9\xe9 pour \xeatre le protocole par d\xe9faut de Centreon Broker. Il est l\xe9ger, facile \xe0 d\xe9coder et sp\xe9cialement con\xe7u pour la surveillance des ressources avec Centreon Broker."),(0,a.kt)("h2",{id:"introduction"},"Introduction"),(0,a.kt)("p",null,"BBDO est l\u2019abr\xe9viation de Broker Binary Data Object. BBDO est con\xe7u pour transf\xe9rer des \xab\xa0paquets de donn\xe9es\xa0\xbb d\u2019un n\u0153ud \xe0 un autre. Ces \xab\xa0paquets de donn\xe9es\xa0\xbb sont la plupart du temps des informations de supervision fournies par le moteur de supervision (par exemple le moteur Centreon Engine ou Nagios). Il utilise principalement des valeurs binaires brutes, ce qui lui permet d\u2019utiliser tr\xe8s peu de m\xe9moire."),(0,a.kt)("p",null,"Avec Broker\xa022.04.0, nous avons introduit une nouvelle version de BBDO bas\xe9e sur ",(0,a.kt)("a",{parentName:"p",href:"https://developers.google.com/protocol-buffers"},"Google Protobuf 3"),". Le nouveau protocole reste compatible avec le pr\xe9c\xe9dent mais introduit de nouveaux \xe9v\xe9nements. Par exemple, les \xe9v\xe9nements PbService et PbServiceStatus sont envoy\xe9s au lieu des \xe9v\xe9nements Service et ServiceStatus. Configur\xe9 avec BBDO\xa03, Broker comprend toujours les \xe9v\xe9nements Service et ServiceStatus mais il doit envoyer par d\xe9faut les nouvelles versions."),(0,a.kt)("h2",{id:"types"},"Types"),(0,a.kt)("p",null,"Cette section porte sur le protocole BBDO\xa02."),(0,a.kt)("p",null,"En tant que protocole binaire, BBDO utilise des types de donn\xe9es pour s\xe9rialiser les donn\xe9es. Ils sont \xe9crits dans un format Big Endian et d\xe9crits dans le tableau suivant."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Repr\xe9sentation"),(0,a.kt)("th",{parentName:"tr",align:null},"Taille (octets)"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"entier"),(0,a.kt)("td",{parentName:"tr",align:null},"binaire"),(0,a.kt)("td",{parentName:"tr",align:null},"4")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"entier court"),(0,a.kt)("td",{parentName:"tr",align:null},"binaire"),(0,a.kt)("td",{parentName:"tr",align:null},"2")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"entier long"),(0,a.kt)("td",{parentName:"tr",align:null},"binaire"),(0,a.kt)("td",{parentName:"tr",align:null},"8")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"temps"),(0,a.kt)("td",{parentName:"tr",align:null},"binaire (horodatage)"),(0,a.kt)("td",{parentName:"tr",align:null},"8")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"bool\xe9en"),(0,a.kt)("td",{parentName:"tr",align:null},"binaire (0 est False, tout le reste est True)"),(0,a.kt)("td",{parentName:"tr",align:null},"1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"cha\xeene"),(0,a.kt)("td",{parentName:"tr",align:null},"cha\xeene UTF-8 non termin\xe9e"),(0,a.kt)("td",{parentName:"tr",align:null},"variable")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"r\xe9el"),(0,a.kt)("td",{parentName:"tr",align:null},"cha\xeene UTF-8 non termin\xe9e (au format fixe (2013) ou scientifique (2.013e+3))"),(0,a.kt)("td",{parentName:"tr",align:null},"variable")))),(0,a.kt)("h2",{id:"format-de-paquet"},"Format de paquet"),(0,a.kt)("p",null,"Le format des paquets de Centreon Broker n\u2019introduit que 16\xa0octets d\u2019en-t\xeate pour transmettre chaque \xe9v\xe9nement de supervision (g\xe9n\xe9ralement environ 100-200\xa0octets chacun). Les champs sont fournis au format Big Endian."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Champ"),(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"checksum"),(0,a.kt)("td",{parentName:"tr",align:null},"entier court non sign\xe9"),(0,a.kt)("td",{parentName:"tr",align:null},"CRC-16-CCITT X.25 de la taille, de l\u2019ID, de la source et de la destination. La somme de contr\xf4le peut \xeatre utilis\xe9e pour r\xe9cup\xe9rer un paquet de donn\xe9es incomplet envoy\xe9 dans le flux en laissant tomber les octets un par un.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"size"),(0,a.kt)("td",{parentName:"tr",align:null},"entier court non sign\xe9"),(0,a.kt)("td",{parentName:"tr",align:null},"Taille du paquet, hors en-t\xeate.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"id"),(0,a.kt)("td",{parentName:"tr",align:null},"entier non sign\xe9"),(0,a.kt)("td",{parentName:"tr",align:null},"ID de l\u2019\xe9v\xe9nement.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"source","_","id"),(0,a.kt)("td",{parentName:"tr",align:null},"entier non sign\xe9"),(0,a.kt)("td",{parentName:"tr",align:null},"L\u2019ID de l\u2019instance source de cet \xe9v\xe9nement.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"destination","_","id"),(0,a.kt)("td",{parentName:"tr",align:null},"entier non sign\xe9"),(0,a.kt)("td",{parentName:"tr",align:null},"L\u2019ID de l\u2019instance de destination de cet \xe9v\xe9nement.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"data"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"Donn\xe9es utiles.")))),(0,a.kt)("p",null,"Ici, la seule diff\xe9rence entre BBDO\xa03 et les versions pr\xe9c\xe9dentes est le contenu des donn\xe9es. Dans BBDO\xa03, cette partie est un objet Protobuf s\xe9rialis\xe9 alors que dans les versions pr\xe9c\xe9dentes, il s\u2019agit de donn\xe9es s\xe9rialis\xe9es comme expliqu\xe9 dans la section Types."),(0,a.kt)("h3",{id:"id-de-paquet"},"ID de paquet"),(0,a.kt)("p",null,"Comme nous l\u2019avons vu dans le paragraphe pr\xe9c\xe9dent, chaque paquet contient un ID qui exprime par lui-m\xeame la fa\xe7on dont les donn\xe9es sont encod\xe9es. Cet ID peut \xeatre divis\xe9 en deux composants de 16\xa0bits. Les 16\xa0bits les plus significatifs sont la cat\xe9gorie d\u2019\xe9v\xe9nement et les 16\xa0bits les moins significatifs sont le type d\u2019\xe9v\xe9nement."),(0,a.kt)("p",null,"Les cat\xe9gories d\u2019\xe9v\xe9nements s\xe9rialisent les propri\xe9t\xe9s des \xe9v\xe9nements l\u2019une apr\xe8s l\u2019autre, l\u2019ordre est donc tr\xe8s important pour ne pas perdre le fil lors de la d\xe9s\xe9rialisation des \xe9v\xe9nements."),(0,a.kt)("h2",{id:"cat\xe9gories-d\xe9v\xe9nements"},"Cat\xe9gories d\u2019\xe9v\xe9nements"),(0,a.kt)("p",null,"Les cat\xe9gories actuellement disponibles sont d\xe9crites dans le tableau ci-dessous."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Cat\xe9gorie"),(0,a.kt)("th",{parentName:"tr",align:null},"macro API"),(0,a.kt)("th",{parentName:"tr",align:null},"Valeur"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"NEB"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO","_","NEB","_","TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"\xc9v\xe9nements classiques de supervision (h\xf4tes, services, notifications, gestionnaires d\u2019\xe9v\xe9nements, ex\xe9cution des plugins, ...).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"BBDO"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO","_","BBDO","_","TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"Cat\xe9gorie interne au protocole BBDO.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Storage"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO","_","STORAGE","_","TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"Cat\xe9gorie li\xe9e \xe0 la cr\xe9ation de graphiques RRD.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Correlation"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO","_","CORRELATION","_","TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"4"),(0,a.kt)("td",{parentName:"tr",align:null},"Corr\xe9lation d\u2019\xe9tat (obsol\xe8te).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dumper"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO","_","DUMPER","_","TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"5"),(0,a.kt)("td",{parentName:"tr",align:null},"\xc9v\xe9nements de dumper (utilis\xe9s uniquement pour les tests).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Bam"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO","_","BAM","_","TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"6"),(0,a.kt)("td",{parentName:"tr",align:null},"\xc9v\xe9nements BAM.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Extcmd"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO","_","EXTCMD","_","TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"7"),(0,a.kt)("td",{parentName:"tr",align:null},"Commandes externes de Centreon Broker (obsol\xe8te).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Internal"),(0,a.kt)("td",{parentName:"tr",align:null},"BBDO","_","INTERNAL","_","TYPE"),(0,a.kt)("td",{parentName:"tr",align:null},"65535"),(0,a.kt)("td",{parentName:"tr",align:null},"R\xe9serv\xe9 \xe0 l\u2019usage interne du protocole.")))),(0,a.kt)("h3",{id:"neb"},"NEB"),(0,a.kt)("p",null,"Le tableau ci-dessous r\xe9pertorie les types d\u2019\xe9v\xe9nements disponibles dans la cat\xe9gorie NEB. Ils doivent \xeatre combin\xe9s avec la cat\xe9gorie BBDO","_","NEB","_","TYPE pour obtenir un ID d\u2019\xe9v\xe9nement BBDO."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Valeur"),(0,a.kt)("th",{parentName:"tr",align:null},"Utilise Protobuf"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Acknowledgement"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Comment"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Custom variable"),(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Custom variable status"),(0,a.kt)("td",{parentName:"tr",align:null},"4"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Downtime"),(0,a.kt)("td",{parentName:"tr",align:null},"5"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Event handler"),(0,a.kt)("td",{parentName:"tr",align:null},"6"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Flapping status"),(0,a.kt)("td",{parentName:"tr",align:null},"7"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host check"),(0,a.kt)("td",{parentName:"tr",align:null},"8"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host dependency"),(0,a.kt)("td",{parentName:"tr",align:null},"9"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host group"),(0,a.kt)("td",{parentName:"tr",align:null},"10"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host group member"),(0,a.kt)("td",{parentName:"tr",align:null},"11"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host"),(0,a.kt)("td",{parentName:"tr",align:null},"12"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host parent"),(0,a.kt)("td",{parentName:"tr",align:null},"13"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Host status"),(0,a.kt)("td",{parentName:"tr",align:null},"14"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Instance"),(0,a.kt)("td",{parentName:"tr",align:null},"15"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Instance status"),(0,a.kt)("td",{parentName:"tr",align:null},"16"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Log entry"),(0,a.kt)("td",{parentName:"tr",align:null},"17"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Module"),(0,a.kt)("td",{parentName:"tr",align:null},"18"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service check"),(0,a.kt)("td",{parentName:"tr",align:null},"19"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service dependency"),(0,a.kt)("td",{parentName:"tr",align:null},"20"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service group"),(0,a.kt)("td",{parentName:"tr",align:null},"21"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service group member"),(0,a.kt)("td",{parentName:"tr",align:null},"22"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service"),(0,a.kt)("td",{parentName:"tr",align:null},"23"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Service status"),(0,a.kt)("td",{parentName:"tr",align:null},"24"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Instance Configuration"),(0,a.kt)("td",{parentName:"tr",align:null},"25"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Responsive Instance"),(0,a.kt)("td",{parentName:"tr",align:null},"26"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Service"),(0,a.kt)("td",{parentName:"tr",align:null},"27"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Adaptive Service"),(0,a.kt)("td",{parentName:"tr",align:null},"28"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Service Status"),(0,a.kt)("td",{parentName:"tr",align:null},"29"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Host"),(0,a.kt)("td",{parentName:"tr",align:null},"30"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Adaptive Host"),(0,a.kt)("td",{parentName:"tr",align:null},"31"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Host Status"),(0,a.kt)("td",{parentName:"tr",align:null},"32"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Severity"),(0,a.kt)("td",{parentName:"tr",align:null},"33"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Tag"),(0,a.kt)("td",{parentName:"tr",align:null},"34"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")))),(0,a.kt)("h3",{id:"storage"},"Storage"),(0,a.kt)("p",null,"Le tableau ci-dessous r\xe9pertorie les types d\u2019\xe9v\xe9nements disponibles dans la cat\xe9gorie Storage. Ils doivent \xeatre combin\xe9s avec la cat\xe9gorie BBDO","_","STORAGE","_","TYPE pour obtenir un ID d\u2019\xe9v\xe9nement BBDO."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Value"),(0,a.kt)("th",{parentName:"tr",align:null},"Utilise Protobuf"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Metric"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Rebuild"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Remove graph"),(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Status"),(0,a.kt)("td",{parentName:"tr",align:null},"4"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Index mapping"),(0,a.kt)("td",{parentName:"tr",align:null},"5"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Metric mapping"),(0,a.kt)("td",{parentName:"tr",align:null},"6"),(0,a.kt)("td",{parentName:"tr",align:null},"No")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Rebuild Message"),(0,a.kt)("td",{parentName:"tr",align:null},"7"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Remove Graph Message"),(0,a.kt)("td",{parentName:"tr",align:null},"8"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Metric"),(0,a.kt)("td",{parentName:"tr",align:null},"9"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Status"),(0,a.kt)("td",{parentName:"tr",align:null},"10"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Index mapping"),(0,a.kt)("td",{parentName:"tr",align:null},"11"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Metric mapping"),(0,a.kt)("td",{parentName:"tr",align:null},"12"),(0,a.kt)("td",{parentName:"tr",align:null},"Yes")))),(0,a.kt)("h3",{id:"bbdo"},"BBDO"),(0,a.kt)("p",null,"Le tableau ci-dessous r\xe9pertorie les types d\u2019\xe9v\xe9nements disponibles dans la cat\xe9gorie BBDO. Ils doivent \xeatre combin\xe9s avec la cat\xe9gorie BBDO","_","BBDO","_","TYPE pour obtenir un ID d\u2019\xe9v\xe9nement BBDO."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Valeur"),(0,a.kt)("th",{parentName:"tr",align:null},"Utilise Protobuf"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"version response"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"ack"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"stop"),(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb ack"),(0,a.kt)("td",{parentName:"tr",align:null},"8"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb stop"),(0,a.kt)("td",{parentName:"tr",align:null},"9"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")))),(0,a.kt)("h3",{id:"bam"},"BAM"),(0,a.kt)("p",null,"Le tableau ci-dessous r\xe9pertorie les types d\u2019\xe9v\xe9nements disponibles dans la cat\xe9gorie BAM. Ils doivent \xeatre combin\xe9s avec la cat\xe9gorie BBDO","_","BAM","_","TYPE pour obtenir un ID d\u2019\xe9v\xe9nement BBDO."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Valeur"),(0,a.kt)("th",{parentName:"tr",align:null},"Uses Protobuf"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"BA status"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"KPI status"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Meta Service Status"),(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"BA event"),(0,a.kt)("td",{parentName:"tr",align:null},"4"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"KPI event"),(0,a.kt)("td",{parentName:"tr",align:null},"5"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"BA Duration Event"),(0,a.kt)("td",{parentName:"tr",align:null},"6"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension BA Event"),(0,a.kt)("td",{parentName:"tr",align:null},"7"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension KPI Event"),(0,a.kt)("td",{parentName:"tr",align:null},"8"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension BA BV Relation Event"),(0,a.kt)("td",{parentName:"tr",align:null},"9"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension BV Event"),(0,a.kt)("td",{parentName:"tr",align:null},"10"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension Truncate Table Signal"),(0,a.kt)("td",{parentName:"tr",align:null},"11"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Rebuild"),(0,a.kt)("td",{parentName:"tr",align:null},"12"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension Timeperiod"),(0,a.kt)("td",{parentName:"tr",align:null},"13"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Dimension BA Timeperiod Relation"),(0,a.kt)("td",{parentName:"tr",align:null},"14"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Inherited Downtime"),(0,a.kt)("td",{parentName:"tr",align:null},"17"),(0,a.kt)("td",{parentName:"tr",align:null},"Non")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Inherited Downtime"),(0,a.kt)("td",{parentName:"tr",align:null},"18"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb BA status"),(0,a.kt)("td",{parentName:"tr",align:null},"19"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb BA event"),(0,a.kt)("td",{parentName:"tr",align:null},"20"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb KPI event"),(0,a.kt)("td",{parentName:"tr",align:null},"21"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension BV Event"),(0,a.kt)("td",{parentName:"tr",align:null},"22"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension BA BV Relation Event"),(0,a.kt)("td",{parentName:"tr",align:null},"23"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension Timeperiod"),(0,a.kt)("td",{parentName:"tr",align:null},"24"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension BA Event"),(0,a.kt)("td",{parentName:"tr",align:null},"25"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension KPI Event"),(0,a.kt)("td",{parentName:"tr",align:null},"26"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb KPI status"),(0,a.kt)("td",{parentName:"tr",align:null},"27"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb BA Duration Event"),(0,a.kt)("td",{parentName:"tr",align:null},"28"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension BA Timeperiod Relation"),(0,a.kt)("td",{parentName:"tr",align:null},"29"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pb Dimension Truncate Table Signal"),(0,a.kt)("td",{parentName:"tr",align:null},"30"),(0,a.kt)("td",{parentName:"tr",align:null},"Oui")))),(0,a.kt)("h2",{id:"s\xe9rialisation-des-\xe9v\xe9nements"},"S\xe9rialisation des \xe9v\xe9nements"),(0,a.kt)("p",null,"La plupart des \xe9v\xe9nements r\xe9pertori\xe9s dans chaque ",(0,a.kt)("a",{parentName:"p",href:"#cat%C3%A9gories-d%C3%A9v%C3%A9nements"},"cat\xe9gorie d\u2019\xe9v\xe9nements")," dispose d\u2019un mapping utilis\xe9 pour s\xe9rialiser leur contenu. En effet, leur contenu est directement s\xe9rialis\xe9 dans les ",(0,a.kt)("a",{parentName:"p",href:"#format-de-paquet"},"donn\xe9es utiles du paquet"),", un champ apr\xe8s l\u2019autre dans l\u2019ordre d\xe9crit dans les ",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2776/fr/docs/developer/developer-broker-mapping"},"tables de correspondance"),". Ils sont encod\xe9s selon les r\xe8gles d\xe9crites dans le ",(0,a.kt)("a",{parentName:"p",href:"#types"},"paragraphe sur les types"),"."),(0,a.kt)("h2",{id:"exemple"},"Exemple"),(0,a.kt)("p",null,"Prenons un exemple et voyons comment un ",(0,a.kt)("em",{parentName:"p"},"\xe9v\xe9nement")," ",(0,a.kt)("em",{parentName:"p"},"host check")," est envoy\xe9 dans un paquet. Son mapping est le suivant\xa0:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Propri\xe9t\xe9"),(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Valeur dans l\u2019exemple"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"active","_","checks","_","enabled"),(0,a.kt)("td",{parentName:"tr",align:null},"bool\xe9en"),(0,a.kt)("td",{parentName:"tr",align:null},"True.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"check","_","type"),(0,a.kt)("td",{parentName:"tr",align:null},"entier court"),(0,a.kt)("td",{parentName:"tr",align:null},"0 (contr\xf4le de l\u2019h\xf4te actif).")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"host","_","id"),(0,a.kt)("td",{parentName:"tr",align:null},"entier non sign\xe9"),(0,a.kt)("td",{parentName:"tr",align:null},"42")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"next","_","check"),(0,a.kt)("td",{parentName:"tr",align:null},"temps"),(0,a.kt)("td",{parentName:"tr",align:null},"1365080225")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"command","_","line"),(0,a.kt)("td",{parentName:"tr",align:null},"cha\xeene"),(0,a.kt)("td",{parentName:"tr",align:null},"./my","_","plugin -H 127.0.0.1")))),(0,a.kt)("p",null,"Et donne le paquet suivant avec les valeurs en hexad\xe9cimal."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"+-----------------+-----------------+-----------------------------------+\n|      CRC16      |      SIZE       |                ID                 |\n+========+========+========+========+========+========+========+========+\n|   0A   |   23   |   00   |   28   |   00   |   01   |   00   |   09   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n\n+--------+-----------------+-----------------------------------+--------\n| active_|                 |                                   |\n| checks_|    check_type   |              host_id              |    =>\n| enabled|                 |                                   |\n+========+========+========+========+==========================+========+\n|   01   |   00   |   00   |   00   |   00   |   00   |   2A   |   00   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n\n--------------------------+--------------------------------------------\n                            =>  next_check                      |    =>\n+========+========+========+========+========+========+========+========+\n|   00   |   00   |   00   |   51   |   5D   |   78   |   A1   |   2E   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n\n-----------------------------------------------------------------------\n                            => command_line =>\n+========+========+========+========+========+========+========+========+\n|   2F   |   6D   |   79   |   5F   |   70   |   6C   |   75   |   67   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n\n-----------------------------------------------------------------------\n                            => command_line =>\n+========+========+========+========+========+========+========+========+\n|   69   |   6E   |   20   |   2D   |   48   |   20   |   31   |   32   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n\n-----------------------------------------------------------------------+\n                            => command_line                              |\n+========+========+========+========+========+========+========+========+\n|   37   |   2E   |   30   |   2E   |   30   |   2E   |   31   |   00   |\n+--------+--------+--------+--------+--------+--------+--------+--------+\n")),(0,a.kt)("h2",{id:"\xe9tablissement-de-la-connexion"},"\xc9tablissement de la connexion"),(0,a.kt)("p",null,"BBDO est un protocole qui peut n\xe9gocier des fonctionnalit\xe9s. Lors de l\u2019\xe9tablissement d\u2019une connexion, un paquet ",(0,a.kt)("em",{parentName:"p"},"version_response")," est envoy\xe9 par le client. Il fournit la version du protocole BBDO qu\u2019il supporte et ses extensions. Le serveur r\xe9pond \xe0 ce message par un autre paquet ",(0,a.kt)("em",{parentName:"p"},"version_response")," contenant sa propre version du protocole support\xe9e et ses extensions. Si les versions du protocole correspondent, la n\xe9gociation des extensions commence."),(0,a.kt)("p",null,"Actuellement, deux extensions sont support\xe9es : ",(0,a.kt)("strong",{parentName:"p"},"TLS")," et ",(0,a.kt)("strong",{parentName:"p"},"COMPRESSION"),". Juste apr\xe8s le paquet ",(0,a.kt)("strong",{parentName:"p"},"version_response"),", chaque pair recherche dans la liste des extensions de l\u2019autre pair les extensions qu\u2019il supporte. Lorsqu\u2019il en trouve une, elle est activ\xe9e (c\u2019est-\xe0-dire qu\u2019elle d\xe9marre imm\xe9diatement)."),(0,a.kt)("h3",{id:"exemple-1"},"Exemple"),(0,a.kt)("p",null,"Prenons ",(0,a.kt)("strong",{parentName:"p"},"C")," le client et ",(0,a.kt)("strong",{parentName:"p"},"S")," le serveur. Les \xe9tapes suivantes sont effectu\xe9es de mani\xe8re s\xe9quentielle."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"C")," initie une connexion TCP avec ",(0,a.kt)("strong",{parentName:"li"},"S")," et la connexion est \xe9tablie."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"C")," envoie un paquet ",(0,a.kt)("em",{parentName:"li"},"version","_","response")," avec les attributs suivants",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"protocole majeur\xa0: 1"),(0,a.kt)("li",{parentName:"ul"},"protocole mineur\xa0: 0"),(0,a.kt)("li",{parentName:"ul"},"protocole correctif\xa0: 0"),(0,a.kt)("li",{parentName:"ul"},"extensions\xa0: \xab\xa0TLS COMPRESSION\xa0\xbb"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"S")," envoie son propre paquet ",(0,a.kt)("strong",{parentName:"li"},"version","_","response")," en r\xe9ponse \xe0 ",(0,a.kt)("strong",{parentName:"li"},"C"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"protocole majeur\xa0: 1"),(0,a.kt)("li",{parentName:"ul"},"protocole mineur\xa0: 0"),(0,a.kt)("li",{parentName:"ul"},"protocole correctif\xa0: 0"),(0,a.kt)("li",{parentName:"ul"},"extensions\xa0: \xab\xa0TLS COMPRESSION\xa0\xbb"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"C")," et ",(0,a.kt)("strong",{parentName:"li"},"S")," d\xe9terminent les extensions qu\u2019ils ont en commun (ici TLS et COMPRESSION)"),(0,a.kt)("li",{parentName:"ul"},"si l\u2019ordre est important, les extensions sont appliqu\xe9es dans l\u2019ordre fourni par le serveur"),(0,a.kt)("li",{parentName:"ul"},"la connexion TLS est initi\xe9e, le handshake est effectu\xe9..."),(0,a.kt)("li",{parentName:"ul"},"la connexion de compression est ouverte"),(0,a.kt)("li",{parentName:"ul"},"les donn\xe9es transmises entre ",(0,a.kt)("strong",{parentName:"li"},"C")," et ",(0,a.kt)("strong",{parentName:"li"},"S")," sont maintenant \xe0 la fois chiffr\xe9es et compress\xe9es")),(0,a.kt)("h2",{id:"acquittement"},"Acquittement"),(0,a.kt)("p",null,"Les clients/serveurs dits \xab\xa0intelligents\xa0\xbb peuvent acquitter les paquets qui leur sont envoy\xe9s. Cette fonction est utilis\xe9e par Centreon Broker pour s\u2019assurer que chaque paquet est pris en compte et pour lancer la proc\xe9dure de r\xe9tention au cas o\xf9 l\u2019autre partie ne r\xe9pondrait pas."),(0,a.kt)("p",null,"Pour cela, l\u2019autre partie doit envoyer p\xe9riodiquement un paquet BBDO \xab\xa0ack\xa0\xbb sur le m\xeame canal TCP. Ce paquet comporte le num\xe9ro du paquet acquitt\xe9 par le client."),(0,a.kt)("p",null,"Les modes \xab\xa0Clever\xa0\xbb/\xab\xa0Dumb\xa0\xbb sont configur\xe9s sur chaque sortie TCP, pour chaque Broker."),(0,a.kt)("h2",{id:"changement-de-version-de-bbdo"},"Changement de version de BBDO"),(0,a.kt)("p",null,"La version de BBDO doit \xeatre la m\xeame pour tous les serveurs de votre architecture (serveur central, serveurs distants, collecteurs)."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Si vous utilisez BBDO v2 avec cette version de Centreon, vous ne pourrez pas utiliser la page ",(0,a.kt)("strong",{parentName:"p"},"Statut des ressources"),".")),(0,a.kt)("p",null,"Si vous voulez changer de version de BBDO (passer de la v3 \xe0 la v2 ou de la v2 \xe0 la v3), proc\xe9dez comme suit\xa0:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Sur le serveur central, acc\xe9dez \xe0 ",(0,a.kt)("strong",{parentName:"p"},"Configuration > Collecteurs > Configuration de Centreon Broker"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"S\xe9lectionnez le serveur souhait\xe9, et dans l\u2019onglet ",(0,a.kt)("strong",{parentName:"p"},"G\xe9n\xe9ral"),", dans la section ",(0,a.kt)("strong",{parentName:"p"},"Param\xe8tres avanc\xe9s"),", s\xe9lectionnez la version de BBDO souhait\xe9e dans la liste ",(0,a.kt)("strong",{parentName:"p"},"BBDO version"),". Cliquez ensuite sur ",(0,a.kt)("strong",{parentName:"p"},"Sauvegarder"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Faites de m\xeame avec tous les \xe9l\xe9ments figurant sur la page ",(0,a.kt)("strong",{parentName:"p"},"Configuration > Collecteurs > Configuration de Centreon Broker"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Red\xe9marrez ",(0,a.kt)("strong",{parentName:"p"},"gorgoned")," sur chaque serveur\xa0:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart gorgoned\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2776/fr/docs/monitoring/monitoring-servers/deploying-a-configuration"},"D\xe9ployez la configuration")," pour tous les serveurs.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Arr\xeatez les services suivants\xa0:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Sur le serveur central et sur les serveurs distants\xa0:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl stop cbd centengine\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Sur les collecteurs\xa0:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl stop centengine\n"))))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"D\xe9marrez les services suivants\xa0:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Sur le serveur central et sur les serveurs distants\xa0:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl start cbd centengine\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Sur les collecteurs\xa0:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl start centengine\n")))))),(0,a.kt)("p",null,"Vous pouvez v\xe9rifier dans les journaux quelle version de BBDO est active pour un serveur\xa0:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"broker central\xa0:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"tail /var/log/centreon-broker/central-{broker,rrd,module}-master.log\n\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"broker distant\xa0:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"tail /var/log/centreon-broker/<remote_name>-{broker,rrd,module}-master.log\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"module collecteur\xa0:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"tail /var/log/centreon-broker/<poller_name>-module.log\n")))),(0,a.kt)("p",null,"La ligne suivante indique quelle version est utilis\xe9e pour chaque serveur\xa0:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"[2022-05-17T14:53:44.828+00:00] [bbdo] [info] BBDO: peer is using protocol version 2.0.0, we're using version 2.0.0\n")))}N.isMDXComponent=!0}}]);