"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[77857],{65913:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>g,contentTitle:()=>m,default:()=>N,frontMatter:()=>p,metadata:()=>d,toc:()=>k});n(67294);var a=n(3905),r=n(51715),i=n(7626);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const p={id:"sc-opsgenie",title:"Opsgenie integration"},m=void 0,d={unversionedId:"integrations/event-management/sc-opsgenie",id:"version-23.10/integrations/event-management/sc-opsgenie",title:"Opsgenie integration",description:"Opsgenie + Centreon Integration Benefits",source:"@site/versioned_docs/version-23.10/integrations/event-management/sc-opsgenie.md",sourceDirName:"integrations/event-management",slug:"/integrations/event-management/sc-opsgenie",permalink:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-opsgenie",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/versioned_docs/version-23.10/integrations/event-management/sc-opsgenie.md",tags:[],version:"23.10",lastUpdatedAt:1699375250,formattedLastUpdatedAt:"Nov 7, 2023",frontMatter:{id:"sc-opsgenie",title:"Opsgenie integration"},sidebar:"version-23.10/docs",previous:{title:"HP OMI",permalink:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-hp-omi"},next:{title:"PagerDuty Events",permalink:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-pagerduty-events"}},g={},k=[{value:"Opsgenie + Centreon Integration Benefits",id:"opsgenie--centreon-integration-benefits",level:2},{value:"How it Works",id:"how-it-works",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Support",id:"support",level:2},{value:"Integration Walkthrough",id:"integration-walkthrough",level:2},{value:"In Opsgenie",id:"in-opsgenie",level:3},{value:"Opsgenie integration: alerts",id:"opsgenie-integration-alerts",level:4},{value:"Opsgenie integration: incidents",id:"opsgenie-integration-incidents",level:4},{value:"In Centreon",id:"in-centreon",level:3},{value:"Installation",id:"installation",level:4},{value:"Broker configuration",id:"broker-configuration",level:4},{value:"Advanced configuration",id:"advanced-configuration",level:4},{value:"How to Uninstall",id:"how-to-uninstall",level:2},{value:"Macros",id:"macros",level:2},{value:"Host event macros",id:"host-event-macros",level:4},{value:"Service event macros",id:"service-event-macros",level:4},{value:"BA event macros",id:"ba-event-macros",level:4}],u={toc:k},c="wrapper";function N(e){var{components:t}=e,n=s(e,["components"]);return(0,a.kt)(c,o(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){l(e,t,n[t])}))}return e}({},u,n),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"opsgenie--centreon-integration-benefits"},"Opsgenie + Centreon Integration Benefits"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Manage your notifications when an alert is detected by Centreon."),(0,a.kt)("li",{parentName:"ul"},"Deduplicate your alerts from Centreon"),(0,a.kt)("li",{parentName:"ul"},"Distinguish alerts from incidents using Centreon BAM and Opsgenie"),(0,a.kt)("li",{parentName:"ul"},"Create reporting based on your notifications from Centreon")),(0,a.kt)("h2",{id:"how-it-works"},"How it Works"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Every time a service, a host or a BA state is checked, the event passes through Centreon Broker, which loads the Stream Connector to send state changes."),(0,a.kt)("li",{parentName:"ul"},"State changes can occur in case of an anomaly detection."),(0,a.kt)("li",{parentName:"ul"},"An alias is generated for each alert to make use of Opsgenie deduplication:")),(0,a.kt)("h2",{id:"requirements"},"Requirements"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Opsgenie integration requires two different API key. The first one is an integration API key coming from the ",(0,a.kt)("strong",{parentName:"li"},"Rest API HTTPS over JSON")," integration. This integration must have the ",(0,a.kt)("strong",{parentName:"li"},"Create and Update Access"),". The second access is an API key coming from the ",(0,a.kt)("strong",{parentName:"li"},"APP Settings"),". This key must have the ",(0,a.kt)("strong",{parentName:"li"},"Create and Update")," access right. "),(0,a.kt)("li",{parentName:"ul"},"It is also necessary to use a Centreon account with either ",(0,a.kt)("strong",{parentName:"li"},"admin privileges")," or ",(0,a.kt)("strong",{parentName:"li"},"Export configuration")," and ",(0,a.kt)("strong",{parentName:"li"},"Broker configuration")," menu access in the WUI, as well as a ",(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"strong"},"root")," access in command-line interface"),".")),(0,a.kt)("h2",{id:"support"},"Support"),(0,a.kt)("p",null,"If you need help with this integration, depending on how you are using Centreon, you can:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Commercial Edition customers"),": please contact the ",(0,a.kt)("a",{parentName:"li",href:"mailto:support@centreon.com"},"Centreon Support team"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Open Source Edition users")," or ",(0,a.kt)("strong",{parentName:"li"},"Centreon IT-100 users")," (free versions): please reach our ",(0,a.kt)("a",{parentName:"li",href:"https://centreon.github.io"},"Community Slack")," where our users and staff will try to help you.")),(0,a.kt)("h2",{id:"integration-walkthrough"},"Integration Walkthrough"),(0,a.kt)("h3",{id:"in-opsgenie"},"In Opsgenie"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Warning, this documentation was written in February 2021, it is possible that certain elements described below became obsoletes due to changes on Opsgenie.")),(0,a.kt)("h4",{id:"opsgenie-integration-alerts"},"Opsgenie integration: alerts"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"From the ",(0,a.kt)("strong",{parentName:"li"},"Settings")," menu, select ",(0,a.kt)("strong",{parentName:"li"},"Integration list"),"."),(0,a.kt)("li",{parentName:"ol"},"In the integration list, add an ",(0,a.kt)("strong",{parentName:"li"},"API")," integration (Rest API HTTPS over JSON)."),(0,a.kt)("li",{parentName:"ol"},"Head over the ",(0,a.kt)("strong",{parentName:"li"},"Configured integrations")," menu and edit your ",(0,a.kt)("strong",{parentName:"li"},"API")," integration to enable it if it is not. You also must to give it a ",(0,a.kt)("strong",{parentName:"li"},"Create and Update Access"),". Save your configuration and the ",(0,a.kt)("strong",{parentName:"li"},"API Key")," that is mandatory to send alerts from Centreon to Opsgenie. This ",(0,a.kt)("strong",{parentName:"li"},"API key")," is referred as ",(0,a.kt)("strong",{parentName:"li"},"integration_api_token")," in the Centreon configuration.")),(0,a.kt)("h4",{id:"opsgenie-integration-incidents"},"Opsgenie integration: incidents"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Before starting, this integration will only work if you are using the Centreon BAM module."),(0,a.kt)("li",{parentName:"ol"},"From the ",(0,a.kt)("strong",{parentName:"li"},"Settings")," menu, select ",(0,a.kt)("strong",{parentName:"li"},"API key management")," in the subcategory ",(0,a.kt)("strong",{parentName:"li"},"APP SETTINGS"),"."),(0,a.kt)("li",{parentName:"ol"},"In the ",(0,a.kt)("strong",{parentName:"li"},"API key management")," menu, add a new API key with ",(0,a.kt)("strong",{parentName:"li"},"Create and Update")," access"),(0,a.kt)("li",{parentName:"ol"},"Save your configuration and your ",(0,a.kt)("strong",{parentName:"li"},"Api key")," that is mandatory to send incidents from Centreon to Opsgenie. This ",(0,a.kt)("strong",{parentName:"li"},"API key")," is referred as ",(0,a.kt)("strong",{parentName:"li"},"app_api_token")," in the Centreon configuration.")),(0,a.kt)("h3",{id:"in-centreon"},"In Centreon"),(0,a.kt)("h4",{id:"installation"},"Installation"),(0,a.kt)("p",null,"Login as ",(0,a.kt)("inlineCode",{parentName:"p"},"root")," on the Centreon central server using your favorite SSH client."),(0,a.kt)("p",null,"Run the command according on your system:"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(i.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install centreon-stream-connector-opsgenie\n"))),(0,a.kt)(i.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install centreon-stream-connector-opsgenie\n"))),(0,a.kt)(i.Z,{value:"Debian 11",label:"Debian_11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt install centreon-stream-connector-opsgenie\n")))),(0,a.kt)("p",null,"The Opsgenie Stream Connnector is now installed on your Centreon central server!"),(0,a.kt)("h4",{id:"broker-configuration"},"Broker configuration"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Login to the Centreon WUI using an administrator account."),(0,a.kt)("li",{parentName:"ol"},"Navigate to the ",(0,a.kt)("strong",{parentName:"li"},"Configuration")," > ",(0,a.kt)("strong",{parentName:"li"},"Pollers")," menu and select ",(0,a.kt)("strong",{parentName:"li"},"Broker configuration"),"."),(0,a.kt)("li",{parentName:"ol"},"Click on the ",(0,a.kt)("strong",{parentName:"li"},"central-broker-master")," broker configuration object and navigate to the ",(0,a.kt)("strong",{parentName:"li"},"Output")," tab."),(0,a.kt)("li",{parentName:"ol"},"Add a new ",(0,a.kt)("strong",{parentName:"li"},"Generic - Stream connector")," output."),(0,a.kt)("li",{parentName:"ol"},"Name it as you want (eg. ",(0,a.kt)("strong",{parentName:"li"},"Opsgenie"),") and set the right path for the LUA script: ",(0,a.kt)("inlineCode",{parentName:"li"},"/usr/share/centreon-broker/lua/opsgenie.lua"),"."),(0,a.kt)("li",{parentName:"ol"},"Add at least one string parameter. That parameter is a key that must be configured. The parameter name ",(0,a.kt)("em",{parentName:"li"},"must be")," ",(0,a.kt)("inlineCode",{parentName:"li"},"app_api_token")," (for the alerts) or ",(0,a.kt)("inlineCode",{parentName:"li"},"integration_api_token")," (for the incidents, requires the Centreon BAM module). If you want to use both aspects then you need to add both parameters in your configuration")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Name"),(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Value"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"app_api_token")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"<paste your key here>"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"integration_api_token")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"<paste your key here>"))))),(0,a.kt)("ol",{start:7},(0,a.kt)("li",{parentName:"ol"},"Save your configuration, then navigate to the ",(0,a.kt)("strong",{parentName:"li"},"Configuration")," > ",(0,a.kt)("strong",{parentName:"li"},"Pollers")," menu and select ",(0,a.kt)("strong",{parentName:"li"},"Pollers"),"."),(0,a.kt)("li",{parentName:"ol"},"Select the ",(0,a.kt)("strong",{parentName:"li"},"Central")," poller and click on ",(0,a.kt)("strong",{parentName:"li"},"Export configuration"),"."),(0,a.kt)("li",{parentName:"ol"},"Keep ",(0,a.kt)("strong",{parentName:"li"},"Generate Configuration Files")," and ",(0,a.kt)("strong",{parentName:"li"},"Run monitoring engine debug (-v)")," checked and select ",(0,a.kt)("strong",{parentName:"li"},"Move Export Files")," and then click on the ",(0,a.kt)("strong",{parentName:"li"},"Export")," button."),(0,a.kt)("li",{parentName:"ol"},"Restart the ",(0,a.kt)("inlineCode",{parentName:"li"},"cbd")," service:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl restart cbd\n")),(0,a.kt)("p",null,"Now your central server has loaded the Opsgenie Stream Connector and has started to send data!"),(0,a.kt)("p",null,"To make sure that everything goes fine, you should have a look at ",(0,a.kt)("inlineCode",{parentName:"p"},"central-broker-master.log")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"connector-opsgenie.log"),", both located in ",(0,a.kt)("inlineCode",{parentName:"p"},"/var/log/centreon-broker"),"."),(0,a.kt)("h4",{id:"advanced-configuration"},"Advanced configuration"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Parameters table")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Name"),(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Default value"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"api_url")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"https://api.opsgenie.com")),(0,a.kt)("td",{parentName:"tr",align:null},"Opsgenie api address. Use ",(0,a.kt)("a",{parentName:"td",href:"https://api.eu.opsgenie.com"},"https://api.eu.opsgenie.com")," if your instance is in Europe")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"proxy_address")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"If needed, the address of the proxy server (requires proxy_port option)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"proxy_port")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"The port of the proxy server")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"proxy_username")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"If needed, the proxy user (requires proxy_password option)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"proxy_password")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"the proxy user password")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"logfile")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"/var/log/centreon-broker/connector-opsgenie.log")),(0,a.kt)("td",{parentName:"tr",align:null},"logfile for the stream connector")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"host_status")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"0,1,2")),(0,a.kt)("td",{parentName:"tr",align:null},"send event for up, down and unreachable hosts")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"service_status")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"0,1,2,3")),(0,a.kt)("td",{parentName:"tr",align:null},"send event for ok, warning, critical, unknown services")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"ba_status")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"0,1,2")),(0,a.kt)("td",{parentName:"tr",align:null},"send event for ok, warning, critical business activities")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"hard_only")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"1")),(0,a.kt)("td",{parentName:"tr",align:null},"Only send events in hard state")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"acknowledged")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"0")),(0,a.kt)("td",{parentName:"tr",align:null},"Only send events that are not acknowledged")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"element_type")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"host_status,service_status,ba_status")),(0,a.kt)("td",{parentName:"tr",align:null},"Send host, service, BA centreon status event")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"category_type")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"neb,bam")),(0,a.kt)("td",{parentName:"tr",align:null},"Filter out non neb or bam events")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"in_downtime")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"0")),(0,a.kt)("td",{parentName:"tr",align:null},"Only send events that are not in downtime")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"max_buffer_size")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"1")),(0,a.kt)("td",{parentName:"tr",align:null},"Send events one at a time")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"max_buffer_age")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"5")),(0,a.kt)("td",{parentName:"tr",align:null},"Store events for 5 second before sending them unless max_buffer_size is reached before")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"max_stored_events")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"10")),(0,a.kt)("td",{parentName:"tr",align:null},"Keep event in cache to avoid sending duplicated events, change with caution")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"skip_anon_events")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"1")),(0,a.kt)("td",{parentName:"tr",align:null},"Do not send events from hosts or services that are not found in the broker cache")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"skip_nil_id")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"1")),(0,a.kt)("td",{parentName:"tr",align:null},"Do not send events from objects that do not have an ID (meta services most of the time)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"accepted_hostgroups")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"List of hostgroups in which the host must be (coma separeted eg: grp1,grp2,grp3)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"date_format")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"%Y-%m-%d %H:%M:%S")),(0,a.kt)("td",{parentName:"tr",align:null},"The default date format for converted timestamps (",(0,a.kt)("a",{parentName:"td",href:"https://www.lua.org/pil/22.1"},"https://www.lua.org/pil/22.1"),")")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"host_alert_message")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"{last_update_date} {hostname} is {state}")),(0,a.kt)("td",{parentName:"tr",align:null},"The default message for host alerts. See ",(0,a.kt)("a",{parentName:"td",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-opsgenie#host-event-macros"},"host event macros")," for more details about macros")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"host_alert_description")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"The default description of a host alert. See ",(0,a.kt)("a",{parentName:"td",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-opsgenie#host-event-macros"},"host event macros")," for more details about macros")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"host_alert_alias")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"{hostname}_{state}")),(0,a.kt)("td",{parentName:"tr",align:null},"The default alias for a host alert, useful for alert deduplication. See ",(0,a.kt)("a",{parentName:"td",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-opsgenie#host-event-macros"},"host event macros")," for more details about macros")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"service_alert_message")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"{last_update_date} {hostname} // {serviceDescription} is {state}")),(0,a.kt)("td",{parentName:"tr",align:null},"The default message for service alerts. See ",(0,a.kt)("a",{parentName:"td",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-opsgenie#service-event-macros"},"service event macros")," for more details about macros")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"service_alert_description")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"The default description of a service alert. See ",(0,a.kt)("a",{parentName:"td",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-opsgenie#service-event-macros"},"service event macros")," for more details about macros")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"service_alert_alias")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"{hostname}_{serviceDescription}_{state}")),(0,a.kt)("td",{parentName:"tr",align:null},"The default alias for a service alert, useful for alert deduplication. See ",(0,a.kt)("a",{parentName:"td",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-opsgenie#service-event-macros"},"service event macros")," for more details about macros")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"ba_incident_message")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"{baName} is {state}, health level reached {level_nominal}")),(0,a.kt)("td",{parentName:"tr",align:null},"The default message for a ba incident. See ",(0,a.kt)("a",{parentName:"td",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-opsgenie#ba-event-macros"},"BA event macros")," for more details about macros")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"ba_incident_description")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"The default description of a ba incident. See ",(0,a.kt)("a",{parentName:"td",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/integrations/event-management/sc-opsgenie#ba-event-macros"},"BA event macros")," for more details about macros")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"enable_incident_tags")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"1")),(0,a.kt)("td",{parentName:"tr",align:null},"Add tags to incidents")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"get_bv")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"1")),(0,a.kt)("td",{parentName:"tr",align:null},"Add BV names as tags if ",(0,a.kt)("inlineCode",{parentName:"td"},"enable_incident_tags")," is set to ",(0,a.kt)("inlineCode",{parentName:"td"},"1"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"ba_incident_tags")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"centreon,applications")),(0,a.kt)("td",{parentName:"tr",align:null},"List of tags for an incident. must be coma separeted. It will automatically add all the BV related to the BA as tags")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"enable_severity")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"0")),(0,a.kt)("td",{parentName:"tr",align:null},"If set to 1, tries to match a Centreon severity value to an Opsgenie priority.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"priority_must_be_set")),(0,a.kt)("td",{parentName:"tr",align:null},"Number"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"0")),(0,a.kt)("td",{parentName:"tr",align:null},"Will drop the alert if set to 1 and it can't match the severity with a priority according to the relation set in the ",(0,a.kt)("inlineCode",{parentName:"td"},"priority_matching")," parameter")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"priority_matching")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"P1=1,P2=2,P3=3,P4=4,P5=5")),(0,a.kt)("td",{parentName:"tr",align:null},"Links priorities to severities with the following syntax: priority_name=severity_value,priority_name=severity_value.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"opsgenie_priorities")),(0,a.kt)("td",{parentName:"tr",align:null},"String"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"P1,P2,P3,P4,P5")),(0,a.kt)("td",{parentName:"tr",align:null},"Coma separeted list of Opsgenie priorities")))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Remarks")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"A value of 2 for ",(0,a.kt)("inlineCode",{parentName:"li"},"log_level")," is fine for initial troubleshooting, but can generate a huge amount of logs if you monitor a lot of hosts. In order to get less log messages, you should keep it a 1.")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"how-to-uninstall"},"How to Uninstall"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Login to the Centreon WUI using an administrator account."),(0,a.kt)("li",{parentName:"ol"},"Navigate to the ",(0,a.kt)("strong",{parentName:"li"},"Configuration")," > ",(0,a.kt)("strong",{parentName:"li"},"Pollers")," menu and select ",(0,a.kt)("strong",{parentName:"li"},"Broker configuration"),"."),(0,a.kt)("li",{parentName:"ol"},"Click on the ",(0,a.kt)("strong",{parentName:"li"},"central-broker-master")," broker configuration object and navigate to the ",(0,a.kt)("strong",{parentName:"li"},"Output")," tab."),(0,a.kt)("li",{parentName:"ol"},"Delete the ",(0,a.kt)("strong",{parentName:"li"},"Generic - Stream connector")," output by clicking on the red circled cross at the end of the line."),(0,a.kt)("li",{parentName:"ol"},"Save your configuration, then navigate to the ",(0,a.kt)("strong",{parentName:"li"},"Configuration")," > ",(0,a.kt)("strong",{parentName:"li"},"Pollers")," menu and select ",(0,a.kt)("strong",{parentName:"li"},"Pollers"),"."),(0,a.kt)("li",{parentName:"ol"},"Select the ",(0,a.kt)("strong",{parentName:"li"},"Central")," poller and click on ",(0,a.kt)("strong",{parentName:"li"},"Export configuration"),"."),(0,a.kt)("li",{parentName:"ol"},"Keep ",(0,a.kt)("strong",{parentName:"li"},"Generate Configuration Files")," and ",(0,a.kt)("strong",{parentName:"li"},"Run monitoring engine debug (-v)")," checked and select ",(0,a.kt)("strong",{parentName:"li"},"Move Export Files")," and then click on the ",(0,a.kt)("strong",{parentName:"li"},"Export")," button."),(0,a.kt)("li",{parentName:"ol"},"Restart the ",(0,a.kt)("inlineCode",{parentName:"li"},"cbd")," service:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl restart cbd\n")),(0,a.kt)("p",null,"The Stream Connector is not loaded anymore!"),(0,a.kt)("ol",{start:9},(0,a.kt)("li",{parentName:"ol"},"Optionally, you can even delete the script file:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"rm -f /usr/share/centreon-broker/lua/opsgenie.lua\n")),(0,a.kt)("h2",{id:"macros"},"Macros"),(0,a.kt)("p",null,"Macros are a tool to create dynamic messages depending on the event you want to send. They must be enclosed by {} (eg: {hostname}). If a macro is a time type macro then you will be able to use ",(0,a.kt)("strong",{parentName:"p"},"_","date suffix")," to convert it to a human readable format. You can Change this format using the string parameter ",(0,a.kt)("inlineCode",{parentName:"p"},"date_format")," (eg: {last_update} is a timestamp macro. You can use {last_update_date} to have it converted)"),(0,a.kt)("h4",{id:"host-event-macros"},"Host event macros"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Macro name"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"hostname")))),(0,a.kt)("p",null,"All the Properties in the ",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/developer/developer-broker-mapping#host-status"},"Host status")," table are also usable"),(0,a.kt)("h4",{id:"service-event-macros"},"Service event macros"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Macro name"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"hostname")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"serviceDescription")))),(0,a.kt)("p",null,"All the Properties in the ",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/developer/developer-broker-mapping#service-status"},"Service status")," table are also usable"),(0,a.kt)("h4",{id:"ba-event-macros"},"BA event macros"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Macro name"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"baName")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"baDescription")))),(0,a.kt)("p",null,"All the Properties in the ",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2776/docs/developer/developer-broker-mapping#ba-status-event"},"Ba status event")," table are also usable"))}N.isMDXComponent=!0}}]);