"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[36592],{90208:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>m,default:()=>k,frontMatter:()=>p,metadata:()=>c,toc:()=>d});n(67294);var a=n(3905),o=n(51715),i=n(7626);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const p={id:"postfix",title:"Configuring your Centreon to send emails"},m=void 0,c={unversionedId:"administration/postfix",id:"version-23.10/administration/postfix",title:"Configuring your Centreon to send emails",description:"For your Centreon to be able to send notification emails, you need to configure a local SMTP server. If your operating system is RHEL or Oracle Linux, Postfix is already installed.",source:"@site/versioned_docs/version-23.10/administration/postfix.md",sourceDirName:"administration",slug:"/administration/postfix",permalink:"/centreon-documentation/pr-preview/staging/pr-2796/docs/administration/postfix",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/versioned_docs/version-23.10/administration/postfix.md",tags:[],version:"23.10",lastUpdatedAt:1699281350,formattedLastUpdatedAt:"Nov 6, 2023",frontMatter:{id:"postfix",title:"Configuring your Centreon to send emails"},sidebar:"version-23.10/docs",previous:{title:"Platform statistics",permalink:"/centreon-documentation/pr-preview/staging/pr-2796/docs/administration/platform-statistics"},next:{title:"Update a Centreon 23.04 platform",permalink:"/centreon-documentation/pr-preview/staging/pr-2796/docs/update/update-centreon-platform"}},u={},d=[{value:"Step 1: Configuring Postfix",id:"step-1-configuring-postfix",level:2},{value:"Step 2: Configuring the credentials of the account that will send emails",id:"step-2-configuring-the-credentials-of-the-account-that-will-send-emails",level:2},{value:"Testing and troubleshooting email configuration",id:"testing-and-troubleshooting-email-configuration",level:2},{value:"Gmail configuration",id:"gmail-configuration",level:2}],f={toc:d},g="wrapper";function k(e){var{components:t}=e,p=l(e,["components"]);return(0,a.kt)(g,s(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){r(e,t,n[t])}))}return e}({},f,p),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"For your Centreon to be able to send notification emails, you need to configure a local SMTP server. If your operating system is RHEL or Oracle Linux, Postfix is already installed. "),(0,a.kt)("p",null,"This page gives you an example of a possible configuration. Refer to the ",(0,a.kt)("a",{parentName:"p",href:"http://www.postfix.org/BASIC_CONFIGURATION_README"},"official Postfix documentation")," for more information."),(0,a.kt)("p",null,"Notification commands are executed by the poller that monitors the resource, so you need to configure the mail relay on all pollers."),(0,a.kt)("p",null,"We recommend that you use a dedicated email account to send notifications."),(0,a.kt)("h2",{id:"step-1-configuring-postfix"},"Step 1: Configuring Postfix"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"In your server's terminal, enter the following command:")),(0,a.kt)(o.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(i.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install mailx cyrus-sasl-plain\n"))),(0,a.kt)(i.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install s-nail cyrus-sasl-plain\n"))),(0,a.kt)(i.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt install mailx cyrus-sasl-plain\n")))),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Restart Postfix:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"systemctl restart postfix\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Configure Postfix to run at startup:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"systemctl enable postfix\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Edit the following file:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"vi /etc/postfix/main.cf\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Add the following information:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"myhostname = hostname\nrelayhost = [smtp.isp.com]:port\nsmtp_use_tls = yes\nsmtp_sasl_auth_enable = yes\nsmtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd\nsmtp_tls_CAfile = /etc/ssl/certs/ca-bundle.crt\nsmtp_sasl_security_options = noanonymous\nsmtp_sasl_tls_security_options = noanonymous\n")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"myhostname")," is the hostname of the Centreon server."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"relayhost")," is the email server for the account that will send notifications.")),(0,a.kt)("p",{parentName:"li"},"In the following example, Centreon will use a Gmail account to send notifications:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"myhostname = centreon-central\nrelayhost = [smtp.gmail.com]:587\nsmtp_use_tls = yes\nsmtp_sasl_auth_enable = yes\nsmtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd\nsmtp_tls_CAfile = /etc/ssl/certs/ca-bundle.crt\nsmtp_sasl_security_options = noanonymous\nsmtp_sasl_tls_security_options = noanonymous\n")))),(0,a.kt)("h2",{id:"step-2-configuring-the-credentials-of-the-account-that-will-send-emails"},"Step 2: Configuring the credentials of the account that will send emails"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Create a ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/postfix/sasl_passwd")," file:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"touch /etc/postfix/sasl_passwd\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Add the following line (replace ",(0,a.kt)("inlineCode",{parentName:"p"},"username:password")," with the credentials of the account that will send the notification emails):"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"[smtp.isp.com]:port username:password\n")),(0,a.kt)("p",{parentName:"li"},"Example:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"[smtp.gmail.com]:587 username@gmail.com:XXXXXXXX\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Save the file.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"In the terminal, enter the following command: "),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"postmap /etc/postfix/sasl_passwd\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"For security reasons, change the permissions on the file:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"chown root:postfix /etc/postfix/sasl_passwd*\nchmod 640 /etc/postfix/sasl_passwd*\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Reload Postfix so that changes are taken into account:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"systemctl reload postfix\n")))),(0,a.kt)("h2",{id:"testing-and-troubleshooting-email-configuration"},"Testing and troubleshooting email configuration"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"To send a test email, enter the following command:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},'echo "Test" | mail -s "Test" user@isp.com\n')),(0,a.kt)("p",{parentName:"li"},"  Replace ",(0,a.kt)("inlineCode",{parentName:"p"},"user@isp.com")," with a real email address. The recipient should receive the test email.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"If the user has not received the message, check the following log file:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"tail -f /var/log/maillog\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"To check that your Postfix service is running, enter:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"systemctl status postfix\n")),(0,a.kt)("p",{parentName:"li"},"  The results should look like this:"),(0,a.kt)("p",{parentName:"li"},"  ",(0,a.kt)("img",{alt:"image",src:n(73744).Z,width:"644",height:"323"})))),(0,a.kt)("h2",{id:"gmail-configuration"},"Gmail configuration"),(0,a.kt)("p",null,"If you want to send emails through a Gmail account, you will need to turn on the ",(0,a.kt)("strong",{parentName:"p"},"Allow less secure apps")," option on this account. See ",(0,a.kt)("a",{parentName:"p",href:"https://support.google.com/accounts/answer/6010255"},"Less secure apps & your Google Account"),"."))}k.isMDXComponent=!0},73744:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/postfix-status-ae9e2ca7127885e00ec2733602c5b75d.png"}}]);