"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[10978],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,h=u["".concat(s,".").concat(m)]||u[m]||d[m]||o;return n?a.createElement(h,l(l({ref:t},p),{},{components:n})):a.createElement(h,l({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[u]="string"==typeof e?e:r,l[1]=i;for(var c=2;c<o;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},33765:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>u});n(67294);var a=n(3905);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const i={id:"centreon-nsclient-tutorial",title:"Centreon NSClient++"},s=void 0,c={unversionedId:"integrations/plugin-packs/getting-started/how-to-guides/centreon-nsclient-tutorial",id:"integrations/plugin-packs/getting-started/how-to-guides/centreon-nsclient-tutorial",title:"Centreon NSClient++",description:"Introduction",source:"@site/pp/integrations/plugin-packs/getting-started/how-to-guides/centreon-nsclient-tutorial.md",sourceDirName:"integrations/plugin-packs/getting-started/how-to-guides",slug:"/integrations/plugin-packs/getting-started/how-to-guides/centreon-nsclient-tutorial",permalink:"/centreon-documentation/pr-preview/staging/pr-2796/pp/integrations/plugin-packs/getting-started/how-to-guides/centreon-nsclient-tutorial",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/pp/integrations/plugin-packs/getting-started/how-to-guides/centreon-nsclient-tutorial.md",tags:[],version:"current",frontMatter:{id:"centreon-nsclient-tutorial",title:"Centreon NSClient++"},sidebar:"pp",previous:{title:"Azure Monitoring Prerequisites",permalink:"/centreon-documentation/pr-preview/staging/pr-2796/pp/integrations/plugin-packs/getting-started/how-to-guides/azure-credential-configuration"},next:{title:"Collect OpenMetrics",permalink:"/centreon-documentation/pr-preview/staging/pr-2796/pp/integrations/plugin-packs/getting-started/how-to-guides/collect-openmetrics"}},p={},u=[{value:"Introduction",id:"introduction",level:2},{value:"Support policy and release cycle",id:"support-policy-and-release-cycle",level:2},{value:"Download",id:"download",level:2},{value:"Installation",id:"installation",level:2},{value:"Update",id:"update",level:2},{value:"Configuration",id:"configuration",level:2},{value:"NRPE",id:"nrpe",level:3},{value:"Webserver / RestAPI",id:"webserver--restapi",level:3},{value:"Prerequisites",id:"prerequisites",level:4},{value:"Enabling RestAPI and configuring credentials",id:"enabling-restapi-and-configuring-credentials",level:4},{value:"Troubleshooting",id:"troubleshooting",level:2}],d={toc:u},m="wrapper";function h(e){var{components:t}=e,i=l(e,["components"]);return(0,a.kt)(m,o(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){r(e,t,n[t])}))}return e}({},d,i),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"introduction"},"Introduction"),(0,a.kt)("p",null,"NSClient++ (also known as NSCP) aims to be a simple yet powerful and secure monitoring daemon. It can be used in many scenarios where you want to\nreceive/distribute check metrics."),(0,a.kt)("p",null,"The daemon has some basic features:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Allow a remote machine (monitoring server) to request commands to be run on this machine (the monitored machine) which return the status of the machine."),(0,a.kt)("li",{parentName:"ul"},"Submit the same results to a remote (monitoring server)"),(0,a.kt)("li",{parentName:"ul"},"Take action and perform tasks"),(0,a.kt)("li",{parentName:"ul"},"Submit metrics and real-time data to a central repository")),(0,a.kt)("p",null,"Centreon provides a fully custom and re-packaged version of the NSClient++ agent, named ",(0,a.kt)("strong",{parentName:"p"},"centreon-nsclient"),".\nAdditionally to the agent native features, it allows to monitor applicative indicators such as Hyper-V, Active Directory, WSUS, SCCM, Microsoft Exchange,\nVeeam and many others, thanks to the usage of a specific release of the Centreon Plugins for Windows."),(0,a.kt)("p",null,"These Plugins, parts of the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/centreon/centreon-plugins"},"centreon-plugins project")," are provided as a standalone and Windows compatible\npackage named ",(0,a.kt)("em",{parentName:"p"},"centreon_plugins.exe"),". This executable file is automatically deployed during the agent installation and ready to use afterwards."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"The list of the Monitoring Connectors that can be used with the ",(0,a.kt)("em",{parentName:"p"},"centreon-nsclient")," agent is avaiblable on the\nofficial ",(0,a.kt)("a",{parentName:"p",href:"https://www.centreon.com/catalogue-plugins-packs/"},"Centreon Monitoring Connectors catalog"))),(0,a.kt)("p",null,"The following tutorial will help you to understand how to use the ",(0,a.kt)("strong",{parentName:"p"},"centreon-nsclient")," agent on your Windows servers."),(0,a.kt)("h2",{id:"support-policy-and-release-cycle"},"Support policy and release cycle"),(0,a.kt)("p",null,"Centreon only supports the custom Centreon Plugins package provided through the ",(0,a.kt)("strong",{parentName:"p"},"centreon-nsclient")," agent. For any issue related to NSClient++ itself,\nplease refer to the ",(0,a.kt)("a",{parentName:"p",href:"https://docs.nsclient.org/"},"official documentation"),"."),(0,a.kt)("p",null,"Centreon will publish a new release of the custom Plugins (",(0,a.kt)("em",{parentName:"p"},"centreon_plugins.exe")," and ",(0,a.kt)("em",{parentName:"p"},"check_logfiles.exe"),") including new monitoring capabilities as\nwell as bugfixes every month.\nAn updated version of the ",(0,a.kt)("strong",{parentName:"p"},"centreon-nsclient")," installer (for new installations) including the last versions of the Plugins will also be available on\na montlhy basis."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"On existing installations, you will only have to update the Plugins, not the agent itself.\nTo do so, read the ",(0,a.kt)("a",{parentName:"p",href:"#Update"},"Update")," chapter of this tutorial.")),(0,a.kt)("h2",{id:"download"},"Download"),(0,a.kt)("p",null,"Both the installer and the packaged Centreon Plugins are available on the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/centreon/centreon-nsclient-build/releases"},"centreon-nsclient"),"\nGithub project page. Look for the latest release and download the relevant files according to the target server environment (x86 or x64):"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"For new installations: download the ",(0,a.kt)("inlineCode",{parentName:"li"},"Centreon-NSClient-0.5.x.xx-YYYYMMDD")," installer"),(0,a.kt)("li",{parentName:"ul"},"To update an existing agent: download the ",(0,a.kt)("inlineCode",{parentName:"li"},"centreon_plugins_YYYYMMDD_*\\*\\*_.exe")," & ",(0,a.kt)("inlineCode",{parentName:"li"},"check_logfiles_x.x.x_\\*\\*\\*.exe")," binaries")),(0,a.kt)("h2",{id:"installation"},"Installation"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"This chapter is related to a fresh installation of the ",(0,a.kt)("strong",{parentName:"p"},"centreon-nsclient")," agent.")),(0,a.kt)("p",null,"On the Windows server, launch the installation and follow the wizard:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The first step gives some information about the NSClient++ version you're about to install. Click on ",(0,a.kt)("em",{parentName:"li"},"Next")," to go on:")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(27466).Z,width:"627",height:"486"})),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Choose the installation folder and click on ",(0,a.kt)("em",{parentName:"li"},"Next"),":")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(26621).Z,width:"625",height:"491"})),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Wait until the installation process is completed:")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(38398).Z,width:"629",height:"489"})),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Once the installation performed, click on ",(0,a.kt)("em",{parentName:"li"},"Next")," once more:")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(68396).Z,width:"624",height:"488"})),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The installation wizard should confirm that NSClient++ is installed and ready to rumble. Click on ",(0,a.kt)("em",{parentName:"li"},"Finish"),":")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(68925).Z,width:"624",height:"485"})),(0,a.kt)("h2",{id:"update"},"Update"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"This chapter is related to the update of the custom packaged Plugins ",(0,a.kt)("em",{parentName:"p"},"centreon_plugins.exe")," and ",(0,a.kt)("em",{parentName:"p"},"check_logfiles")," on a server where\n",(0,a.kt)("strong",{parentName:"p"},"centreon-nsclient")," is already installed.")),(0,a.kt)("p",null,"When the new monthly version of ",(0,a.kt)("strong",{parentName:"p"},"centreon-nsclient")," is released, you don't have to fully reinstall the agent on your Windows server, only the\npackaged Plugins can be updated."),(0,a.kt)("p",null,"To do so, go to the directory where the ",(0,a.kt)("em",{parentName:"p"},"centreon_plugins.exe")," and ",(0,a.kt)("em",{parentName:"p"},"check_logfiles.exe")," binaries are stored (usually ",(0,a.kt)("inlineCode",{parentName:"p"},"C:\\Program Files\\Centreon NSClient++\\scripts\\centreon"),")\nand replace the two existing files with the new ones you downloaded from Github  (see the ",(0,a.kt)("a",{parentName:"p",href:"#installation"},"Installation")," chapter)."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(58101).Z,width:"1162",height:"224"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Be careful to rename the new files with the exact same names of the former ones (remove the ",(0,a.kt)("em",{parentName:"p"},"versioning")," part of the files names so the files will\nbe named ",(0,a.kt)("em",{parentName:"p"},"centreon_plugins.exe")," and ",(0,a.kt)("em",{parentName:"p"},"check_logfiles.exe"),").")),(0,a.kt)("h2",{id:"configuration"},"Configuration"),(0,a.kt)("p",null,"The general configuration, of the agent, its modules and the custom scripts to be used is stored in the ",(0,a.kt)("inlineCode",{parentName:"p"},"nsclient.ini"),"file, usually stored\nin the ",(0,a.kt)("inlineCode",{parentName:"p"},"C:\\Program Files\\Centreon NSClient++\\")," folder:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(847).Z,width:"1026",height:"512"})),(0,a.kt)("p",null,"The default configuration comes with most of the features and options already enabled and ready-to-use. Nevertheless, Centreon recommends to\nadjust and/or set some additional parameters (mostly for safety purposes)."),(0,a.kt)("h3",{id:"nrpe"},"NRPE"),(0,a.kt)("p",null,"In the ",(0,a.kt)("inlineCode",{parentName:"p"},"[/modules]")," section, check that the NRPE server is enabled:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csv"},"NRPEServer = 1\n")),(0,a.kt)("p",null,"In the ",(0,a.kt)("inlineCode",{parentName:"p"},"[/settings/NRPE/server]")," section:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Set the IP addresses of the Centreon Pollers allowed to monitor the server:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csv"},"allowed hosts = @IP_Poller1, @IP_Poller2\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Check that the TCP port to be used is 5666:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csv"},"port = 5666\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Centreon recommends to secure the connections using the SSL/TLS protocols.\nTo do so, check that the following option is enabled:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csv"},"use ssl = true\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Check that the packet payload size is set to 8192:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csv"},"payload length = 8192\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Finally, restart the NSClient++ service from a command line prompt:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"net stop nscp\nnet start nscp\n")),(0,a.kt)("p",null,"(This can also be done from the ",(0,a.kt)("em",{parentName:"p"},"Services")," management console)."),(0,a.kt)("h3",{id:"webserver--restapi"},"Webserver / RestAPI"),(0,a.kt)("p",null,"NSClient++ does natively provide a Web Server, allowing to monitor the target Windows Server using the HTTPS protocol. Centreon recommends to use this\nmethod rather than the 'old' NRPE & NSCLIENT protocols, including the following benefits:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"This protocol comes secured by default"),(0,a.kt)("li",{parentName:"ul"},"Custom certificates can be used"),(0,a.kt)("li",{parentName:"ul"},"No compatibility issues between NRPE v2/v3 versions")),(0,a.kt)("h4",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The HTTPS port used by the Webserver (by default TCP/8443) must be open and reachable from the Centreon Poller."),(0,a.kt)("li",{parentName:"ul"},"As for the NRPE protocol, the ",(0,a.kt)("em",{parentName:"li"},"port")," and ",(0,a.kt)("em",{parentName:"li"},"allowed hosts")," setting of the ",(0,a.kt)("inlineCode",{parentName:"li"},"nsclient.ini")," file (section ",(0,a.kt)("inlineCode",{parentName:"li"},"/settings/WEB/server"),") must be set (the\nrecommended port to be used is 8443 but you can use any custom ports >1024).\n")),(0,a.kt)("h4",{id:"enabling-restapi-and-configuring-credentials"},"Enabling RestAPI and configuring credentials"),(0,a.kt)("p",null,"To use the RestAPI feature of NSCLient++, you first have to enable the Webserver service:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"From a Windows command prompt launched ",(0,a.kt)("strong",{parentName:"li"},"as an administrator"),", run the following command:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"nscp web install\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Then, configure a password to be used to access the API data:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"nscp web -- password --set new-password\nPassword updated successfully, please restart nsclient++ for changes to affect.\n")),(0,a.kt)("p",null,"You can also display the password you previously set if needed by running:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"nscp web -- password --display\nCurrent password: centreon\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Finally, still in the Windows command prompt interface, restart the NSCP service:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"net stop nscp\nnet start nscp\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"To check that the Webserver is properly configured and running, open a web browser on the Windows server and access the Webserver interface:")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"https://127.0.0.1:8443/")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(73695).Z,width:"1510",height:"644"})),(0,a.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,a.kt)("p",null,"Any issue related to the configuration of the agent and its usage, please refer to the wholesome ",(0,a.kt)("a",{parentName:"p",href:"https://docs.nsclient.org/faq/"},"official FAQ")," of\nNSClient++ that will help you to solve the most common issues."),(0,a.kt)("p",null,"Any concern or question about the ",(0,a.kt)("strong",{parentName:"p"},"centreon-nsclient")," packaging and the usage of the Centreon Plugins, feel free to open an ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/centreon/centreon-nsclient-build/issues"},"issue on our Github\nproject"),"."))}h.isMDXComponent=!0},847:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/centreon-nsclient-tutorial-configuration-6b0d4a1a39eecadc4f483810efcb6121.png"},58101:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/centreon-nsclient-tutorial-update-255bf2c60f28d2823efe26f27b004635.png"},73695:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/centreon-nsclient-tutorial-webserver-471775677af57ed7a379366013c8f7a0.png"},27466:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/centreon-nsclient-tutorial-wizard1-a7ee22982b5bc03b00669b1beca3ddd3.png"},26621:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/centreon-nsclient-tutorial-wizard2-9b351b84d188e1e33632bbbee0b65bfb.png"},38398:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/centreon-nsclient-tutorial-wizard3-5ce2d295fe1494dc541c3127a3d7c415.png"},68396:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/centreon-nsclient-tutorial-wizard4-2430622a282a57e8126b9aab8cd6296e.png"},68925:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/centreon-nsclient-tutorial-wizard5-7706c9dab26185334881147970e5f03f.png"}}]);