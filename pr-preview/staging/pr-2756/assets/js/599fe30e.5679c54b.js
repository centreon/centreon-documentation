"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[48777],{29365:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>p,default:()=>g,frontMatter:()=>c,metadata:()=>u,toc:()=>d});n(67294);var a=n(3905),r=n(51715),l=n(7626);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const c={id:"secure-platform",title:"Secure your platform"},p=void 0,u={unversionedId:"administration/secure-platform",id:"version-23.10/administration/secure-platform",title:"Secure your platform",description:"This chapter suggests how to best secure your Centreon platform.",source:"@site/versioned_docs/version-23.10/administration/secure-platform.md",sourceDirName:"administration",slug:"/administration/secure-platform",permalink:"/centreon-documentation/pr-preview/staging/pr-2756/docs/administration/secure-platform",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/versioned_docs/version-23.10/administration/secure-platform.md",tags:[],version:"23.10",lastUpdatedAt:1699633150,formattedLastUpdatedAt:"Nov 10, 2023",frontMatter:{id:"secure-platform",title:"Secure your platform"},sidebar:"version-23.10/docs",previous:{title:"Offline installation",permalink:"/centreon-documentation/pr-preview/staging/pr-2756/docs/installation/offline"},next:{title:"Secure your MAP platform",permalink:"/centreon-documentation/pr-preview/staging/pr-2756/docs/graph-views/secure-your-map-platform"}},m={},d=[{value:"Strengthen user account security",id:"strengthen-user-account-security",level:2},{value:"Enable SELinux",id:"enable-selinux",level:2},{value:"SELinux Overview",id:"selinux-overview",level:3},{value:"Activate SELinux in permissive mode",id:"activate-selinux-in-permissive-mode",level:3},{value:"Install Centreon SELinux packages",id:"install-centreon-selinux-packages",level:3},{value:"Audit logs and enable SELinux",id:"audit-logs-and-enable-selinux",level:3},{value:"Securing configuration files",id:"securing-configuration-files",level:2},{value:"Securing root access to the DBMS",id:"securing-root-access-to-the-dbms",level:2},{value:"Enable firewalld",id:"enable-firewalld",level:2},{value:"Enable fail2ban",id:"enable-fail2ban",level:2},{value:"Secure the web server with HTTPS",id:"secure-the-web-server-with-https",level:2},{value:"Creating a self-signed certificate",id:"creating-a-self-signed-certificate",level:3},{value:"Activating HTTPS mode on your web server",id:"activating-https-mode-on-your-web-server",level:3},{value:"Custom URI",id:"custom-uri",level:2},{value:"Enabling http2",id:"enabling-http2",level:2},{value:"User authentication",id:"user-authentication",level:2},{value:"Create user profiles",id:"create-user-profiles",level:2},{value:"Secure communications between servers",id:"secure-communications-between-servers",level:2},{value:"Centreon Broker communication",id:"centreon-broker-communication",level:3},{value:"Centreon Broker and the firewall",id:"centreon-broker-and-the-firewall",level:4},{value:"Centreon Broker flow authentication",id:"centreon-broker-flow-authentication",level:4},{value:"Compress and encrypt Centreon Broker communication",id:"compress-and-encrypt-centreon-broker-communication",level:4},{value:"Centreon Gorgone communication",id:"centreon-gorgone-communication",level:3},{value:"Security Information and Event Management - SIEM",id:"security-information-and-event-management---siem",level:2},{value:"Backing up the platform",id:"backing-up-the-platform",level:2}],k={toc:d},h="wrapper";function g(e){var{components:t}=e,n=s(e,["components"]);return(0,a.kt)(h,i(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){o(e,t,n[t])}))}return e}({},k,n),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This chapter suggests how to best secure your Centreon platform."),(0,a.kt)("h2",{id:"strengthen-user-account-security"},"Strengthen user account security"),(0,a.kt)("p",null,"After installing Centreon, you must change the default passwords of the following users:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"root"),(0,a.kt)("li",{parentName:"ul"},"centreon"),(0,a.kt)("li",{parentName:"ul"},"centreon-engine"),(0,a.kt)("li",{parentName:"ul"},"centreon-broker"),(0,a.kt)("li",{parentName:"ul"},"centreon-gorgone")),(0,a.kt)("p",null,"To do this, use the following command with a privileged account (e.g., sudo) or with root (not recommended \u2014 you should\nhave a dedicated user):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"passwd <account_name>\n")),(0,a.kt)("p",null,"In addition, it is important to verify that the Apache account does not have connection rights to the terminal.\nExecute the following command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cat /etc/passwd | grep apache\n")),(0,a.kt)("p",null,"You must have ",(0,a.kt)("strong",{parentName:"p"},"/sbin/nologin")," like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"As a reminder, the list of users and groups can be found ",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/installation/prerequisites#users-and-groups"},"here"))),(0,a.kt)("h2",{id:"enable-selinux"},"Enable SELinux"),(0,a.kt)("p",null,"Centreon developed SELinux rules in order to strengthen the control of\ncomponents by the operating system."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"These rules are currently in ",(0,a.kt)("strong",{parentName:"p"},"beta mode")," and can be activated.\nYou can activate them by following this procedure. If you detect a problem,\nyou can disable SELinux globally and send us your feedback in\norder to improve our rules on ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/centreon/centreon"},"Github"),".")),(0,a.kt)("h3",{id:"selinux-overview"},"SELinux Overview"),(0,a.kt)("p",null,"Security Enhanced Linux (SELinux) provides an additional layer of system security. SELinux fundamentally answers the\nquestion: ",(0,a.kt)("inlineCode",{parentName:"p"},"May <subject> do <action> to <object>?"),", for example: May a web server access files in users' home\ndirectories?"),(0,a.kt)("p",null,"The standard access policy based on the user, group, and other permissions, known as Discretionary Access Control\n(DAC), does not enable system administrators to create comprehensive and fine-grained security policies, such as\nrestricting specific applications to only viewing log files, while allowing other applications to append new data to\nthe log files."),(0,a.kt)("p",null,"SELinux implements Mandatory Access Control (MAC). Every process and system resource has a special security label\ncalled an SELinux context. An SELinux context, sometimes referred to as an SELinux label, is an identifier that\nabstracts away the system-level details and focuses on the security properties of the entity. Not only does this provide\na consistent way of referencing objects in the SELinux policy, but it also removes any ambiguity that can be found in\nother identification methods. For example, a file can have multiple valid path names on a system that makes use of bind\nmounts."),(0,a.kt)("p",null,"The SELinux policy uses these contexts in a series of rules that define how processes can interact with each other and\nthe various system resources. By default, the policy does not allow any interaction unless a rule explicitly grants access."),(0,a.kt)("p",null,"For more information about SELinux, please see ",(0,a.kt)("a",{parentName:"p",href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_selinux/getting-started-with-selinux_using-selinux"},"Red Hat documentation")),(0,a.kt)("h3",{id:"activate-selinux-in-permissive-mode"},"Activate SELinux in permissive mode"),(0,a.kt)("p",null,"By default, SELinux is disabled during the Centreon installation process. To enable SELinux in permissive mode, you need to\nmodify the ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/selinux/config")," file as:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# This file controls the state of SELinux on the system.\n# SELINUX= can take one of these three values:\n#     enforcing - SELinux security policy is enforced.\n#     permissive - SELinux prints warnings instead of enforcing.\n#     disabled - No SELinux policy is loaded.\nSELINUX=permissive\n# SELINUXTYPE= can take one of three two values:\n#     targeted - Targeted processes are protected,\n#     minimum - Modification of targeted policy. Only selected processes are protected.\n#     mls - Multi Level Security protection.\nSELINUXTYPE=targeted\n")),(0,a.kt)("p",null,"Then reboot your server:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"shutdown -r now\n")),(0,a.kt)("h3",{id:"install-centreon-selinux-packages"},"Install Centreon SELinux packages"),(0,a.kt)("p",null,"Depending on the type of server, install the packages with the following command:"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Central / Remote Server",label:"Central / Remote Server",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install centreon-common-selinux \\\ncentreon-web-selinux \\\ncentreon-broker-selinux \\\ncentreon-engine-selinux \\\ncentreon-gorgoned-selinux \\\ncentreon-plugins-selinux\n"))),(0,a.kt)(l.Z,{value:"Poller",label:"Poller",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install centreon-common-selinux \\\ncentreon-broker-selinux \\\ncentreon-engine-selinux \\\ncentreon-gorgoned-selinux \\\ncentreon-plugins-selinux\n"))),(0,a.kt)(l.Z,{value:"Map server",label:"Map server",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install centreon-map-selinux\n"))),(0,a.kt)(l.Z,{value:"MBI server",label:"MBI server",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install centreon-mbi-selinux\n"))))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Central / Remote Server",label:"Central / Remote Server",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install centreon-common-selinux \\\ncentreon-web-selinux \\\ncentreon-broker-selinux \\\ncentreon-engine-selinux \\\ncentreon-gorgoned-selinux \\\ncentreon-plugins-selinux\n"))),(0,a.kt)(l.Z,{value:"Poller",label:"Poller",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install centreon-common-selinux \\\ncentreon-broker-selinux \\\ncentreon-engine-selinux \\\ncentreon-gorgoned-selinux \\\ncentreon-plugins-selinux\n"))),(0,a.kt)(l.Z,{value:"Map server",label:"Map server",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install centreon-map-selinux\n"))),(0,a.kt)(l.Z,{value:"MBI server",label:"MBI server",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install centreon-mbi-selinux\n"))))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Central / Remote Server",label:"Central / Remote Server",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt install centreon-common-selinux \\\ncentreon-web-selinux \\\ncentreon-broker-selinux \\\ncentreon-engine-selinux \\\ncentreon-gorgoned-selinux \\\ncentreon-plugins-selinux\n"))),(0,a.kt)(l.Z,{value:"Poller",label:"Poller",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt install centreon-common-selinux \\\ncentreon-broker-selinux \\\ncentreon-engine-selinux \\\ncentreon-gorgoned-selinux \\\ncentreon-plugins-selinux\n"))),(0,a.kt)(l.Z,{value:"Map server",label:"Map server",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt install centreon-map-selinux\n"))),(0,a.kt)(l.Z,{value:"MBI server",label:"MBI server",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt install centreon-mbi-selinux\n")))))),(0,a.kt)("p",null,"To check the installation, execute the following command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"semodule -l | grep centreon\n")),(0,a.kt)("p",null,"Depending on your type of server, you can see:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"centreon-broker 0.0.5\ncentreon-common 0.0.10\ncentreon-engine 0.0.8\ncentreon-gorgoned   0.0.3\ncentreon-plugins    0.0.2\ncentreon-web    0.0.8\n")),(0,a.kt)("h3",{id:"audit-logs-and-enable-selinux"},"Audit logs and enable SELinux"),(0,a.kt)("p",null,"Before enabling SELinux in ",(0,a.kt)("strong",{parentName:"p"},"enforcing")," mode, you need to be sure that no errors appear using the following command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cat /var/log/audit/audit.log | grep -i denied\n")),(0,a.kt)("p",null,"If errors appear, you must analyze them and decide if these errors are regular and should be added to\nthe Centreon default SELinux rules. To do this, use the following command to transform errors into SELinux rules:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"audit2allow -a\n")),(0,a.kt)("p",null,"Then execute the proposed rules."),(0,a.kt)("p",null,"If after a while, no error is present, you can activate SELinux in full mode by\nfollowing this ",(0,a.kt)("a",{parentName:"p",href:"#activate-selinux-in-permissive-mode"},"procedure")," using ",(0,a.kt)("strong",{parentName:"p"},"enforcing")," mode."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Do not hesitate to give us your feedback on ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/centreon/centreon"},"Github"),".")),(0,a.kt)("h2",{id:"securing-configuration-files"},"Securing configuration files"),(0,a.kt)("p",null,"Change the permissions for the following configuration files:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"chown centreon:centreon /etc/centreon/conf.pm\nchmod 660 /etc/centreon/conf.pm\n")),(0,a.kt)("p",null,"and"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"chown apache:apache /etc/centreon/centreon.conf.php\nchmod 660 /etc/centreon/centreon.conf.php\n")),(0,a.kt)("h2",{id:"securing-root-access-to-the-dbms"},"Securing root access to the DBMS"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://mariadb.com/kb/en/mysql_secure_installation/"},"MariaDB")," proposes a default procedure to secure the DBMS\ninstallation. It is mandatory to set a password for the ",(0,a.kt)("strong",{parentName:"p"},"root")," user of the database. If you haven't already done so, please execute the following command and follow the instructions:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"mysql_secure_installation\n")),(0,a.kt)("h2",{id:"enable-firewalld"},"Enable firewalld"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("p",null,"Install firewalld:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install firewalld\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("p",null,"Install firewalld:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install firewalld\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("p",null,"Install firewalld:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt install firewalld\n")))),(0,a.kt)("p",null,"Enable firewalld:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl enable firewalld\nsystemctl start firewalld\n")),(0,a.kt)("p",null,"Then add rules for firewalld:"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"The list of network flows required for each type of server is defined\n",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/installation/architectures#tables-of-platform-flows"},"here"),".")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Central / Remote Server",label:"Central / Remote Server",mdxType:"TabItem"},(0,a.kt)("p",null,"Execute the following commands (change the port numbers if you have customized them):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# For default protocols\nfirewall-cmd --zone=public --add-service=ssh --permanent\nfirewall-cmd --zone=public --add-service=http --permanent\nfirewall-cmd --zone=public --add-service=https --permanent\nfirewall-cmd --zone=public --add-service=snmp --permanent\nfirewall-cmd --zone=public --add-service=snmptrap --permanent\n# Centreon Gorgone\nfirewall-cmd --zone=public --add-port=5556/tcp --permanent\n# Centreon Broker\nfirewall-cmd --zone=public --add-port=5669/tcp --permanent\n"))),(0,a.kt)(l.Z,{value:"Poller",label:"Poller",mdxType:"TabItem"},(0,a.kt)("p",null,"Execute the following commands:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# For default protocols\nfirewall-cmd --zone=public --add-service=ssh --permanent\nfirewall-cmd --zone=public --add-service=snmp --permanent\nfirewall-cmd --zone=public --add-service=snmptrap --permanent\n# Centreon Gorgone\nfirewall-cmd --zone=public --add-port=5556/tcp --permanent\n")))),(0,a.kt)("p",null,"Once the rules have been added, reload firewalld:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"firewall-cmd --reload\n")),(0,a.kt)("p",null,"To check that the configuration has been applied correctly, use the following command to list all active rules:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"firewall-cmd --list-all\n")),(0,a.kt)("p",null,"For instance:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"public (active)\n  target: default\n  icmp-block-inversion: no\n  interfaces: eth0\n  sources:\n  services: http snmp snmptrap ssh\n  ports: 5556/tcp 5669/tcp\n  protocols:\n  forward: no\n  masquerade: no\n  forward-ports:\n  source-ports:\n  icmp-blocks:\n  rich rules:\n")),(0,a.kt)("h2",{id:"enable-fail2ban"},"Enable fail2ban"),(0,a.kt)("p",null,"Fail2Ban is an intrusion prevention software framework that protects computer servers from brute-force attacks."),(0,a.kt)("p",null,"Install the inotify module:"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install python3-inotify\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install python3-inotify\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt install python3-inotify\n")))),(0,a.kt)("p",null,"Install fail2ban:"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yum install epel-release\nyum install fail2ban fail2ban-systemd\n")),(0,a.kt)("p",null,"If you have SELinux installed, then update the SELinux policies:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yum update -y selinux-policy*\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yum install epel-release\nyum install fail2ban fail2ban-systemd\n")),(0,a.kt)("p",null,"If you have SELinux installed, then update the SELinux policies:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"yum update -y selinux-policy*\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt install fail2ban\n")))),(0,a.kt)("p",null,"Enable fail2ban:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl enable fail2ban\nsystemctl start fail2ban \n")),(0,a.kt)("p",null,"Copy the default rules file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local\n")),(0,a.kt)("p",null,"Edit the file ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/fail2ban/jail.local")," and search the ",(0,a.kt)("strong",{parentName:"p"},"[centreon]")," block, then modify like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"[centreon]\nport    = http,https\nlogpath = /var/log/centreon/login.log\nbackend  = pyinotify\n")),(0,a.kt)("p",null,"To enable the ",(0,a.kt)("strong",{parentName:"p"},"centreon")," fail2ban rule, create the ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/fail2ban/jail.d/custom.conf")," file and add the following lines:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"[centreon]\nenabled = true\nfindtime = 10m\nbantime = 10m\nmaxretry = 3\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"maxretry")," is the number of authentications failed before banning the IP address"),(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"bantime")," is the duration of the ban"),(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"findtime")," is the time range to find authentication failed")),(0,a.kt)("p",null,"Then restart fail2ban to load your rule:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart fail2ban\n")),(0,a.kt)("p",null,"To check the status of the ",(0,a.kt)("strong",{parentName:"p"},"centreon")," rule you can run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"fail2ban-client status centreon\n")),(0,a.kt)("p",null,"Here is an example of output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"Status for the jail: centreon\n|- Filter\n|  |- Currently failed: 1\n|  |- Total failed: 17\n|  `- File list:    /var/log/centreon/login.log\n`- Actions\n   |- Currently banned: 0\n   |- Total banned: 2\n   `- Banned IP list:\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"For more information, go to the ",(0,a.kt)("a",{parentName:"p",href:"http://www.fail2ban.org"},"official website"),".")),(0,a.kt)("h2",{id:"secure-the-web-server-with-https"},"Secure the web server with HTTPS"),(0,a.kt)("p",null,"By default, Centreon installs a web server in HTTP mode. It is strongly recommended that you switch to HTTPS mode by adding your certificate. It is also recommended that you use a certificate validated by an authority rather than a self-signed one. "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"If you already have a certificate validated by an authority, you can go directly to this ",(0,a.kt)("a",{parentName:"p",href:"#activating-https-mode-on-your-web-server"},"step")," to activate HTTPS mode on your Apache server.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"If you do not have a certificate validated by an authority, you can generate one on platforms such as ",(0,a.kt)("a",{parentName:"p",href:"https://letsencrypt.org/"},"Let's Encrypt"),".")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"If you need to create a certificate with the self-signed method, follow this ",(0,a.kt)("a",{parentName:"p",href:"#creating-a-self-signed-certificate"},"step")," before activating HTTPS mode on your server."))),(0,a.kt)("h3",{id:"creating-a-self-signed-certificate"},"Creating a self-signed certificate"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"}," This procedure allows you to create:"),(0,a.kt)("ul",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ul"},"A private key for the server: ",(0,a.kt)("strong",{parentName:"li"},"centreon7.key")," in our case. It will be used by the Apache service."),(0,a.kt)("li",{parentName:"ul"},"A CSR (Certificate Signing Request) file: ",(0,a.kt)("strong",{parentName:"li"},"centreon7.csr")," in our case."),(0,a.kt)("li",{parentName:"ul"},"A private key for the certificate of the certification authority: ",(0,a.kt)("strong",{parentName:"li"},"ca_demo.key")," in our case."),(0,a.kt)("li",{parentName:"ul"},"A x509 certificate to sign your certificate for the server: ",(0,a.kt)("strong",{parentName:"li"},"ca-demo.crt")," in our case."),(0,a.kt)("li",{parentName:"ul"},"A certificate for the server: ",(0,a.kt)("strong",{parentName:"li"},"centreon7.crt")," in our case."))),(0,a.kt)("p",null,"Let's assume that you have a Centreon server with a ",(0,a.kt)("strong",{parentName:"p"},"centreon7.localdomain")," FQDN address."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Prepare the OpenSSL configuration:"),(0,a.kt)("p",{parentName:"li"},"Due to a policy change at Google, self-signed certificates may be rejected by the Google Chrome browser (it is not even possible to add an exception). To continue using this browser, you must change the OpenSSL configuration."),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("p",{parentName:"li"},"Open the file ",(0,a.kt)("strong",{parentName:"p"},"/etc/pki/tls/openssl.cnf"),". The goal here is to edit this file in order to inform the various IPs and FQDNs for the server.")),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("p",{parentName:"li"},"Open the file ",(0,a.kt)("strong",{parentName:"p"},"/etc/pki/tls/openssl.cnf"),". The goal here is to edit this file in order to inform the various IPs and FQDNs for the server.")),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("p",{parentName:"li"},"Open the file ",(0,a.kt)("strong",{parentName:"p"},"/etc/ssl/openssl.cnf"),". The goal here is to edit this file in order to inform the various IPs and FQDNs for the server."))),(0,a.kt)("p",{parentName:"li"},"Find the ",(0,a.kt)("inlineCode",{parentName:"p"},"[v3_ca]")," section in order to add a new ",(0,a.kt)("inlineCode",{parentName:"p"},"alt_names")," tag:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"# Add the alt_names tag that allows you to inform our various IPs and FQDNs for the server\n[ alt_names ]\nIP.1 = xxx.xxx.xxx.xxx\nDNS.1 = centreon7.localdomain\n# If you have several IP (HA: vip + ip)\n# IP.2 = xxx.xxx.xxx.xxx\n[ v3_ca ]\nsubjectAltName = @alt_names\n")),(0,a.kt)("p",{parentName:"li"},"Here is an example of how the file should look:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"[ alt_names ]\nIP.1 = 10.25.11.73\nDNS.1 = centreon7.localdomain\n\n[ v3_ca ]\nsubjectAltName = @alt_names\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Create a private key for the server:"),(0,a.kt)("p",{parentName:"li"},"Let's create a private key named ",(0,a.kt)("strong",{parentName:"p"},"centreon7.key")," without a password so that it can be used by the Apache service."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"openssl genrsa -out centreon7.key 2048\n")),(0,a.kt)("p",{parentName:"li"},"Protect your file by limiting rights:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"chmod 400 centreon7.key\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Create a Certificate Signing Request file:"),(0,a.kt)("p",{parentName:"li"},"From the key you created, create a CSR (Certificate Signing Request) file: ",(0,a.kt)("strong",{parentName:"p"},"centreon7.csr")," in our case. Fill in the fields according to your company. The ",(0,a.kt)("strong",{parentName:"p"},"Common Name")," field must be identical to the hostname of your Apache server (in our case it is ",(0,a.kt)("strong",{parentName:"p"},"centreon7.localdomain"),")."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"openssl req -new -key centreon7.key -out centreon7.csr\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Create a private key for the certificate of certification authority:"),(0,a.kt)("p",{parentName:"li"},"Create a private key for this authority: ",(0,a.kt)("strong",{parentName:"p"},"ca_demo.key")," in our case. We add the ",(0,a.kt)("strong",{parentName:"p"},"-aes256")," option to encrypt the output key and include a password. This password will be requested each time this key is used."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"openssl genrsa -aes256 2048 > ca_demo.key\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Create an x509 certificate from the private key of the certificate of certification authority:"),(0,a.kt)("p",{parentName:"li"},"Create an x509 certificate that will be valid for one year: ",(0,a.kt)("strong",{parentName:"p"},"ca_demo.crt")," in our case."),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"Note that it is necessary to simulate a trusted third party, so the ",(0,a.kt)("strong",{parentName:"p"},"Common Name")," field must be different from the server certificate."),(0,a.kt)("pre",{parentName:"blockquote"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"openssl req -new -x509 -days 365 -key ca_demo.key -out ca_demo.crt\n"))),(0,a.kt)("p",{parentName:"li"},"The certificate being created will enable you to sign your server certificate.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Create a certificate for the server:"),(0,a.kt)("p",{parentName:"li"},"Create your certificate for the server by using the x509 certificate (",(0,a.kt)("strong",{parentName:"p"},"ca_demo.crt"),") to sign it."),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"openssl x509 -req -in centreon7.csr -out centreon7.crt -CA ca_demo.crt -CAkey ca_demo.key -CAcreateserial -CAserial ca_demo.srl  -extfile /etc/pki/tls/openssl.cnf -extensions v3_ca\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"openssl x509 -req -in centreon7.csr -out centreon7.crt -CA ca_demo.crt -CAkey ca_demo.key -CAcreateserial -CAserial ca_demo.srl  -extfile /etc/pki/tls/openssl.cnf -extensions v3_ca\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"openssl x509 -req -in centreon7.csr -out centreon7.crt -CA ca_demo.crt -CAkey ca_demo.key -CAcreateserial -CAserial ca_demo.srl  -extfile /etc/ssl/openssl.cnf -extensions v3_ca\n")))),(0,a.kt)("p",{parentName:"li"},"The password created at step ",(0,a.kt)("strong",{parentName:"p"},"Create a private key for the certificate of certification authority")," must be entered. You get your server certificate named ",(0,a.kt)("strong",{parentName:"p"},"centreon7.crt"),"."),(0,a.kt)("p",{parentName:"li"},"You can view the contents of the file: "),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-text"},"less centreon7.crt\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"You must then retrieve the x509 certificate file (",(0,a.kt)("strong",{parentName:"p"},"ca_demo.crt"),") and import it into your browser's certificate manager."))),(0,a.kt)("p",null,"Now that you have your self-signed certificate, you can perform the following procedure to activate HTTPS mode on your Apache server."),(0,a.kt)("h3",{id:"activating-https-mode-on-your-web-server"},"Activating HTTPS mode on your web server"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Install the SSL module for Apache:")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install mod_ssl mod_security openssl\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Install your certificates:")),(0,a.kt)("p",null,"Install your certificates (",(0,a.kt)("strong",{parentName:"p"},"centreon7.key")," and ",(0,a.kt)("strong",{parentName:"p"},"centreon7.crt")," in our example) by copying them to the Apache configuration:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cp centreon7.key /etc/pki/tls/private/\ncp centreon7.crt /etc/pki/tls/certs/\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install mod_ssl mod_security openssl\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Install your certificates:")),(0,a.kt)("p",null,"Install your certificates (",(0,a.kt)("strong",{parentName:"p"},"centreon7.key")," and ",(0,a.kt)("strong",{parentName:"p"},"centreon7.crt")," in our example) by copying them to the Apache configuration:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cp centreon7.key /etc/pki/tls/private/\ncp centreon7.crt /etc/pki/tls/certs/\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"curl -sSL https://packages.sury.org/apache2/README.txt | sudo bash -x\napt update\napt install libapache2-mod-security2\na2enmod ssl\na2enmod security2\nsystemctl restart apache2\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Install your certificates:")),(0,a.kt)("p",null,"Install your certificates (",(0,a.kt)("strong",{parentName:"p"},"centreon7.key")," and ",(0,a.kt)("strong",{parentName:"p"},"centreon7.crt")," in our example) by copying them to the Apache configuration:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cp centreon7.key /etc/ssl/private/\ncp centreon7.crt /etc/ssl/certs/\n")))),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Back up the previous Apache configuration for Centreon:")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cp /etc/httpd/conf.d/10-centreon.conf{,.origin}\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cp /etc/httpd/conf.d/10-centreon.conf{,.origin}\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cp /etc/apache2/sites-available/centreon.conf{,.origin}\n")))),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"Edit the Centreon Apache configuration:")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Centreon offers an example of a configuration file to enable HTTPS, available in the following directory:\n",(0,a.kt)("strong",{parentName:"p"},"/usr/share/centreon/examples/centreon.apache.https.conf"))),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/httpd/conf.d/10-centreon.conf")," file by adding the ",(0,a.kt)("strong",{parentName:"p"},"<VirtualHost *:443>")," section.")),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/httpd/conf.d/10-centreon.conf")," file by adding the ",(0,a.kt)("strong",{parentName:"p"},"<VirtualHost *:443>")," section.")),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/apache2/sites-available/centreon.conf")," file by adding the ",(0,a.kt)("strong",{parentName:"p"},"<VirtualHost *:443>")," section."))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},'Define base_uri "/centreon"\nDefine install_dir "/usr/share/centreon"\n\nServerTokens Prod\n\n<VirtualHost *:80>\n    RewriteEngine On\n    RewriteCond %{HTTPS} off\n    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}\n</VirtualHost>\n')),(0,a.kt)("p",null,"This is how the file should look:"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},'Define base_uri "/centreon"\nDefine install_dir "/usr/share/centreon"\n\nServerTokens Prod\n\n<VirtualHost *:80>\n    RewriteEngine On\n    RewriteCond %{HTTPS} off\n    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}\n</VirtualHost>\n\n<VirtualHost *:443>\n    #####################\n    # SSL configuration #\n    #####################\n    SSLEngine On\n    SSLProtocol All -SSLv3 -SSLv2 -TLSv1 -TLSv1.1\n    SSLCipherSuite ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-DSS-AES256-GCM-SHA384:DHE-DSS-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-GCM-SHA256:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!PSK:!DSS:!RC4:!SEED:!ADH:!IDEA\n    SSLHonorCipherOrder On\n    SSLCompression Off\n    SSLCertificateFile /etc/pki/tls/certs/centreon7.crt\n    SSLCertificateKeyFile /etc/pki/tls/private/centreon7.key\n\n    Alias ${base_uri}/api ${install_dir}\n    Alias ${base_uri} ${install_dir}/www/\n\n    <LocationMatch ^\\${base_uri}/?(?!api/latest/|api/beta/|api/v[0-9]+/|api/v[0-9]+\\.[0-9]+/)(.*\\.php(/.*)?)$>\n        ProxyPassMatch "fcgi://127.0.0.1:9042${install_dir}/www/$1"\n    </LocationMatch>\n\n    <LocationMatch ^\\${base_uri}/?(authentication|api/(latest|beta|v[0-9]+|v[0-9]+\\.[0-9]+))/.*$>\n        ProxyPassMatch "fcgi://127.0.0.1:9042${install_dir}/api/index.php/$1"\n    </LocationMatch>\n\n    ProxyTimeout 300\n    ErrorDocument 404 ${base_uri}/index.html\n    Options -Indexes +FollowSymLinks\n\n    <IfModule mod_security2.c>\n        # https://github.com/SpiderLabs/ModSecurity/issues/652\n        SecRuleRemoveById 200003\n    </IfModule>\n\n    <Directory "${install_dir}/www">\n        DirectoryIndex index.php\n        AllowOverride none\n        Require all granted\n        FallbackResource ${base_uri}/index.html\n    </Directory>\n\n    <Directory "${install_dir}/api">\n        AllowOverride none\n        Require all granted\n    </Directory>\n\n    <If "\'${base_uri}\' != \'/\'">\n        RedirectMatch ^/$ ${base_uri}\n    </If>\n</VirtualHost>\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Do not forget to change the ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateFile")," and ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateKeyFile")," directives with the path containing your\ncertificate and key. In our case: ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateFile /etc/pki/tls/certs/centreon7.crt")," and ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateKeyFile /etc/pki/tls/private/centreon7.key"),"."))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},'Define base_uri "/centreon"\nDefine install_dir "/usr/share/centreon"\n\nServerTokens Prod\n\n<VirtualHost *:80>\n    RewriteEngine On\n    RewriteCond %{HTTPS} off\n    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}\n</VirtualHost>\n\n<VirtualHost *:443>\n    #####################\n    # SSL configuration #\n    #####################\n    SSLEngine On\n    SSLProtocol All -SSLv3 -SSLv2 -TLSv1 -TLSv1.1\n    SSLCipherSuite ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-DSS-AES256-GCM-SHA384:DHE-DSS-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-GCM-SHA256:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!PSK:!DSS:!RC4:!SEED:!ADH:!IDEA\n    SSLHonorCipherOrder On\n    SSLCompression Off\n    SSLCertificateFile /etc/pki/tls/certs/centreon7.crt\n    SSLCertificateKeyFile /etc/pki/tls/private/centreon7.key\n\n    Alias ${base_uri}/api ${install_dir}\n    Alias ${base_uri} ${install_dir}/www/\n\n    <LocationMatch ^\\${base_uri}/?(?!api/latest/|api/beta/|api/v[0-9]+/|api/v[0-9]+\\.[0-9]+/)(.*\\.php(/.*)?)$>\n        ProxyPassMatch "fcgi://127.0.0.1:9042${install_dir}/www/$1"\n    </LocationMatch>\n\n    <LocationMatch ^\\${base_uri}/?(authentication|api/(latest|beta|v[0-9]+|v[0-9]+\\.[0-9]+))/.*$>\n        ProxyPassMatch "fcgi://127.0.0.1:9042${install_dir}/api/index.php/$1"\n    </LocationMatch>\n\n    ProxyTimeout 300\n    ErrorDocument 404 ${base_uri}/index.html\n    Options -Indexes +FollowSymLinks\n\n    <IfModule mod_security2.c>\n        # https://github.com/SpiderLabs/ModSecurity/issues/652\n        SecRuleRemoveById 200003\n    </IfModule>\n\n    <Directory "${install_dir}/www">\n        DirectoryIndex index.php\n        AllowOverride none\n        Require all granted\n        FallbackResource ${base_uri}/index.html\n    </Directory>\n\n    <Directory "${install_dir}/api">\n        AllowOverride none\n        Require all granted\n    </Directory>\n\n    <If "\'${base_uri}\' != \'/\'">\n        RedirectMatch ^/$ ${base_uri}\n    </If>\n</VirtualHost>\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Do not forget to change the ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateFile")," and ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateKeyFile")," directives with the path containing your\ncertificate and key. In our case: ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateFile /etc/pki/tls/certs/centreon7.crt")," and ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateKeyFile /etc/pki/tls/private/centreon7.key"),"."))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},'Define base_uri "/centreon"\nDefine install_dir "/usr/share/centreon"\n\nServerTokens Prod\n\n<VirtualHost *:80>\n    RewriteEngine On\n    RewriteCond %{HTTPS} off\n    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}\n</VirtualHost>\n\n<VirtualHost *:443>\n    #####################\n    # SSL configuration #\n    #####################\n    SSLEngine On\n    SSLProtocol All -SSLv3 -SSLv2 -TLSv1 -TLSv1.1\n    SSLCipherSuite ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-DSS-AES256-GCM-SHA384:DHE-DSS-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-GCM-SHA256:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!PSK:!DSS:!RC4:!SEED:!ADH:!IDEA\n    SSLHonorCipherOrder On\n    SSLCompression Off\n    SSLCertificateFile /etc/ssl/certs/centreon7.crt\n    SSLCertificateKeyFile /etc/ssl/private/centreon7.key\n\n    Alias ${base_uri}/api ${install_dir}\n    Alias ${base_uri} ${install_dir}/www/\n\n    <LocationMatch ^\\${base_uri}/?(?!api/latest/|api/beta/|api/v[0-9]+/|api/v[0-9]+\\.[0-9]+/)(.*\\.php(/.*)?)$>\n        ProxyPassMatch "fcgi://127.0.0.1:9042${install_dir}/www/$1"\n    </LocationMatch>\n\n    <LocationMatch ^\\${base_uri}/?(authentication|api/(latest|beta|v[0-9]+|v[0-9]+\\.[0-9]+))/.*$>\n        ProxyPassMatch "fcgi://127.0.0.1:9042${install_dir}/api/index.php/$1"\n    </LocationMatch>\n\n    ProxyTimeout 300\n    ErrorDocument 404 ${base_uri}/index.html\n    Options -Indexes +FollowSymLinks\n\n    <IfModule mod_security2.c>\n        # https://github.com/SpiderLabs/ModSecurity/issues/652\n        SecRuleRemoveById 200003\n    </IfModule>\n\n    <Directory "${install_dir}/www">\n        DirectoryIndex index.php\n        AllowOverride none\n        Require all granted\n        FallbackResource ${base_uri}/index.html\n    </Directory>\n\n    <Directory "${install_dir}/api">\n        AllowOverride none\n        Require all granted\n    </Directory>\n\n    <If "\'${base_uri}\' != \'/\'">\n        RedirectMatch ^/$ ${base_uri}\n    </If>\n</VirtualHost>\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Do not forget to change the ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateFile")," and ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateKeyFile")," directives with the path containing your\ncertificate and key. In our case: ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateFile /etc/ssl/certs/centreon7.crt")," and ",(0,a.kt)("strong",{parentName:"p"},"SSLCertificateKeyFile /etc/ssl/private/centreon7.key"),".")))),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Enable HttpOnly / Secure flags and hide the Apache server signature:")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/httpd/conf.d/10-centreon.conf")," file and add the following lines before the ",(0,a.kt)("inlineCode",{parentName:"p"},"<VirtualHost>")," tag:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},'Header always edit Set-Cookie ^(.*)$ $1;HttpOnly;Secure;SameSite=Strict\nHeader always set Strict-Transport-Security "max-age=31536000; includeSubDomains"\nServerSignature Off\nServerTokens Prod\n')),(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/php.d/50-centreon.ini")," file and turn off the ",(0,a.kt)("inlineCode",{parentName:"p"},"expose_php")," parameter:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-phpconf"},"expose_php = Off\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/httpd/conf.d/10-centreon.conf")," file and add the following lines before the ",(0,a.kt)("inlineCode",{parentName:"p"},"<VirtualHost>")," tag:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},'Header always edit Set-Cookie ^(.*)$ $1;HttpOnly;Secure;SameSite=Strict\nHeader always set Strict-Transport-Security "max-age=31536000; includeSubDomains"\nServerSignature Off\nServerTokens Prod\n')),(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/php.d/50-centreon.ini")," file and turn off the ",(0,a.kt)("inlineCode",{parentName:"p"},"expose_php")," parameter:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-phpconf"},"expose_php = Off\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/apache2/sites-available/centreon.conf")," file and add the following lines before the ",(0,a.kt)("inlineCode",{parentName:"p"},"<VirtualHost>")," tag:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},'Header set X-Frame-Options: "sameorigin"\nHeader always edit Set-Cookie ^(.*)$ $1;HttpOnly;Secure;SameSite=Strict\nHeader always set Strict-Transport-Security "max-age=31536000; includeSubDomains"\nServerSignature Off\nServerTokens Prod\nTraceEnable Off\n')),(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/php/8.1/mods-available/centreon.ini")," file and turn off the ",(0,a.kt)("strong",{parentName:"p"},"expose_php")," parameter:"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"This was done during the installation process.")))),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},"Hide the default ",(0,a.kt)("strong",{parentName:"li"},"/icons")," directory:")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/httpd/conf.d/autoindex.conf")," file and comment the following line:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},'#Alias /icons/ "/usr/share/httpd/icons/"\n'))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/httpd/conf.d/autoindex.conf")," file and comment the following line:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},'#Alias /icons/ "/usr/share/httpd/icons/"\n'))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("p",null,"Edit the ",(0,a.kt)("strong",{parentName:"p"},"/etc/apache2/mods-available/autoindex.conf")," file and comment the following line:"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"The default icons directory is already hidden.")))),(0,a.kt)("ol",{start:7},(0,a.kt)("li",{parentName:"ol"},"You can perform this test to check that Apache is properly configured, by running the following command:")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},"apachectl configtest\n")),(0,a.kt)("p",null,"The expected result is the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},"Syntax OK\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},"apachectl configtest\n")),(0,a.kt)("p",null,"The expected result is the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},"Syntax OK\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},"apache2ctl configtest\n")),(0,a.kt)("p",null,"The expected result is the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},"Syntax OK\n")))),(0,a.kt)("ol",{start:8},(0,a.kt)("li",{parentName:"ol"},"Restart the Apache and PHP processes to take the new configuration into account:")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart php-fpm httpd\n")),(0,a.kt)("p",null,"Then check its status:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl status httpd\n")),(0,a.kt)("p",null,"If everything is ok, you should have:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'\u25cf httpd.service - The Apache HTTP Server\n   Loaded: loaded (/usr/lib/systemd/system/httpd.service; enabled; vendor preset: disabled)\n  Drop-In: /usr/lib/systemd/system/httpd.service.d\n           \u2514\u2500php-fpm.conf\n   Active: active (running) since Tue 2020-10-27 12:49:42 GMT; 2h 35min ago\n     Docs: man:httpd.service(8)\n Main PID: 1483 (httpd)\n   Status: "Total requests: 446; Idle/Busy workers 100/0;Requests/sec: 0.0479; Bytes served/sec: 443 B/sec"\n    Tasks: 278 (limit: 5032)\n   Memory: 39.6M\n   CGroup: /system.slice/httpd.service\n           \u251c\u25001483 /usr/sbin/httpd -DFOREGROUND\n           \u251c\u25001484 /usr/sbin/httpd -DFOREGROUND\n           \u251c\u25001485 /usr/sbin/httpd -DFOREGROUND\n           \u251c\u25001486 /usr/sbin/httpd -DFOREGROUND\n           \u251c\u25001487 /usr/sbin/httpd -DFOREGROUND\n           \u2514\u25001887 /usr/sbin/httpd -DFOREGROUND\n\n'))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart php-fpm httpd\n")),(0,a.kt)("p",null,"Then check its status:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl status httpd\n")),(0,a.kt)("p",null,"If everything is ok, you should have:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'\u25cf httpd.service - The Apache HTTP Server\n   Loaded: loaded (/usr/lib/systemd/system/httpd.service; enabled; vendor preset: disabled)\n  Drop-In: /usr/lib/systemd/system/httpd.service.d\n           \u2514\u2500php-fpm.conf\n   Active: active (running) since Tue 2020-10-27 12:49:42 GMT; 2h 35min ago\n     Docs: man:httpd.service(8)\n Main PID: 1483 (httpd)\n   Status: "Total requests: 446; Idle/Busy workers 100/0;Requests/sec: 0.0479; Bytes served/sec: 443 B/sec"\n    Tasks: 278 (limit: 5032)\n   Memory: 39.6M\n   CGroup: /system.slice/httpd.service\n           \u251c\u25001483 /usr/sbin/httpd -DFOREGROUND\n           \u251c\u25001484 /usr/sbin/httpd -DFOREGROUND\n           \u251c\u25001485 /usr/sbin/httpd -DFOREGROUND\n           \u251c\u25001486 /usr/sbin/httpd -DFOREGROUND\n           \u251c\u25001487 /usr/sbin/httpd -DFOREGROUND\n           \u2514\u25001887 /usr/sbin/httpd -DFOREGROUND\n\n'))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart php8.1-fpm apache2\n")),(0,a.kt)("p",null,"Then check its status:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl status apache2\n")),(0,a.kt)("p",null,"If everything is ok, you should have:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"\u25cf apache2.service - The Apache HTTP Server\n    Loaded: loaded (/lib/systemd/system/apache2.service; enabled; vendor pres>\n     Active: active (running) since Tue 2022-08-09 05:01:36 UTC; 3h 56min ago\n       Docs: https://httpd.apache.org/docs/2.4/\n   Main PID: 518 (apache2)\n      Tasks: 11 (limit: 2356)\n     Memory: 18.1M\n        CPU: 1.491s\n     CGroup: /system.slice/apache2.service\n             \u251c\u2500 518 /usr/sbin/apache2 -k start\n             \u251c\u25001252 /usr/sbin/apache2 -k start\n             \u251c\u25001254 /usr/sbin/apache2 -k start\n             \u251c\u25001472 /usr/sbin/apache2 -k start\n             \u251c\u25003857 /usr/sbin/apache2 -k start\n             \u251c\u25003858 /usr/sbin/apache2 -k start\n             \u251c\u25003859 /usr/sbin/apache2 -k start\n             \u251c\u25003860 /usr/sbin/apache2 -k start\n             \u251c\u25003876 /usr/sbin/apache2 -k start\n             \u251c\u25006261 /usr/sbin/apache2 -k start\n             \u2514\u25006509 /usr/sbin/apache2 -k start\n")))),(0,a.kt)("p",null,"Now you can access your platform with your browser in HTTPS mode."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Once your web server is set to HTTPS mode, if you have a MAP server on your platform, you must set it to HTTPS mode too, otherwise\nrecent web browsers may block communication between the two servers. The procedure is detailed ",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/graph-views/secure-your-map-platform#Configure-HTTPS/TLS-on-the-MAP-server"},"here"),".")),(0,a.kt)("ol",{start:9},(0,a.kt)("li",{parentName:"ol"},"Gorgone API configuration")),(0,a.kt)("p",null,"Replace ",(0,a.kt)("strong",{parentName:"p"},"127.0.0.1")," with the FQDN of your central server in the ",(0,a.kt)("strong",{parentName:"p"},"/etc/centreon-gorgone/config.d/31-centreon-api.yaml")," file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},'gorgone:\n  tpapi:\n    - name: centreonv2\n      base_url: "http://centreon7.localdomain/centreon/api/latest/"\n      username: "centreon-gorgone"\n      password: "bpltc4aY"\n    - name: clapi\n      username: "centreon-gorgone"\n      password: "bpltc4aY"\n')),(0,a.kt)("p",null,"Then restart the Gorgone daemon:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart gorgoned\n")),(0,a.kt)("p",null,"Then check its status:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl status gorgoned\n")),(0,a.kt)("p",null,"If everything is ok, you should have:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"\u25cf gorgoned.service - Centreon Gorgone\n   Loaded: loaded (/etc/systemd/system/gorgoned.service; enabled; vendor preset: disabled)\n   Active: active (running) since Mon 2023-03-06 15:58:10 CET; 27min ago\n Main PID: 1791096 (perl)\n    Tasks: 124 (limit: 23040)\n   Memory: 595.3M\n   CGroup: /system.slice/gorgoned.service\n           \u251c\u25001791096 /usr/bin/perl /usr/bin/gorgoned --config=/etc/centreon-gorgone/config.yaml --logfile=/var/log/centreon-gorgone/gorgoned.log --severity=info\n           \u251c\u25001791109 gorgone-statistics\n           \u251c\u25001791112 gorgone-legacycmd\n           \u251c\u25001791117 gorgone-engine\n           \u251c\u25001791118 gorgone-audit\n           \u251c\u25001791125 gorgone-nodes\n           \u251c\u25001791138 gorgone-action\n           \u251c\u25001791151 gorgone-cron\n           \u251c\u25001791158 gorgone-dbcleaner\n           \u251c\u25001791159 gorgone-autodiscovery\n           \u251c\u25001791166 gorgone-httpserver\n           \u251c\u25001791180 gorgone-proxy\n           \u251c\u25001791181 gorgone-proxy\n           \u251c\u25001791182 gorgone-proxy\n           \u251c\u25001791189 gorgone-proxy\n           \u2514\u25001791190 gorgone-proxy\n\nmars 06 15:58:10 ito-central systemd[1]: gorgoned.service: Succeeded.\nmars 06 15:58:10 ito-central systemd[1]: Stopped Centreon Gorgone.\nmars 06 15:58:10 ito-central systemd[1]: Started Centreon Gorgone.\n")),(0,a.kt)("p",null,"You should see the following line in the Gorgone daemon log file ",(0,a.kt)("strong",{parentName:"p"},"/var/log/centreon-gorgone/gorgoned.log"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"2023-03-06 15:58:12 - INFO - [autodiscovery] -class- host discovery - sync started\n")),(0,a.kt)("h2",{id:"custom-uri"},"Custom URI"),(0,a.kt)("p",null,"It is possible to customize the URI for your Centreon platform. For example, ",(0,a.kt)("strong",{parentName:"p"},"/centreon")," can be replaced by ",(0,a.kt)("strong",{parentName:"p"},"/monitoring"),"."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"At least one path level is mandatory.")),(0,a.kt)("p",null,"To customize the Centreon URI:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Edit the Apache configuration file for Centreon Web:")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"vi /etc/httpd/conf.d/10-centreon.conf\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"vi /etc/httpd/conf.d/10-centreon.conf\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"vi /etc/apache2/sites-available/centreon.conf\n")))),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Replace ",(0,a.kt)("strong",{parentName:"li"},"/centreon")," with your new path:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apache"},'Define base_uri "/centreon"\n')),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Restart Apache:")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart httpd\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart httpd\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart apache2\n")))),(0,a.kt)("h2",{id:"enabling-http2"},"Enabling http2"),(0,a.kt)("p",null,"It is possible to enable the http2 protocol to improve Centreon's network performance."),(0,a.kt)("p",null,"To use http2, you need to follow these steps:"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"#secure-the-web-server-with-https"},"Configure https on Centreon"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Install the nghttp2 module:"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install nghttp2\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Enable the http2 protocol in ",(0,a.kt)("strong",{parentName:"li"},"/etc/httpd/conf.d/10-centreon.conf"),":")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},"...\n<VirtualHost *:443>\n    Protocols h2 h2c http/1.1\n    ...\n</VirtualHost>\n...\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Update the method used by the apache multi-process module in ",(0,a.kt)("strong",{parentName:"p"},"/etc/httpd/conf.modules.d/00-mpm.conf"),":"),(0,a.kt)("p",{parentName:"li"},"Comment the following line:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"LoadModule mpm_prefork_module modules/mod_mpm_prefork.so\n")),(0,a.kt)("p",{parentName:"li"},"Uncomment the following line:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"LoadModule mpm_event_module modules/mod_mpm_event.so\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Restart the Apache process to take the new configuration into account:"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart httpd\n"))),(0,a.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"#secure-the-web-server-with-https"},"Configure https on Centreon"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Install the nghttp2 module:"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"dnf install nghttp2\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Enable the http2 protocol in ",(0,a.kt)("strong",{parentName:"li"},"/etc/httpd/conf.d/10-centreon.conf"),":")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},"...\n<VirtualHost *:443>\n    Protocols h2 h2c http/1.1\n    ...\n</VirtualHost>\n...\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Update the method used by the apache multi-process module in ",(0,a.kt)("strong",{parentName:"p"},"/etc/httpd/conf.modules.d/00-mpm.conf"),":"),(0,a.kt)("p",{parentName:"li"},"Comment the following line:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"LoadModule mpm_prefork_module modules/mod_mpm_prefork.so\n")),(0,a.kt)("p",{parentName:"li"},"Uncomment the following line:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"LoadModule mpm_event_module modules/mod_mpm_event.so\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Restart the Apache process to take the new configuration into account:"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart httpd\n"))),(0,a.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"#secure-the-web-server-with-https"},"Configure HTTPS on your Centreon server"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Install the nghttp2 module:"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"apt install nghttp2\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Enable the ",(0,a.kt)("strong",{parentName:"li"},"http2")," protocol in ",(0,a.kt)("strong",{parentName:"li"},"/etc/apache2/sites-available/centreon.conf"),":")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},"...\n<VirtualHost *:443>\n    Protocols h2 h2c http/1.1\n    ...\n</VirtualHost>\n...\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"Execute the following commands:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"a2dismod php8.1\na2dismod mpm_prefork\na2enmod mpm_event\na2enmod http2\n")),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Restart the Apache process to take the new configuration into account:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart apache2\n")))),(0,a.kt)("h2",{id:"user-authentication"},"User authentication"),(0,a.kt)("p",null,"Centreon offers several methods to authenticate users:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/connect/loginpwd"},"local")," (MySQL)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/administration/parameters/ldap"},"LDAP")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/connect/sso"},"Generic SSO")," or ",(0,a.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/connect/openid"},"OpenId Connect"))),(0,a.kt)("h2",{id:"create-user-profiles"},"Create user profiles"),(0,a.kt)("p",null,"Centreon offers to manage access permissions to the different menus, resources and possible actions on resources via\nthe management of ",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/administration/access-control-lists"},"Access Control List"),"."),(0,a.kt)("h2",{id:"secure-communications-between-servers"},"Secure communications between servers"),(0,a.kt)("p",null,"It is strongly recommended to secure communications between the different servers of the Centreon platform if some servers\nare not in a secure network."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"The Table of network flows is available ",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/installation/architectures#table-of-network-flows"},"here"),".")),(0,a.kt)("h3",{id:"centreon-broker-communication"},"Centreon Broker communication"),(0,a.kt)("h4",{id:"centreon-broker-and-the-firewall"},"Centreon Broker and the firewall"),(0,a.kt)("p",null,"In certain cases, you may not be able to initialize the Centreon Broker data flow from the poller (or the Remote Server)\nto the Central Server or the Remote Server.\n",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/monitoring/monitoring-servers/advanced-configuration#centreon-broker-and-the-firewall"},"See the following configuration to invert the flow"),"."),(0,a.kt)("h4",{id:"centreon-broker-flow-authentication"},"Centreon Broker flow authentication"),(0,a.kt)("p",null,"If you need to authenticate pollers that are sending data to the monitoring system, you can use the Centreon Broker\nauthentication mechanism, which is based on X.509 certificates.\n",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/monitoring/monitoring-servers/advanced-configuration#centreon-broker-flow-authentication"},"See the following configuration to authenticate the peer"),"."),(0,a.kt)("h4",{id:"compress-and-encrypt-centreon-broker-communication"},"Compress and encrypt Centreon Broker communication"),(0,a.kt)("p",null,"It is also possible to compress and encrypt Centreon Broker communication.\nGo to the ",(0,a.kt)("strong",{parentName:"p"},"Configuration > Pollers > Broker configuration")," menu, edit your Centreon Broker configuration\nand enable for ",(0,a.kt)("strong",{parentName:"p"},"IPv4")," inputs and outputs:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Enable TLS encryption: Auto"),(0,a.kt)("li",{parentName:"ul"},"Enable negotiation: Yes"),(0,a.kt)("li",{parentName:"ul"},"Compression (zlib): Auto")),(0,a.kt)("h3",{id:"centreon-gorgone-communication"},"Centreon Gorgone communication"),(0,a.kt)("p",null,"By default, ZMQ communications are secured; both external communications (with the poller) and internal ones (between gorgone processes)."),(0,a.kt)("p",null,"However, the gorgone HTTP API is unsecured by default. Only localhost can talk with gorgone, but the communication does not take place using SSL."),(0,a.kt)("p",null,"You can ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/centreon/centreon/blob/develop/centreon-gorgone/docs/modules/core/httpserver.md"},"configure SSL")," in the ",(0,a.kt)("strong",{parentName:"p"},"/etc/centreon-gorgone/config.d/40-gorgoned.yaml")," file."),(0,a.kt)("p",null,"Then you must configure gorgone using the ",(0,a.kt)("strong",{parentName:"p"},"Administration > Parameters > Gorgone")," page."),(0,a.kt)("h2",{id:"security-information-and-event-management---siem"},"Security Information and Event Management - SIEM"),(0,a.kt)("p",null,"Centreon event logs are available in the following directories:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Logs directory"),(0,a.kt)("th",{parentName:"tr",align:null},"Central server"),(0,a.kt)("th",{parentName:"tr",align:null},"Remote Server"),(0,a.kt)("th",{parentName:"tr",align:null},"Poller"),(0,a.kt)("th",{parentName:"tr",align:null},"Centreon Map server"),(0,a.kt)("th",{parentName:"tr",align:null},"Centreon MBI Server"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"/var/log/centreon"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null})),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"/var/log/centreon-broker"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null})),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"/var/log/centreon-engine"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null})),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"/var/log/centreon-gorgone"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null})),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"/var/log/centreon-bi"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null})),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"/var/log/centreon-map"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"X"),(0,a.kt)("td",{parentName:"tr",align:null},"X")))),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"In addition, all actions to modify the Centreon configuration carried out by users are available via the\n",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/administration/logging-configuration-changes"},(0,a.kt)("strong",{parentName:"a"},"Administration > Logs"))," menu.")),(0,a.kt)("h2",{id:"backing-up-the-platform"},"Backing up the platform"),(0,a.kt)("p",null,"Centreon offers to save the configuration of the platform. To do this, go to the ",(0,a.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2756/docs/administration/backup"},(0,a.kt)("strong",{parentName:"a"},"Administration > Parameters > Backup"))," menu."))}g.isMDXComponent=!0}}]);