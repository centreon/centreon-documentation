"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[48532],{76693:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>h,frontMatter:()=>p,metadata:()=>m,toc:()=>d});n(67294);var a=n(3905),r=n(51715),o=n(7626);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const p={id:"applications-activemq-jmx",title:"ActiveMQ JMX"},c=void 0,m={unversionedId:"integrations/plugin-packs/procedures/applications-activemq-jmx",id:"integrations/plugin-packs/procedures/applications-activemq-jmx",title:"ActiveMQ JMX",description:"Overview",source:"@site/pp/integrations/plugin-packs/procedures/applications-activemq-jmx.md",sourceDirName:"integrations/plugin-packs/procedures",slug:"/integrations/plugin-packs/procedures/applications-activemq-jmx",permalink:"/centreon-documentation/pr-preview/staging/pr-2756/pp/integrations/plugin-packs/procedures/applications-activemq-jmx",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/pp/integrations/plugin-packs/procedures/applications-activemq-jmx.md",tags:[],version:"current",frontMatter:{id:"applications-activemq-jmx",title:"ActiveMQ JMX"},sidebar:"pp",previous:{title:"Absyss VTOM Rest API",permalink:"/centreon-documentation/pr-preview/staging/pr-2756/pp/integrations/plugin-packs/procedures/applications-vtom-restapi"},next:{title:"Alyvix Server",permalink:"/centreon-documentation/pr-preview/staging/pr-2756/pp/integrations/plugin-packs/procedures/applications-monitoring-alyvix-restapi"}},u={},d=[{value:"Overview",id:"overview",level:2},{value:"Monitoring Connector assets",id:"monitoring-connector-assets",level:2},{value:"Monitored objects",id:"monitored-objects",level:3},{value:"Discovery rules",id:"discovery-rules",level:3},{value:"Monitored metrics",id:"monitored-metrics",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"ActiveMQ configuration",id:"activemq-configuration",level:3},{value:"Installation",id:"installation",level:2},{value:"Configuration",id:"configuration",level:2},{value:"FAQ",id:"faq",level:2},{value:"How can I test the Plugin in the command line interface and what do the main options mean?",id:"how-can-i-test-the-plugin-in-the-command-line-interface-and-what-do-the-main-options-mean",level:3},{value:"Why do I get the following error:",id:"why-do-i-get-the-following-error",level:3},{value:"UNKNOWN: protocol issue: Error while fetching <code>http://myactivemq.int.centreon.com:8161/url/path</code>",id:"unknown-protocol-issue-error-while-fetching-httpmyactivemqintcentreoncom8161urlpath",level:4},{value:"UNKNOWN: JMX Request: Cant get a single value.",id:"unknown-jmx-request-cant-get-a-single-value",level:4},{value:"UNKNOWN: protocol issue: java.lang.Exception : Origin null is not allowed to call this agent",id:"unknown-protocol-issue-javalangexception--origin-null-is-not-allowed-to-call-this-agent",level:4}],g={toc:d},k="wrapper";function h(e){var{components:t}=e,n=s(e,["components"]);return(0,a.kt)(k,l(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){i(e,t,n[t])}))}return e}({},g,n),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"overview"},"Overview"),(0,a.kt)("p",null,"Apache ActiveMQ is an open source message broker written in Java together with a full Java Message Service (JMS) client."),(0,a.kt)("h2",{id:"monitoring-connector-assets"},"Monitoring Connector assets"),(0,a.kt)("h3",{id:"monitored-objects"},"Monitored objects"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Brokers (queue / topic)")),(0,a.kt)("h3",{id:"discovery-rules"},"Discovery rules"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(o.Z,{value:"Services",label:"Services",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"left"},"Rule name"),(0,a.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"App-Activemq-Jmx-Brokers-Name"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Discover ActiveMQ Broker")))))),(0,a.kt)("h2",{id:"monitored-metrics"},"Monitored metrics"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(o.Z,{value:"Brokers",label:"Brokers",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"left"},"Metric name"),(0,a.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.store.usage.percentage"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker store percentage usage. Unit: %")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.temporary.usage.percentage"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker temporary store percentage usage. Unit: %")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.memory.usage.percentage"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker memory usage. Unit: %")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.queue.average.enqueue.time.milliseconds"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker average enqueue time (queue). Unit: ms")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.queue.consumers.connected.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker queue connected consumers. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.queue.producers.connected.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker queue connected producers . Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.queue.memory.usage.percentage"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker queue memory usage. Unit: %")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.queue.size.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker queue size. Unit:count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.queue.messages.enqueued.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker enqueued messages. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.queue.messages.dequeue.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker dequeued messages. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.queue.messages.expired.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker queue expired messages. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.queue.messages.inflighted.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker queue inflighted messages. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.queue.messages.size.average.bytes"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker queue average messages size. Unit: bytes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.topic.average.enqueue.time.milliseconds"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker average queue time per topic. Unit: ms")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.topic.consumers.connected.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker connected consumers per topic. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.topic.producers.connected.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker connected producers per topic. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.topic.memory.usage.percentage"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker memory percentage usage per topic. Unit: %")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.topic.size.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker topic size. Unit:count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.topic.messages.enqueued.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker enqueued messages per topic. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.topic.messages.dequeue.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker messages deuque per topic. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.topic.messages.expired.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker expired messages per topic. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.topic.messages.inflighted.count"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker inflighted messages per topic. Unit: count")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker.topic.messages.size.average.bytes"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Broker average messages size per topic. Unit: bytes")))))),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("h3",{id:"activemq-configuration"},"ActiveMQ configuration"),(0,a.kt)("p",null,"ActiveMQ provides a Jolokia RestAPI reachable on http://",(0,a.kt)("em",{parentName:"p"},"server_name"),":8161/api/jolokia\nMore information on how to set up and configure the ActiveMQ RestAPI can be found in the official documentation: ",(0,a.kt)("a",{parentName:"p",href:"https://activemq.apache.org/rest"},"https://activemq.apache.org/rest")),(0,a.kt)("h2",{id:"installation"},"Installation"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(o.Z,{value:"Online License",label:"Online License",mdxType:"TabItem"},(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Install the Plugin on every poller expected to monitor ActiveMQ resources:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yum install centreon-plugin-Applications-ActiveMQ-Jmx\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"On the Centreon Web interface, install the ",(0,a.kt)("em",{parentName:"li"},"ActiveMQ JMX")," Centreon Monitoring Connector from the ",(0,a.kt)("strong",{parentName:"li"},"Configuration > Monitoring Connectors Manager")," page"))),(0,a.kt)(o.Z,{value:"Offline License",label:"Offline License",mdxType:"TabItem"},(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Install the Plugin on every poller expected to monitor ActiveMQ resources:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yum install centreon-plugin-Applications-ActiveMQ-Jmx\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Install the Centreon Monitoring Connector RPM on the Centreon Central server:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"centreon-pack-applications-activemq-jmx.noarch\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"On the Centreon Web interface, install the ",(0,a.kt)("em",{parentName:"li"},"ActiveMQ JMX")," Centreon Monitoring Connector from the ",(0,a.kt)("strong",{parentName:"li"},"Configuration > Monitoring Connectors Manager")," page")))),(0,a.kt)("h2",{id:"configuration"},"Configuration"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},'Log into Centreon and add a new Host through "Configuration > Hosts".'),(0,a.kt)("li",{parentName:"ul"},"Apply the ",(0,a.kt)("em",{parentName:"li"},"App-Activemq-JMX-custom")," template to the Host and configure all of the Macros marked as mandatory :")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"left"},"Mandatory"),(0,a.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,a.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"X"),(0,a.kt)("td",{parentName:"tr",align:"left"},"JOLOKIAURL"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Jolokia URL (eg: ",(0,a.kt)("inlineCode",{parentName:"td"},"http://myactivemq.centreon.com:8161/api/jolokia"),")")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"X"),(0,a.kt)("td",{parentName:"tr",align:"left"},"JOLOKIAUSERNAME"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Jolokia user name")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"X"),(0,a.kt)("td",{parentName:"tr",align:"left"},"JOLOKIAPASSWORD"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Jolokia password")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"}),(0,a.kt)("td",{parentName:"tr",align:"left"},"JOLOKIAEXTRAOPTIONS"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Any extra option you may want to add to the command (eg. a --verbose flag)")))),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"It is recommended to use the discovery module to add the monitoring of your *Brokers",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"\nGo to "),"Configuration > Services > Scan* to perform a scan and easily add the discovered resources"))),(0,a.kt)("h2",{id:"faq"},"FAQ"),(0,a.kt)("h3",{id:"how-can-i-test-the-plugin-in-the-command-line-interface-and-what-do-the-main-options-mean"},"How can I test the Plugin in the command line interface and what do the main options mean?"),(0,a.kt)("p",null,"Once the Plugin installed, you can test it directly from the command line of the Centreon poller using the ",(0,a.kt)("em",{parentName:"p"},"centreon-engine")," user:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"/usr/lib/centreon/plugins/centreon_activemq_jmx.pl \\\n  --plugin apps::mq::activemq::jmx::plugin \\\n  --mode='brokers' \\\n  --url='http://myactivemq.int.centreon.com:8161/api/jolokia' \\\n  --username='admin' \\\n  --password='admin' \\\n")),(0,a.kt)("p",null,"This command will check all the Brokers (",(0,a.kt)("inlineCode",{parentName:"p"},"--mode='brokers'"),") of the ActiveMQ server of the ",(0,a.kt)("inlineCode",{parentName:"p"},"myactivemq.int.centreon.com")," server. The RestAPI endpoint is set on the ",(0,a.kt)("inlineCode",{parentName:"p"},"http://myactivemq.int.centreon.com:8161/api/jolokia")," URL\n(",(0,a.kt)("inlineCode",{parentName:"p"},"--url='http://myactivemq.int.centreon.com:8161/api/jolokia'"),").\nTo authenticate against the Jolokia agent, the API username ",(0,a.kt)("em",{parentName:"p"},"admin")," is used with the relevant password (",(0,a.kt)("inlineCode",{parentName:"p"},"--username='admin' --password='admin'"),")."),(0,a.kt)("p",null,"If everything's fine, it should output something similar to:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"OK: Broker 'localhost' store usage: 0.00 %, temporary usage: 0.00 %, memory usage: 0.00 % - \nqueue 'foo.bar' average time messages remained enqueued: 0.000 ms, consumers connected: 0, producers connected: 0, memory usage: 0.00 %, \nqueue size: 1, messages enqueued: 0, messages dequeued: 0, messages expired: 0, messages in-flighted: 0, average messages size: 1.09 KB - All topics are ok | \n'localhost#Broker.store.usage.percentage'=0.00%;;;0;100 'localhost#Broker.temporary.usage.percentage'=0.00%;;;0;100 'localhost#Broker.memory.usage.percentage'=0.00%;;;0;100\n")),(0,a.kt)("p",null,"The available thresholds as well as all of the options that can be used with this Plugin can be displayed by adding the ",(0,a.kt)("inlineCode",{parentName:"p"},"--help")," parameter to the command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"/usr/lib/centreon/plugins/centreon_activemq_jmx.pl \\\n  --plugin apps::mq::activemq::jmx::plugin \\\n  --mode Brokers \\\n  --help\n")),(0,a.kt)("p",null,"You can display all of the modes that come with the Plugin with the command below:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"/usr/lib/centreon/plugins/centreon_activemq_jmx.pl \\\n  --plugin apps::mq::activemq::jmx::plugin \\\n  --list-mode\n")),(0,a.kt)("h3",{id:"why-do-i-get-the-following-error"},"Why do I get the following error:"),(0,a.kt)("h4",{id:"unknown-protocol-issue-error-while-fetching-httpmyactivemqintcentreoncom8161urlpath"},"UNKNOWN: protocol issue: Error while fetching ",(0,a.kt)("inlineCode",{parentName:"h4"},"http://myactivemq.int.centreon.com:8161/url/path")),(0,a.kt)("p",null,"This error message means that the Plugin failed to request the API. Check your credentials."),(0,a.kt)("h4",{id:"unknown-jmx-request-cant-get-a-single-value"},"UNKNOWN: JMX Request: Cant get a single value."),(0,a.kt)("p",null,"This error message means that the Plugin failed to get the value from the API. Check the URL path."),(0,a.kt)("h4",{id:"unknown-protocol-issue-javalangexception--origin-null-is-not-allowed-to-call-this-agent"},"UNKNOWN: protocol issue: java.lang.Exception : Origin null is not allowed to call this agent"),(0,a.kt)("p",null,"The default Jolokia configuration in ActiveMQ doesn't allow the Cross-Origin Resource Sharing (CORS) method.\nYou can disable this method by editing the jolokia-access.xml file and remove the tag ",(0,a.kt)("inlineCode",{parentName:"p"},"<strict-checking/>"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"<cors>\n <strict-checking/>\n</cors>\n")),(0,a.kt)("p",null,"Restart your ActiveMQ server afterwards for the changes to be applied."))}h.isMDXComponent=!0}}]);