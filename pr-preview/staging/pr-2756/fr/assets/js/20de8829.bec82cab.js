"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[23965],{13762:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>g,frontMatter:()=>l,metadata:()=>u,toc:()=>d});n(67294);var r=n(3905);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function i(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}const l={id:"concepts",title:"Concepts"},o=void 0,u={unversionedId:"reporting/concepts",id:"version-23.10/reporting/concepts",title:"Concepts",description:"Disponibilit\xe9 et \xe9v\xe8nements",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-23.10/reporting/concepts.md",sourceDirName:"reporting",slug:"/reporting/concepts",permalink:"/centreon-documentation/pr-preview/staging/pr-2756/fr/docs/reporting/concepts",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/i18n/fr/docusaurus-plugin-content-docs/version-23.10/reporting/concepts.md",tags:[],version:"23.10",lastUpdatedAt:1699633150,formattedLastUpdatedAt:"10 nov. 2023",frontMatter:{id:"concepts",title:"Concepts"},sidebar:"version-23.10/docs",previous:{title:"Configurer",permalink:"/centreon-documentation/pr-preview/staging/pr-2756/fr/docs/reporting/configure"},next:{title:"D\xe9v. de rapport",permalink:"/centreon-documentation/pr-preview/staging/pr-2756/fr/docs/reporting/report-development"}},p={},d=[{value:"Disponibilit\xe9 et \xe9v\xe8nements",id:"disponibilit\xe9-et-\xe9v\xe8nements",level:2},{value:"Disponibilit\xe9",id:"disponibilit\xe9",level:3},{value:"H\xf4tes",id:"h\xf4tes",level:4},{value:"Services",id:"services",level:4},{value:"Ev\xe8nements",id:"ev\xe8nements",level:3},{value:"Indicateurs suppl\xe9mentaires",id:"indicateurs-suppl\xe9mentaires",level:3},{value:"Bonnes pratiques",id:"bonnes-pratiques",level:2},{value:"Bonnes pratiques de supervision",id:"bonnes-pratiques-de-supervision",level:3},{value:"Qualit\xe9 des plugins &amp; donn\xe9es",id:"qualit\xe9-des-plugins--donn\xe9es",level:4},{value:"Unit\xe9 par d\xe9faut",id:"unit\xe9-par-d\xe9faut",level:4},{value:"Bonnes pratiques de configuration",id:"bonnes-pratiques-de-configuration",level:3},{value:"Groupes d&#39;h\xf4tes et cat\xe9gories",id:"groupes-dh\xf4tes-et-cat\xe9gories",level:3},{value:"Cat\xe9gories de Service",id:"cat\xe9gories-de-service",level:3},{value:"ETL",id:"etl",level:2},{value:"Gestion de l&#39;historique des changements",id:"gestion-de-lhistorique-des-changements",level:3},{value:"Modes d&#39;ex\xe9cution",id:"modes-dex\xe9cution",level:3},{value:"Performance",id:"performance",level:4},{value:"Options d&#39;ex\xe9cution",id:"options-dex\xe9cution",level:4},{value:"Purge automatique des donn\xe9es",id:"purge-automatique-des-donn\xe9es",level:3},{value:"Comment appliquer la derni\xe8re configuration Centreon aux donn\xe9es de reporting ?",id:"comment-appliquer-la-derni\xe8re-configuration-centreon-aux-donn\xe9es-de-reporting-",level:3},{value:"Importer la derni\xe8re configuration de Centreon",id:"importer-la-derni\xe8re-configuration-de-centreon",level:4},{value:"Calculer les dimensions de reporting",id:"calculer-les-dimensions-de-reporting",level:4},{value:"Agr\xe9gation des \xe9v\xe9nements et de la disponibilit\xe9",id:"agr\xe9gation-des-\xe9v\xe9nements-et-de-la-disponibilit\xe9",level:4},{value:"Agr\xe9gation des donn\xe9es de performance (stockage, traffic etc.. )",id:"agr\xe9gation-des-donn\xe9es-de-performance-stockage-traffic-etc-",level:4},{value:"Comment reprendre partiellement les donn\xe9es de reporting ?",id:"comment-reprendre-partiellement-les-donn\xe9es-de-reporting-",level:3},{value:"Pr\xe9-requis",id:"pr\xe9-requis",level:4},{value:"Importer les donn\xe9es manquantes",id:"importer-les-donn\xe9es-manquantes",level:4},{value:"Mettre \xe0 jour les dimensions de reporting",id:"mettre-\xe0-jour-les-dimensions-de-reporting",level:4},{value:"Reconstruire les \xe9v\xe8nements manquants et les donn\xe9es de disponibilit\xe9",id:"reconstruire-les-\xe9v\xe8nements-manquants-et-les-donn\xe9es-de-disponibilit\xe9",level:4},{value:"Importer et reconstruire les donn\xe9es de performance manquantes",id:"importer-et-reconstruire-les-donn\xe9es-de-performance-manquantes",level:4},{value:"Que faire apr\xe8s l&#39;ex\xe9cution des scripts ?",id:"que-faire-apr\xe8s-lex\xe9cution-des-scripts-",level:4},{value:"Statistiques de Centreon BAM",id:"statistiques-de-centreon-bam",level:3},{value:"Comment calculer uniquement les donn\xe9es de Centile",id:"comment-calculer-uniquement-les-donn\xe9es-de-centile",level:3}],c={toc:d},m="wrapper";function g(e){var{components:t}=e,l=i(e,["components"]);return(0,r.kt)(m,a(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){s(e,t,n[t])}))}return e}({},c,l),{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"disponibilit\xe9-et-\xe9v\xe8nements"},"Disponibilit\xe9 et \xe9v\xe8nements"),(0,r.kt)("p",null,"Les donn\xe9es de disponibilit\xe9 et d'\xe9v\xe8nements correspondent aux donn\xe9es\nli\xe9es au changement d'\xe9tat des h\xf4tes et des services supervis\xe9s par\nCentreon. Elles sont exploit\xe9es dans les mod\xe8les de rapports et widgets\nde disponibilit\xe9 et d'\xe9v\xe8nements propos\xe9s par Centreon MBI."),(0,r.kt)("p",null,"Aucun pr\xe9-requis n'est exig\xe9 pour que les rapports exploitant ces\nnotions soient fonctionnels. Il suffit de disposer de plugin renvoyant\nun statut. Pour que vous puissiez exploiter et analyser ce que ces\nrapports remontent, il est important que vous compreniez certaines\nnotions et r\xe8gles de calculs."),(0,r.kt)("h3",{id:"disponibilit\xe9"},"Disponibilit\xe9"),(0,r.kt)("h4",{id:"h\xf4tes"},"H\xf4tes"),(0,r.kt)("p",null,"Un h\xf4te est dit disponible s'il est dans un \xe9tat \xab Up \xbb"),(0,r.kt)("p",null,"Le calcul du taux de disponibilit\xe9 pr\xe9sent dans les rapports est le\nsuivant : Dur\xe9e \xab Up \xbb / ( Dur\xe9e \xab UP \xbb + Dur\xe9e \xab Down \xbb)."),(0,r.kt)("p",null,"R\xe8gles suppl\xe9mentaires :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Le temps pass\xe9 dans l'\xe9tat \xab Unreacheable\xbb n'est pas pris en compte\ndans le calcul de la disponibilit\xe9,"),(0,r.kt)("li",{parentName:"ul"},"Le temps pass\xe9 \xab maintenance programm\xe9e (Downtime) \xbb n'est pas pris\nen compte dans le calcul de la disponibilit\xe9.")),(0,r.kt)("p",null,"Exemple : Pour un rapport sur 1 journ\xe9e, si un h\xf4te est disponible 23h\net indisponible 1h sur les 24h th\xe9orique, sa disponibilit\xe9 sera donc 23h\n/ (23+1) ~ 95,8%."),(0,r.kt)("h4",{id:"services"},"Services"),(0,r.kt)("p",null,"Un service est dit disponible s'il est dans un \xe9tat \xab OK \xbb ou \xab Warning\n\xbb."),(0,r.kt)("p",null,"Le calcul du taux de disponibilit\xe9 d'un service est le suivant : (dur\xe9e\n\xab OK \xbb + \xab Warning \xbb) / ( dur\xe9e \xab OK \xbb + \xab Warning \xbb + \xab Critical \xbb)."),(0,r.kt)("p",null,"R\xe8gles suppl\xe9mentaires :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Le temps pass\xe9 dans l'\xe9tat \xab Unknown\xbb n'est pas pris en compte dans\nle calcul de la disponibilit\xe9,"),(0,r.kt)("li",{parentName:"ul"},"Le temps pass\xe9 \xab maintenance programm\xe9e (Downtime) \xbb n'est pas pris\nen compte dans le calcul de la disponibilit\xe9.")),(0,r.kt)("h3",{id:"ev\xe8nements"},"Ev\xe8nements"),(0,r.kt)("p",null,"Seuls les \xe9v\xe8nements ",(0,r.kt)("strong",{parentName:"p"},"confirm\xe9s"),' sont pris en compte dans le calcul\ndes \xe9v\xe8nements. Cela correspond \xe0 l\'\xe9tat "Hard" dans Centreon.'),(0,r.kt)("p",null,"Dans les rapports, diff\xe9rentes notions sont affich\xe9es lorsqu'on parle\nd'\xe9v\xe8nements, ils peuvent \xeatre de type :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Exception : cela correspond \xe0 un \xe9tat \xab Down\xbb pour un h\xf4te et un\n\xe9tat \xab Critical \xbb pour un service,"),(0,r.kt)("li",{parentName:"ul"},"Avertissement : cela correspond \xe0 un \xe9tat \xab Warning \xbb pour les\nservices, il n'y a pas d'\xe9quivalent pour les h\xf4tes,"),(0,r.kt)("li",{parentName:"ul"},"Information : tout autre \xe9tat.")),(0,r.kt)("p",null,"Un \xe9v\xe8nement sur un h\xf4te ou un service est caract\xe9ris\xe9 par 3 \xe9l\xe9ments :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Une date de d\xe9but,"),(0,r.kt)("li",{parentName:"ul"},"Une date de fin,"),(0,r.kt)("li",{parentName:"ul"},"Un \xe9tat.")),(0,r.kt)("h3",{id:"indicateurs-suppl\xe9mentaires"},"Indicateurs suppl\xe9mentaires"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"MTRS (Mean Time To Restore Service) correspond \xe0 la Maintenabilit\xe9 :\nc'est le temps moyen de dur\xe9e des pannes. Cet indicateur doit \xeatre\nle plus faible possible."),(0,r.kt)("li",{parentName:"ul"},"MTBF (Mean Time Between Failure) correspond \xe0 la Fiabilit\xe9 : c'est\nle temps moyen entre la fin d'un incident et le d\xe9but du suivant.\nCet indicateur doit \xeatre le plus \xe9lev\xe9 possible."),(0,r.kt)("li",{parentName:"ul"},"MTBSI (Mean Time Between Service Incident) : c'est le temps moyen\nentre le d\xe9but de deux incidents. Cet indicateur doit \xeatre le plus\n\xe9lev\xe9 possible")),(0,r.kt)("p",null,"Le sch\xe9ma ci-dessous permet de se rendre compte de la port\xe9e de ces\nindicateurs :"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(6100).Z,width:"2160",height:"662"})),(0,r.kt)("h2",{id:"bonnes-pratiques"},"Bonnes pratiques"),(0,r.kt)("h3",{id:"bonnes-pratiques-de-supervision"},"Bonnes pratiques de supervision"),(0,r.kt)("h4",{id:"qualit\xe9-des-plugins--donn\xe9es"},"Qualit\xe9 des plugins & donn\xe9es"),(0,r.kt)("p",null,"Pour \xeatre en mesure d'avoir des rapports sur les donn\xe9es de performance\nen utilisant les rapports par d\xe9faut de Centreon MBI, vous devez au\nmoins superviser quelques indicateurs de performance de base\n(m\xe9triques)\xa0:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"CPU : doit retourner un pourcentage d'une ou plusieurs m\xe9triques\n(cpu_total, cpu_sys, cpu_1...) et 100 comme valeur maximum.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Memory : doit retourner au moins une m\xe9trique comportant ces\ninformations :"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"L'utilisation m\xe9moire\xa0: Cette valeur doit \xeatre en octets")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Le seuil d'alerte d'utilisation m\xe9moire")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Le seuil critique d'utilisation m\xe9moire")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"La m\xe9moire totale allou\xe9e\xa0en octet\xa0"),(0,r.kt)("p",{parentName:"li"},"Le plugin utilis\xe9 pour superviser cet indicateur doit renvoyer la sortie suivante:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"*any status information* | **$metric_name=$value$unit;$warning_threshold;critical_threshold;$min_value;$max_value**\n"))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Utilisation d'espace disque: Deux types de service possibles :"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Superviser une partition par service (les m\xe9triques sont souvent\nnomm\xe9es \xab\xa0used\xa0\xbb et \xab\xa0size\xa0\xbb")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Superviser plusieurs partitions par service et chaque m\xe9trique\ncorrespond au nom d'une partition."),(0,r.kt)("p",{parentName:"li"},"Dans les deux cas, les donn\xe9es de performance renvoy\xe9es par les\nplugins doivent correspondre \xe0 ce format\xa0:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"*any status information* | **$metric_name=$value$unit;$warning_threshold;$critical_threshold;$min_value;$max_value**\n"))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Donn\xe9es de trafic : les rapports standards utilisent une metrique\npour le trafic entrant et une metrique pour le trafic sortant. Pour\n\xeatre compatible, vos plugins doivent renvoyer \xe9galement deux\nm\xe9triques (peu importe leurs noms). Il est \xe9galement important que\npour chaque m\xe9trique, la valeur maximum atteignable soit pr\xe9sente.\nLe format du plugin est donc le m\xeame que conseill\xe9 ci-dessus :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"any status information | $inboundTrafic=$value$unit;$warning_threshold;$critical_threshold;$min_value;$max_value $outBoundTrafic=...\n")))),(0,r.kt)("h4",{id:"unit\xe9-par-d\xe9faut"},"Unit\xe9 par d\xe9faut"),(0,r.kt)("p",null,"Il est important de s'assurer que les unit\xe9s des donn\xe9es renvoy\xe9es par\nles plugins soient communes \xe0 tous les services pour un m\xeame type de\ndonn\xe9es. Nous conseillons donc fortement de v\xe9rifier que les plugins\nrenvoient les donn\xe9es dans les unit\xe9s suivantes\xa0:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Temps: secondes"),(0,r.kt)("li",{parentName:"ul"},"Trafic: bits/sec"),(0,r.kt)("li",{parentName:"ul"},"Stockage: Octets"),(0,r.kt)("li",{parentName:"ul"},"M\xe9moire/Swap: Octets")),(0,r.kt)("h3",{id:"bonnes-pratiques-de-configuration"},"Bonnes pratiques de configuration"),(0,r.kt)("p",null,"Chaque mod\xe8le de rapport dans Centreon MBI prend en compte plusieurs\nparam\xe8tres qui permettent de g\xe9n\xe9rer des rapports adapt\xe9s \xe0 vos besoins."),(0,r.kt)("p",null,"Plusieurs types de param\xe8tres sont disponibles pour chaque mod\xe8le :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Un objet principal sur lequel le rapport est g\xe9n\xe9r\xe9. Cela peut\n\xeatre\xa0:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Un h\xf4te"),(0,r.kt)("li",{parentName:"ul"},"Un groupe d'h\xf4tes : groupe fonctionnel d\xe9fini dans Centreon\nafin de classer les h\xf4tes par client, application, domaine\nd'activit\xe9 strat\xe9gique, pays, ..."),(0,r.kt)("li",{parentName:"ul"},"Plusieurs groupes d'h\xf4tes"))),(0,r.kt)("li",{parentName:"ul"},"Une p\xe9riode temporelle (ou \xab\xa0plage horaire\xa0\xbb ) sur laquelle les\nstatistiques seront calcul\xe9es."),(0,r.kt)("li",{parentName:"ul"},"Des filtres pour prendre en compte seulement des types sp\xe9cifiques\nd'\xe9quipements, des services ou des m\xe9triques dans les groupes\nd'h\xf4tes s\xe9lectionn\xe9s\xa0:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Cat\xe9gories d'h\xf4tes : Permet de classer les h\xf4tes dans des\ngroupes techniques afin de d\xe9terminer le type ou la fonction\nd'un h\xf4te\xa0; Par exemple : serveurs Linux, serveurs Windows,\nrouteurs cisco, imprimantes, ..."),(0,r.kt)("li",{parentName:"ul"},"Cat\xe9gories de services : Permet de d\xe9finir le type d'un service\n: CPU, m\xe9moire, stockage, ..."),(0,r.kt)("li",{parentName:"ul"},"M\xe9triques : Donn\xe9es de performances collect\xe9es par les services\n(indicateurs de supervision). Un service de supervision peut\ncollecter plusieurs m\xe9triques. Cependant les noms des m\xe9triques\net les unit\xe9s ne sont pas normalis\xe9s (par exemple : un service\nde type CPU peut collecter seulement une m\xe9trique nomm\xe9e\n'cpu_average' d\xe9finie en pourcentage et un autre service de\ntype CPU peut collecter une m\xe9trique par c\u0153ur de processeur\nconfigur\xe9 dans l'\xe9quipement), il est donc n\xe9cessaire, \xe0 la\ng\xe9n\xe9ration du rapport, de s\xe9lectionner les m\xe9triques \xe0 prendre \xe0\ncompte pour le calcul des statistiques.")))),(0,r.kt)("h3",{id:"groupes-dh\xf4tes-et-cat\xe9gories"},"Groupes d'h\xf4tes et cat\xe9gories"),(0,r.kt)("p",null,"Les d\xe9finitions des groupes d'h\xf4tes et des cat\xe9gories list\xe9es\nci-dessous sont donn\xe9es \xe0 partir des bonnes pratiques \xe9tablies par\nCentreon."),(0,r.kt)("p",null,"Cependant, les groupes et les cat\xe9gories que vous allez cr\xe9er doivent\ncorrespondre \xe0 vos besoins."),(0,r.kt)("p",null,"Exemple :"),(0,r.kt)("p",null,"Si vous avez besoin de mettre en \xe9vidence le nombre d'alertes g\xe9n\xe9r\xe9es\npar domaines d'activit\xe9 de votre SI avec une r\xe9partition par type\nd'\xe9quipement, il sera n\xe9cessaire de d\xe9finir des groupes et et des\ncat\xe9gories d'h\xf4tes de la mani\xe8re suivante\xa0:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Groupe d'h\xf4tes : ",(0,r.kt)("strong",{parentName:"li"},"Databases"),", Applications, Security, Network,\nMail ..."),(0,r.kt)("li",{parentName:"ul"},"Cat\xe9gorie d'h\xf4tes : DB2-Servers, MySQL-Servers, Oracle-Servers,\nSQL-Servers ...")),(0,r.kt)("p",null,"Voici un exemple de statistiques que vous pourriez obtenir en utilisant\nces groupes et cat\xe9gories :"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(36702).Z,width:"711",height:"338"})),(0,r.kt)("p",null,"Le groupe d'h\xf4te est le premier axe d'analyse. La cat\xe9gorie d'h\xf4te\npermet d'analyser les statistiques en sous-domaines."),(0,r.kt)("p",null,"De la m\xeame mani\xe8re, nous pouvons analyser les statistiques en se basant\nsur les dimensions suivantes\xa0:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Par pays (groupe d'h\xf4te) avec une r\xe9partition des donn\xe9es par type\nd'\xe9quipement r\xe9seau (cat\xe9gorie d'h\xf4tes)"),(0,r.kt)("li",{parentName:"ul"},"Par pays (groupe d'h\xf4te) avec une r\xe9partition des donn\xe9es par\nclient (cat\xe9gorie d'h\xf4te)"),(0,r.kt)("li",{parentName:"ul"},"Par client (groupe d'h\xf4te) avec une r\xe9partition des donn\xe9es par\npays (cat\xe9gorie d'h\xf4te)"),(0,r.kt)("li",{parentName:"ul"},"Par client (groupe d'h\xf4te) avec une r\xe9partition des donn\xe9es par\nserveur d'application (cat\xe9gorie d'h\xf4te)"),(0,r.kt)("li",{parentName:"ul"},"...")),(0,r.kt)("p",null,"Il n'existe pas de r\xe8gles standards pour d\xe9finir des groupes d'h\xf4tes\nou des cat\xe9gories. Cela doit \xeatre adapt\xe9 \xe0 vos besoins."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Comment cr\xe9er ces cat\xe9gories et groupes?")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"La relation entre les h\xf4tes et les groupes d'h\xf4tes est faite \xe0\npartir du menu ",(0,r.kt)("em",{parentName:"li"},"Configuration > Hosts > Host groups")," sur\nl'interface de Centreon. Il est \xe9galement possible d'utiliser\nl'onglet ",(0,r.kt)("em",{parentName:"li"},"Relation")," pr\xe9sent dans le formulaire\nd'ajout/modification d'un h\xf4te."),(0,r.kt)("li",{parentName:"ul"},"La relation entre un h\xf4te et une cat\xe9gorie d'h\xf4te est faite \xe0\npartir du menu ",(0,r.kt)("em",{parentName:"li"},"Configuration > Hosts > Categories")," sur\nl'interface de Centreon. Il est \xe9galement possible d'utiliser\nl'onglet ",(0,r.kt)("em",{parentName:"li"},"Relation")," pr\xe9sent dans le formulaire\nd'ajout/modification d'un h\xf4te.")),(0,r.kt)("h3",{id:"cat\xe9gories-de-service"},"Cat\xe9gories de Service"),(0,r.kt)("p",null,"Les cat\xe9gories de services permettent d'organiser les services\n(indicateurs de supervision) en sous-domaines. L'usage le plus commun\ndes cat\xe9gories de services est de d\xe9finir des cat\xe9gories bas\xe9es sur des\ntypes de services\xa0: CPU, m\xe9moire, stockage, processus Oracle, DNS,\nprocessus Websphere, ..."),(0,r.kt)("p",null,"Ce genre de configuration permet, par exemple, de\xa0:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Comparer le nombre d'alertes g\xe9n\xe9r\xe9es pour chaque type de services"),(0,r.kt)("li",{parentName:"ul"},"S\xe9lectionner la cat\xe9gorie de service qui indique l'utilisation\nd'espace disque quand vous souhaitez g\xe9n\xe9rer un rapport de\ncapacit\xe9.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Comme les groupes d'h\xf4tes et les cat\xe9gories d'h\xf4tes, les cat\xe9gories\nde service doivent \xeatre d\xe9finies selon vos besoins.")),(0,r.kt)("p",null,"Par exemple\xa0: Si vous avez besoin d'analyser l'espace disque allou\xe9 et\nutilis\xe9 par un SGDB ou par un type d'application, vous devez cr\xe9er\nplusieurs cat\xe9gories de services. A la place d'utiliser une seule\ncat\xe9gorie nomm\xe9e \xab\xa0Stockage\xa0\xbb ou \xab\xa0Disque\xa0\xbb nous aurons\xa0:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\xab\xa0Operating system\xa0\xbb : contenant les espaces de stockage de type\nsyst\xe8me"),(0,r.kt)("li",{parentName:"ul"},"\xab\xa0Oracle\xa0\xbb : contenant les espaces de stockage des serveurs Oracle"),(0,r.kt)("li",{parentName:"ul"},"\xab\xa0SQL Server\xa0\xbb : les espaces de stockage des serveur SQL")),(0,r.kt)("p",null,"Voici un exemple de statistiques que vous pourriez obtenir en utilisant\nces cat\xe9gories de services :"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(16455).Z,width:"680",height:"271"})),(0,r.kt)("p",null,"La relation entre les services et leurs cat\xe9gories peut \xeatre faite \xe0\npartir de menu ",(0,r.kt)("em",{parentName:"p"},"Configuration > Services > Categories")," sur\nl'interface de Centreon. Il est \xe9galement possible d'utiliser\nl'onglet ",(0,r.kt)("em",{parentName:"p"},"Relation")," pr\xe9sent dans le formulaire d'ajout/modification\nd'un service."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Il est fortement conseill\xe9 de g\xe9rer les cat\xe9gories de service en\nutilisant uniquement les mod\xe8les de services.")),(0,r.kt)("h2",{id:"etl"},"ETL"),(0,r.kt)("h3",{id:"gestion-de-lhistorique-des-changements"},"Gestion de l'historique des changements"),(0,r.kt)("p",null,"Centreon MBI enregistre chaque changement qui concernent les relations\nentre les h\xf4tes, les services, les groupes et les cat\xe9gories."),(0,r.kt)("p",null,"Par exemple :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Un h\xf4te \xab\xa0H1\xa0\xbb appartient \xe0 un groupe d'h\xf4tes \xab\xa0G1\xa0\xbb en janvier\n2012\xa0"),(0,r.kt)("li",{parentName:"ul"},"L'h\xf4te \xab\xa0H1\xa0\xbb n'appartient plus au groupe \xab\xa0G1\xa0\xbb le 1er f\xe9vrier\n2012"),(0,r.kt)("li",{parentName:"ul"},"Apr\xe8s ce changement, si un rapport est g\xe9n\xe9r\xe9 pour le groupe \xab\xa0G1\xa0\xbb\nsur la p\xe9riode de reporting de janvier 2012, les statistiques de\nl'h\xf4te \xab\xa0H1\xa0\xbb seront prises en compte dans les statistiques du\ngroupe \xab\xa0G1\xa0\xbb"),(0,r.kt)("li",{parentName:"ul"},"Les statistiques de l'h\xf4te \xab\xa0H1\xa0\xbb ne seront pas prises en compte\npour le groupe \xab\xa0G1\xa0\xbb si la p\xe9riode de rapport s\xe9lectionn\xe9e est\nf\xe9vrier 2012"),(0,r.kt)("li",{parentName:"ul"},"Si la p\xe9riode de rapport d\xe9marre le 15 janvier et finit le 15\nf\xe9vrier, les statistiques de l'h\xf4te \xab\xa0H1\xa0\xbb seront int\xe9gr\xe9es \xe0 celle\ndu groupe \xab\xa0G1\xa0\xbb seulement du 15 janvier au 31 janvier")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"La configuration initiale de Centreon et la relation entre les objets\ndoivent \xeatre clairement d\xe9finis avant l'installation de Centreon MBI\nsur une plate-forme de production. Chaque modification de configuration\nd'un h\xf4te, groupe ou cat\xe9gorie est consid\xe9r\xe9e comme une \xe9volution\nnormale dans le cycle de vie de l'objet.")),(0,r.kt)("h3",{id:"modes-dex\xe9cution"},"Modes d'ex\xe9cution"),(0,r.kt)("p",null,"La base de donn\xe9es de reporting ou \xab Data Warehouse \xbb est mise \xe0 jour\ntous les jours avec les donn\xe9es agr\xe9g\xe9es par l'ETL. En fonction de la\ntaille du p\xe9rim\xe8tre supervis\xe9, cela peut repr\xe9senter de quelques\nmilliers \xe0 plusieurs millions de lignes par jour. De ce fait, la base de\ndonn\xe9es de reporting et l'ETL sont deux composants critiques de Centreon\nMBI que vous devez comprendre. ",(0,r.kt)("strong",{parentName:"p"},"Deux modes")," de fonctionnement sont\ndisponibles pour l'ETL:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Daily mode")," ou mode journalier : C'est le fonctionnement normal\nde l'ETL lorsque la plateforme de reporting est en place. Les\ndonn\xe9es de Centreon sont import\xe9es tous les jours, de mani\xe8re\ndiff\xe9rentielle. Plus pr\xe9cisemment:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},'les donn\xe9es de la table "data_bin" de la veille sont import\xe9es\net les calculs ne se font que sur ces donn\xe9es'),(0,r.kt)("li",{parentName:"ul"},"toutes les donn\xe9es des tables ",(0,r.kt)("em",{parentName:"li"},"servicestatevents")," et\n",(0,r.kt)("em",{parentName:"li"},"hoststateevents")," sont import\xe9es mais les calculs se font de\nmani\xe8re diff\xe9rentielle")))),(0,r.kt)("p",null,"Elles sont ensuite agr\xe9g\xe9es puis ins\xe9r\xe9es dans le datawarehouse. Cela\npeut prendre de quelques secondes \xe0 quelques minutes en fonction du\np\xe9rim\xe8tre de monitoring."),(0,r.kt)("p",null,"Le mode journalier est configur\xe9 comme un cron que vous pouvez\nconsulter dans ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/cron.d/centreon-bi-engine"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"30 4 * * * root /usr/share/centreon-bi/bin/centreonBIETL --daily >> /var/log/centreon-bi/centreonBIETL.log 2>&1\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Important")),(0,r.kt)("p",{parentName:"blockquote"},"Ne lancez pas le calcul en mode journalier plusieurs fois dans la m\xeame\njourn\xe9e au risque d'obtenir des donn\xe9es dupliqu\xe9es.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Rebuild mode")," ou mode de reconstruction: C'est le mode souvent\nutilis\xe9 apr\xe8s l'installation de la plateforme de reporting, en cas\nde corruption des donn\xe9es. Ce mode permet d'importer les donn\xe9es\nbrutes de Centreon et de recalculer toutes les statistiques sur une\np\xe9riode donn\xe9e ou en utilisant les param\xe8tres de r\xe9tention.")),(0,r.kt)("p",null,"Exemple:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/usr/share/centreon-bi/bin/centreonBIETL -r\n")),(0,r.kt)("p",null,"Afin d'obtenir des temps d'ex\xe9cution raisonnables, la configuration\nmat\xe9rielle, l'espace de stockage disponible et les optimisations MariaDB\ndoivent avoir \xe9t\xe9 bien positionn\xe9s lors de l'installation."),(0,r.kt)("p",null,"Toutes les recommandations mat\xe9rielles, logicielles et\nd'optimisations peuvent \xeatre trouv\xe9es sur le site de documentation."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Il est fortement recommand\xe9 de mettre en place la supervision de l'ETL\nexpliqu\xe9 dans le chapitre \"Configuration avanc\xe9e\". Dans le cas ou\nl'ETL n'aurait pas fonctionn\xe9 pendant plusieurs jours ou que les\ndonn\xe9es brutes import\xe9es de Centreon n'\xe9taient pas \xe0 jour ou erron\xe9es,\nun processus de reconstruction partielle des donn\xe9es doit \xeatre ex\xe9cut\xe9.\nN'h\xe9sitez pas \xe0 contacter le Support afin d'\xeatre accompagn\xe9 dans ce\nprocessus. L'ETL ",(0,r.kt)("strong",{parentName:"p"},"ne r\xe9cup\xe8re pas automatiquement")," les jours qui\nn'ont pas \xe9t\xe9 calcul\xe9s.")),(0,r.kt)("h4",{id:"performance"},"Performance"),(0,r.kt)("p",null,"Si les traitements de l'ETL vous semblent anormalement longs, en mode\njournalier ou en mode reconstruction, veillez \xe0 optimiser votre serveur\nde reporting. Cela peut \xeatre fait en :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"am\xe9liorant la configuration MariaDB"),(0,r.kt)("li",{parentName:"ul"},"s'assurant de la bonne performance des disques (pas d'I/O wait par\nexemple)"),(0,r.kt)("li",{parentName:"ul"},"ajoutant de la m\xe9moire physique (+ optimisation MariaDB)"),(0,r.kt)("li",{parentName:"ul"},"veillant \xe0 ne pas mutualiser la base de donn\xe9es ni le stockage")),(0,r.kt)("h4",{id:"options-dex\xe9cution"},"Options d'ex\xe9cution"),(0,r.kt)("p",null,"Diff\xe9rentes options peuvent \xeatre pass\xe9es en param\xe8tre de l'ETL afin de\nlancer des actions sp\xe9cifiques d'import ou de reconstruction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"-c  Create the reporting database model\n-d  Daily execution to calculate statistics on yesterday\n-r  Rebuild mode to calculate statitics on a historical period. Can be used with:\n    Extra arguments for options -d and -r (if none of the following is specified, these one are selected by default: -IDEP):\n-I  Extract data from the monitoring server\n    Extra arguments for option -I:\n    -C  Extract only Centreon configuration database only. Works with option -I.\n    -i  Ignore perfdata extraction from monitoring server\n    -o  Extract only perfdata from monitoring server\n\n-D  Calculate dimensions\n-E  Calculate event and availability statistics\n-P  Calculate perfdata statistics\n    Common options for -rIDEP:\n    -s  Start date in format YYYY-MM-DD.\n        By default, the program uses the data retention period from Centreon MBI configuration\n    -e  End date in format YYYY-MM-DD.\n        By default, the program uses the data retention period from Centreon MBI configuration\n    -p  Do not empty statistic tables, delete only entries for the processed period.\n        Does not work on raw data tables, only on Centreon MBI statistics tables.\n")),(0,r.kt)("p",null,'Si les param\xe8tres "start" et "end" ne sont pas pr\xe9cis\xe9s, les dates\nde d\xe9but et fin pour chaque \xe9tape sont automatiquement calcul\xe9es en\nfonction de la r\xe9tention des donn\xe9es param\xe9tr\xe9es dans les options\ng\xe9n\xe9rales de l\'ETL.'),(0,r.kt)("h3",{id:"purge-automatique-des-donn\xe9es"},"Purge automatique des donn\xe9es"),(0,r.kt)("p",null,"Une purge des donn\xe9es peut \xeatre activ\xe9e dans les options g\xe9n\xe9rales\nCentreon MBI afin de s'assurer que le contenu de la base de reporting\nrespecte bien la configuration de la r\xe9tention. Ce m\xe9canisme doit \xeatre\nactiv\xe9 dans l'interface ET au niveau du cron\n/etc/cron.d/centreon-bi-purge ."),(0,r.kt)("p",null,"Les dimensions de reporting (combinaisons groupes / cat\xe9gories host /\nservices / metrics) sont automatiquement supprim\xe9es de la base si plus\naucune donn\xe9es n'est li\xe9 \xe0 la combinaison en question."),(0,r.kt)("h3",{id:"comment-appliquer-la-derni\xe8re-configuration-centreon-aux-donn\xe9es-de-reporting-"},"Comment appliquer la derni\xe8re configuration Centreon aux donn\xe9es de reporting ?"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Lorsque vous lancez cette proc\xe9dure, toutes les donn\xe9es d\xe9j\xe0 calcul\xe9es\nsont supprim\xe9es puis recalcul\xe9es en se basant sur la p\xe9riode de\nr\xe9tention. De plus toutes les relations pass\xe9es entre les objets seront\nsupprim\xe9es pour ne garder que la derni\xe8re.")),(0,r.kt)("p",null,"En p\xe9riode de mise en place de reporting, il est normal d'avoir \xe0\nrelancer les calculs des statistiques relativement souvent puisque la\nconfiguration dans Centreon est amen\xe9e \xe0 changer. Une fois le travail de\ngroupement / cat\xe9gorisation termin\xe9, lancer les commandes suivantes sur\nle serveur de ",(0,r.kt)("strong",{parentName:"p"},"REPORTING"),", de pr\xe9f\xe9rence le matin (cela peut prendre\nplusieurs heures). Cette proc\xe9dure n'inclut pas la reprise des donn\xe9es\nde logs et de m\xe9trologie brutes, assurez vous que les donn\xe9es provenant\nde Centreon sont \xe0 jour. Pour cela, ex\xe9cutez la commande suivante::"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/usr/share/centreon-bi/etl/centreonbiMonitoring.pl --db-content\n")),(0,r.kt)("p",null,"Et v\xe9rifiez que le message \"ETL OK - Database is up to date\" appara\xeet\nou qu'aucune de ces tables n'appara\xeet dans la liste :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"data_bin"),(0,r.kt)("li",{parentName:"ul"},"hoststatevents"),(0,r.kt)("li",{parentName:"ul"},"servicestateevents")),(0,r.kt)("p",null,"Les commandes d'agr\xe9gation propos\xe9es ci-dessous sont lanc\xe9es sans\npr\xe9cision de date de d\xe9but et fin, le calcul se basera alors sur la\nr\xe9tention configur\xe9e dans Centreon MBI. Si vous \xeates en p\xe9riode\nd'installation/test de Centreon MBI, vous pouvez modifier cette\nr\xe9tention AVANT le traitement pour la diminuer puis de la remettre par\nd\xe9faut (365 jours) APRES le traitement. Les calculs seront de ce fait\nplus rapides."),(0,r.kt)("p",null,"Se rendre \xe0 la page : Reporting > Business Intelligence > General\nOption | Onglet Data Retention Options"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(77203).Z,width:"1635",height:"633"})),(0,r.kt)("h4",{id:"importer-la-derni\xe8re-configuration-de-centreon"},"Importer la derni\xe8re configuration de Centreon"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/usr/share/centreon-bi/etl/importData.pl -r --centreon-only\n")),(0,r.kt)("h4",{id:"calculer-les-dimensions-de-reporting"},"Calculer les dimensions de reporting"),(0,r.kt)("p",null,"Cette commande supprime toutes les anciennes relations trac\xe9es dans le\nserveur de reporting pour n'appliquer que les derni\xe8res en date. Si vous\nsouhaitez garder les anciennes relations, remplacer ",(0,r.kt)("strong",{parentName:"p"},'"-r"')," par\n",(0,r.kt)("strong",{parentName:"p"},'"-d"'),".:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/usr/share/centreon-bi/etl/dimensionsBuilder.pl -r\n")),(0,r.kt)("h4",{id:"agr\xe9gation-des-\xe9v\xe9nements-et-de-la-disponibilit\xe9"},"Agr\xe9gation des \xe9v\xe9nements et de la disponibilit\xe9"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"nohup /usr/share/centreon-bi/etl/eventStatisticsBuilder.pl -r > /var/log/centreon-bi/rebuildAllEvents.log &\n")),(0,r.kt)("h4",{id:"agr\xe9gation-des-donn\xe9es-de-performance-stockage-traffic-etc-"},"Agr\xe9gation des donn\xe9es de performance (stockage, traffic etc.. )"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"nohup /usr/share/centreon-bi/etl/perfdataStatisticsBuilder.pl -r > /var/log/centreon-bi/rebuildAllPerf.log &\n")),(0,r.kt)("h3",{id:"comment-reprendre-partiellement-les-donn\xe9es-de-reporting-"},"Comment reprendre partiellement les donn\xe9es de reporting ?"),(0,r.kt)("p",null,"Cette proc\xe9dure vous est utile lorsque le plugin de monitoring donnant\nl'\xe9tat de la base de reporting vous remonte un \xe9tat non-OK. Cela peut\n\xeatre d\xfb \xe0 des probl\xe8mes rencontr\xe9s lors des traitements journaliers\n(donn\xe9es Centreon qui ne sont pas \xe0 jour, manque d'espace sur le\nserveur de reporting, traitements coup\xe9s manuellement etc..)."),(0,r.kt)("p",null,"Dans ce cas, le plugin de reporting renvoie que la base de donn\xe9es\nn'est pas \xe0 jour. Exemple du retour du plugin lorsque la base de\ndonn\xe9es n'est pas \xe0 jour : :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```shell\n/usr/share/centreon-bi/etl/centreonbiMonitoring.pl --db-content\n```\n\n```shell\n[Table mod_bam_reporting, last entry: 2015-07-01 00:00:00] [Table mod_bi_ba_incidents, last entry: 2015-07-01 00:00:00] [Table hoststateevents, last entry: 2015-07-01 00:00:00]\n[Table servicestateevents, last entry: 2015-07-01 00:00:00] [Table mod_bi_hoststateevents, last entry: 2015-07-01 00:00:00]\n[Table mod_bi_servicestateevents, last entry: 2015-07-01 00:00:00] [Table mod_bi_hostavailability, last entry: 2015-07-01 00:00:00]\n[Table mod_bi_serviceavailability, last entry: 2015-07-01 00:00:00] [Table data_bin, last entry: 2015-08-01 00:00:00] [Table mod_bi_metricdailyvalue, last entry: 2015-08-01 00:00:00]\n[Table mod_bi_metrichourlyvalue, last entry: 2015-08-01 23:00:00]\n```\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Si vous ne voyez que les tables ",(0,r.kt)("strong",{parentName:"p"},"mod",(0,r.kt)("em",{parentName:"strong"},"bi"))," cela signifie que le\nprobl\xe8me se situe uniquement sur les donn\xe9es agr\xe9g\xe9es et pas les\ndonn\xe9es provenant de Centreon."),(0,r.kt)("p",{parentName:"li"},"Dans ce cas, ",(0,r.kt)("strong",{parentName:"p"},'ignorez la partie "Importer les donn\xe9es\nmanquantes"')," dans la proc\xe9dure qui suit.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Si vous voyez \xe9galement les tables ci dessous, cela signifie qu'il\ny a un probl\xe8me avec les donn\xe9es import\xe9es de Centreon :"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"hoststatevents"),(0,r.kt)("li",{parentName:"ul"},"servicestateevents"),(0,r.kt)("li",{parentName:"ul"},"Les tables ",(0,r.kt)("strong",{parentName:"li"},"mod_bam_reporting*")," tables"),(0,r.kt)("li",{parentName:"ul"},"data_bin")),(0,r.kt)("p",{parentName:"li"},"Dans ce cas, vous devez vous assurer qu'il n'y a pas de probl\xe8me du\nc\xf4t\xe9 Centreon avant d'\xe9x\xe9cuter la proc\xe9dure suivante. Dans ce cas,\nex\xe9cutez la proc\xe9dure qui suit."))),(0,r.kt)("h4",{id:"pr\xe9-requis"},"Pr\xe9-requis"),(0,r.kt)("p",null,"Avant d'ex\xe9cuter les commandes de la proc\xe9dure, s'assurer que:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"La plateforme Centreon est saine et les donn\xe9es sont \xe0 jour dans la base de donn\xe9es"),(0,r.kt)("li",{parentName:"ul"},"Le script dataRetentionManager.pl n'est pas activ\xe9 sur le serveur\nde reporting ( c'est \xe0 dire comment\xe9 ) dans\n",(0,r.kt)("inlineCode",{parentName:"li"},"/etc/cron.d/centreon-bi-purge"),". Il faudra le r\xe9activer \xe0 la fin de la\nproc\xe9dure"),(0,r.kt)("li",{parentName:"ul"},"Le script centreonBIETL n'est pas activ\xe9 sur le serveur de reporting ( c'est \xe0 dire comment\xe9 ) dans\n",(0,r.kt)("inlineCode",{parentName:"li"},"/etc/cron.d/centreon-bi-engine"),". Il faudra le r\xe9activer \xe0 la fin de la proc\xe9dure"),(0,r.kt)("li",{parentName:"ul"},"La r\xe9tention est configur\xe9e sur l'interface Centreon BI et que la valeur configur\xe9e n'est pas sup\xe9rieure \xe0 1024 jours"),(0,r.kt)("li",{parentName:"ul"},"La r\xe9tention est activ\xe9e dans l'interface"),(0,r.kt)("li",{parentName:"ul"},"Les scripts pr\xe9sents dans ",(0,r.kt)("inlineCode",{parentName:"li"},"/etc/cron.d/centreon-bi-backup-reporting-server"),"\ndoivent \xeatre comment\xe9s. Il faudra les d\xe9-commenter \xe0 la fin de la\nproc\xe9dure")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},'Pour l\'ensemble des commandes list\xe9es ci-dessous, utiliser "screen" ou\n"nohup" car les temps d\'ex\xe9cution peuvent \xeatre tr\xe8s longs.'),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"$date_start$: doit \xeatre remplac\xe9 par la date de d\xe9but en accord avec le retour des scripts de diagnostic ou de la r\xe9tention"),(0,r.kt)("li",{parentName:"ul"},"$date_end$: \xe0 remplacer la plupart du temps par la date du jour"))),(0,r.kt)("h4",{id:"importer-les-donn\xe9es-manquantes"},"Importer les donn\xe9es manquantes"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Importer les donn\xe9es, sans les donn\xe9es de performance (table\ndata_bin), depuis une date ancienne correspondant \xe0 la r\xe9tention\nconfigur\xe9e dans Centreon MBI > Generation Option > Data Retention\nParameters, au niveau des param\xe8tre de r\xe9tention de la\ndisponibilit\xe9: :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"nohup /usr/share/centreon-bi/etl/importData.pl -r -s $date_start$ -e $date_end$ --ignore-databin > /var/log/centreon-bi/rebuild_importDataEvents.log &\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("em",{parentName:"p"},"Temps d'ex\xe9cution : (rapide) quelques minutes"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Importer les donn\xe9es de data_bin depuis la date des derni\xe8res\ndonn\xe9es pr\xe9sentes en base. Vous pouvez le savoir en v\xe9rifiant la\ndate \xe0 c\xf4t\xe9 de la table data_bin dans le retour du plugin :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"nohup /usr/share/centreon-bi/etl/importData.pl -r --no-purge --databin-only -s $date_start$ -e $date_end$ > /var/log/centreon-bi/rebuild_importDataBin.log &\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("em",{parentName:"p"},"Temps d'ex\xe9cution : (rapide) quelques minutes d\xe9pendant du nombre\nde jour \xe0 importer")))),(0,r.kt)("h4",{id:"mettre-\xe0-jour-les-dimensions-de-reporting"},"Mettre \xe0 jour les dimensions de reporting"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Mettre \xe0 jour les dimensions. L'option \"-d\" est utilis\xe9e pour\nconserver l'historique des changements de configuration, ne pas\nutiliser l'option \"-r\" ou vous seriez dans l'obligation de\nreconstruire toutes les statistiques :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"nohup /usr/share/centreon-bi/etl/dimensionsBuilder.pl -d > /var/log/centreon-bi/rebuild_dimensions.log &\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("em",{parentName:"p"},"Temps d'ex\xe9cution : (rapide) quelques secondes \xe0 quelques minutes")))),(0,r.kt)("h4",{id:"reconstruire-les-\xe9v\xe8nements-manquants-et-les-donn\xe9es-de-disponibilit\xe9"},"Reconstruire les \xe9v\xe8nements manquants et les donn\xe9es de disponibilit\xe9"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Reconstruire les \xe9v\xe8nements depuis une date ancienne correspondant \xe0\nla r\xe9tention configur\xe9e dans Centreon MBI > Generation Option >\nData Retention Parameters : :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"nohup /usr/share/centreon-bi/etl/eventStatisticsBuilder.pl -r --events-only  > /var/log/centreon-bi/rebuild_events.log &\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("em",{parentName:"p"},"Temps d'ex\xe9cution : d\xe9pend de votre p\xe9rim\xe8tre de supervision et du\nnombre d'\xe9v\xe8nements. Peut prendre de quelques minutes \xe0 plusieurs\nheures mais ne doit pas \xeatre plus long que 24h. Si c'est le cas,\nveuillez contacter le Support Centreon."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Reconstruire les tables de disponibilit\xe9 depuis la date des\nderni\xe8res donn\xe9es pr\xe9sentes en base. Pour le savoir, regardez les\ndates en face de mod_bi_hostavailability et\nmod_bi_serviceavailability: :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"nohup /usr/share/centreon-bi/etl/eventStatisticsBuilder.pl -r --no-purge --availability-only -s $date_start$ -e $date_end$ > /var/log/centreon-bi/rebuild_availability.log &\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("em",{parentName:"p"},"Temps d'ex\xe9cution : d\xe9pend de votre p\xe9rim\xe8tre de supervision et du\nnombre de jour \xe0 reconstruire. Peut prendre de quelques minutes \xe0\nplusieurs heures")))),(0,r.kt)("h4",{id:"importer-et-reconstruire-les-donn\xe9es-de-performance-manquantes"},"Importer et reconstruire les donn\xe9es de performance manquantes"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Construire les statistiques manquantes. Prenez la date la plus\nancienne en face des tables mod_bi_metrichourlyvalue et\nmod_bi_metricdailyvalue dans le retour du plugin: :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"nohup /usr/share/centreon-bi/etl/perfdataStatisticsBuilder.pl -r --no-purge -s $date_start$ -e $date_end$ > /var/log/centreon-bi/rebuild_perfData.log &\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("em",{parentName:"p"},"Temps d'ex\xe9cution : d\xe9pend de votre p\xe9rim\xe8tre de supervision et du\nnombre de jour \xe0 reconstruire. Peut prendre de quelques minutes \xe0\nplusieurs heures. Attention, si le nombre de jour \xe0 reconstuire est\nsup\xe9rieur \xe0 la r\xe9tention configur\xe9e au niveau des donn\xe9es agr\xe9g\xe9es \xe0\nl'heure, cela peut g\xe9n\xe9rer un important volume de donn\xe9es et une\nreconstruction tr\xe8s longue.")))),(0,r.kt)("h4",{id:"que-faire-apr\xe8s-lex\xe9cution-des-scripts-"},"Que faire apr\xe8s l'ex\xe9cution des scripts ?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Cas 1 : ",(0,r.kt)("strong",{parentName:"p"},"La reconstruction s'est termin\xe9e le m\xeame jour")),(0,r.kt)("p",{parentName:"li"},"D\xe9-commenter les lignes dans ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/cron.d/centreon-bi-engine")," et\n",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/cron.d/centreon-bi-purge")," puis red\xe9marrer le systemctl restart\ncrond :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"systemctl restart crond\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Cas 2 : ",(0,r.kt)("strong",{parentName:"p"},"La reconstruction se termine le jour suivant")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"D\xe9-commenter les lignes dans ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/cron.d/centreon-bi-engine")," et\n",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/cron.d/centreon-bi-purge")," puis red\xe9marrer le systemctl restart\ncrond:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"    systemctl restart crond\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Ex\xe9cutez manuellement la construction journali\xe8re: :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"/usr/share/centreon-bi/bin/centreonBIETL -d\n"))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Cas 3 : ",(0,r.kt)("strong",{parentName:"p"},"Tous les autres cas")),(0,r.kt)("p",{parentName:"li"},"Reprendre la proc\xe9dure de reconstruction partielle en l'appliquant\nsur les jours qui manquent: :"),(0,r.kt)("p",{parentName:"li"},"Exemple:\nLa reconstruction a pris 4 jours : du 01/01 au 04/01 , il faut alors reprendre la proc\xe9dure depuis le d\xe9but en utilisant date_start = 01-01 et date_end = 04/01.\nLa proc\xe9dure est termin\xe9e et la sortie de la sonde de supervision BI devrait \xeatre \u201cETL execution OK, database is up-to-date\u201d."))),(0,r.kt)("h3",{id:"statistiques-de-centreon-bam"},"Statistiques de Centreon BAM"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Suivez cette proc\xe9dure si vous venez de reconstruire les statistiques de BAM."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"R\xe9-importer les donn\xe9es BAM du serveur central vers le serveur de reporting en ex\xe9cutant cette commande :",(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/usr/share/centreon-bi/etl/importData.pl -r --bam-only\n")),"  Cela aura pour effet de n'importer que les tables de reporting du\nmodule BAM."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Si les donn\xe9es de reporting ne semblent toujours pas \xe0 jour, suivez cette proc\xe9dure :"),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"Vous devez d'abord ex\xe9cuter cette commande sur le serveur central pour recalculer globalement les statistiques de BAM :")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/usr/share/centreon/www/modules/centreon-bam-server/engine/centreon-bam-rebuild-events --all\n")),(0,r.kt)("ol",{parentName:"li",start:2},(0,r.kt)("li",{parentName:"ol"},"R\xe9importez-les ensuite sur le serveur MBI en ex\xe9cutant cette commande :")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/usr/share/centreon-bi/etl/importData.pl -r --bam-only\n")))),(0,r.kt)("h3",{id:"comment-calculer-uniquement-les-donn\xe9es-de-centile"},"Comment calculer uniquement les donn\xe9es de Centile"),(0,r.kt)("p",null,'Pour \xeatre en mesure d\'utiliser le rapport "Monthly Network\nPercentile" vous devez activer le calcul et le stockage des centiles.'),(0,r.kt)("p",null,"Pour cela, rendez vous sur la page *Reporting > Business Intelligence"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"General Options | ETL Tab* et configurez la section \"Centile\nParameters\" comme d\xe9crit ci-dessous. Le combinaison centile/timeperiod\nest donn\xe9e \xe0 titre d'exemple, n'h\xe9sitez pas \xe0 cr\xe9er votre/vos propres\ncombinaisons. Si vous n'\xeates pas int\xe9ress\xe9 par ce rapport, laissez les\nvaleurs par d\xe9faut.")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Effectuer les calculs sur le centile par"),(0,r.kt)("td",{parentName:"tr",align:null},"Mois (au moins)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"S\xe9lectionner les cat\xe9gories de services sur lesquelles aggr\xe9ger les donn\xe9es"),(0,r.kt)("td",{parentName:"tr",align:null},"S\xe9lectionner au moins une de vos cat\xe9gories de trafic")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Premier jour de la semaine"),(0,r.kt)("td",{parentName:"tr",align:null},"Lundi (d\xe9faut)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Cr\xe9er les combinaisons centile-plage horaire qui couvrent vos besoins (Format du centile : 00.0000)"),(0,r.kt)("td",{parentName:"tr",align:null},"Cr\xe9er au moins une combinaison. Ex: 99.0000 - 24x7")))),(0,r.kt)("p",null,"Exemple :"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(49567).Z,width:"1289",height:"344"})),(0,r.kt)("p",null,'Seules les categories de services s\xe9lectionn\xe9es dans la partie\n"Reporting perimeter selection" appara\xeetront dans les cat\xe9gories de\nservices disponibles pour les statistiques de centile.'),(0,r.kt)("p",null,"Vous pouvez cr\xe9er autant de combinaison que vous souhaitez mais il faut\nsavoir que l'impact sur les temps de traitements est fort. A titre\nd'exemple, l'agr\xe9gation au mois de ces statistiques peut prendre de\nquelques secondes \xe0 plusieurs dizaines de minutes."),(0,r.kt)("p",null,"Commencez par configurer les centiles sur un petit perim\xe8tre puis\n\xe9tendez le au fur et \xe0 mesure si les temps de calculs ne deviennent pas\nprobl\xe9matiques. (peut prendre de quelques secondes \xe0 plusieurs dizaine\nde minutes)."),(0,r.kt)("p",null,"Sur le serveur de ",(0,r.kt)("strong",{parentName:"p"},"reporting"),", executez la commande suivante pour\nimporter les donn\xe9es de configuration:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/usr/share/centreon-bi/bin/centreonBIETL -rIC\n")),(0,r.kt)("p",null,"Ensuite, ex\xe9cutez la commande suivante pour int\xe9grer la configuration\ndes centiles dans le datawarehouse:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/usr/share/centreon-bi/etl/dimensionsBuilder.pl -d\n")),(0,r.kt)("p",null,"Enfin, ex\xe9cutez la commande suivante afin de calculer les statistiques\n(cela peut prendre de quelques secondes \xe0 plusieurs dizaines de minutes\nselon votre configuration):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/usr/share/centreon-bi/etl/perfdataStatisticsBuilder.pl -r --centile-only\n")))}g.isMDXComponent=!0},49567:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/centileParameters-685baac109f1ec2b720b995d498d2f1e.png"},77203:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/etl_dataRetention-94dab4d9d60f13fb3c12ff602745bf32.png"},6100:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/mtbf_mtbsi_mtrs_explanation-fef66fd28d57c363801f020fb33ab7ba.png"},36702:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/pie_charts-1f2b9904e42f161e886628868ce3e935.png"},16455:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/storage_example-1002826480ef742c7259fc135fb81021.png"}}]);