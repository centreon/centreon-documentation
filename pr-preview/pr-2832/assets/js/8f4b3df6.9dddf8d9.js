"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[54554],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>m});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),p=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=p(a),m=n,g=d["".concat(s,".").concat(m)]||d[m]||c[m]||o;return a?r.createElement(g,l(l({ref:t},u),{},{components:a})):r.createElement(g,l({ref:t},u))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,l=new Array(o);l[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:n,l[1]=i;for(var p=2;p<o;p++)l[p]=a[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}d.displayName="MDXCreateElement"},18082:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>p,default:()=>g,frontMatter:()=>s,metadata:()=>u,toc:()=>d});a(67294);var r=a(3905),n=a(67709),o=a(7626);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},l.apply(this,arguments)}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}const s={id:"hardware-storage-purestorage-restapi",title:"Pure Storage RestAPI"},p=void 0,u={unversionedId:"integrations/plugin-packs/procedures/hardware-storage-purestorage-restapi",id:"integrations/plugin-packs/procedures/hardware-storage-purestorage-restapi",title:"Pure Storage RestAPI",description:"Overview",source:"@site/pp/integrations/plugin-packs/procedures/hardware-storage-purestorage-api.md",sourceDirName:"integrations/plugin-packs/procedures",slug:"/integrations/plugin-packs/procedures/hardware-storage-purestorage-restapi",permalink:"/centreon-documentation/pr-preview/pr-2832/pp/integrations/plugin-packs/procedures/hardware-storage-purestorage-restapi",draft:!1,tags:[],version:"current",frontMatter:{id:"hardware-storage-purestorage-restapi",title:"Pure Storage RestAPI"},sidebar:"pp",previous:{title:"Panzura",permalink:"/centreon-documentation/pr-preview/pr-2832/pp/integrations/plugin-packs/procedures/hardware-storage-panzura-snmp"},next:{title:"Qnap",permalink:"/centreon-documentation/pr-preview/pr-2832/pp/integrations/plugin-packs/procedures/hardware-storage-qnap-snmp"}},c={},d=[{value:"Overview",id:"overview",level:2},{value:"Plugin-Pack assets",id:"plugin-pack-assets",level:2},{value:"Monitored objects",id:"monitored-objects",level:3},{value:"Monitored metrics",id:"monitored-metrics",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installation",id:"installation",level:2},{value:"Host Configuration",id:"host-configuration",level:2},{value:"FAQ",id:"faq",level:2},{value:"How can I test the Plugin and what are the main options for ?",id:"how-can-i-test-the-plugin-and-what-are-the-main-options-for-",level:4},{value:"&quot;UNKNOWN: Cannot decode json response&quot;",id:"unknown-cannot-decode-json-response",level:4}],m={toc:d};function g(e){var{components:t}=e,a=i(e,["components"]);return(0,r.kt)("wrapper",l({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",l({},{id:"overview"}),"Overview"),(0,r.kt)("p",null,"Pure Storage develops flash-based storage for data centers using consumer-grade solid state drives. It provides\nproprietary de-duplication and compression software to improve the amount of data that can be stored on each drive. "),(0,r.kt)("h2",l({},{id:"plugin-pack-assets"}),"Plugin-Pack assets"),(0,r.kt)("h3",l({},{id:"monitored-objects"}),"Monitored objects"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Storage array")),(0,r.kt)("h2",l({},{id:"monitored-metrics"}),"Monitored metrics"),(0,r.kt)("p",null,"More information is available in the Pure Storage official API documentation : ",(0,r.kt)("a",l({parentName:"p"},{href:"https://blog.purestorage.com/products/introducing-the-pure1-rest-api/"}),"https://blog.purestorage.com/products/introducing-the-pure1-rest-api/")),(0,r.kt)(n.Z,{groupId:"sync",mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"Alarms-Global",label:"Alarms-Global",mdxType:"TabItem"},(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Metric name"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Status"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Status of alarms. Threshold/Unit: String"))))),(0,r.kt)(o.Z,{value:"Hardware-Global",label:"Hardware-Global",mdxType:"TabItem"},(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Metric name"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Status"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Status of components. Threshold/Unit: String"))))),(0,r.kt)(o.Z,{value:"Volume-Usage-Global",label:"Volume-Usage-Global",mdxType:"TabItem"},(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Metric name"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Volume-Usage"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"The usage of volume. Units: Bytes or %")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Data-Reduction"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"The data-reduction ratio on the volume. Unit: ratio")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Total-Reduction"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"The total-reduction on the volume. Unit: count")))))),(0,r.kt)("h2",l({},{id:"prerequisites"}),"Prerequisites"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"This Monitoring Plugin requires at least a Pure Storage API version >= 1.11 (",(0,r.kt)("a",l({parentName:"p"},{href:"https://static.pure1.purestorage.com/api-swagger/index"}),"https://static.pure1.purestorage.com/api-swagger/index"),").")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},'A service account has to be created on the device. This account must have at least a "read only" access to the storage array.'))),(0,r.kt)("h2",l({},{id:"installation"}),"Installation"),(0,r.kt)(n.Z,{groupId:"sync",mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"Online License",label:"Online License",mdxType:"TabItem"},(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Install the Plugin on every poller expected to monitor Pure Storage arrays:")),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"yum install centreon-plugin-Hardware-Storage-Purestorage-Restapi\n")),(0,r.kt)("ol",l({},{start:2}),(0,r.kt)("li",{parentName:"ol"},'Install the "Pure-Storage-Restapi" Centreon Plugin-Pack from the "Configuration > Plugin Packs > Manager" page'))),(0,r.kt)(o.Z,{value:"Offline License",label:"Offline License",mdxType:"TabItem"},(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Install the Plugin on every poller expected to monitor Pure Storage resources:")),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"yum install centreon-plugin-Hardware-Storage-Purestorage-Restapi\n")),(0,r.kt)("ol",l({},{start:2}),(0,r.kt)("li",{parentName:"ol"},"Install the Centreon Plugin-Pack RPM on your central server:")),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"yum install centreon-pack-hardware-storage-purestorage-restapi\n")),(0,r.kt)("ol",l({},{start:3}),(0,r.kt)("li",{parentName:"ol"},'Install the "Pure-Storage-Restapi" Centreon Plugin-Pack from the "Configuration > Plugin Packs > Manager" page')))),(0,r.kt)("h2",l({},{id:"host-configuration"}),"Host Configuration"),(0,r.kt)("p",null,'Apply the "HW-Storage-Purestorage-Restapi-custom" template to your newly created host. Then fill the macros value fields marked as mandatory below: '),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Mandatory"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Name"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"X"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"APIURLPATH"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Pure Storage API URL Path")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"X"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"APIURLUSERNAME"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Pure Storage API Username")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"X"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"APIURLPASSWORD"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Pure Storage API Password")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"})),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"APIEXTRAOPTIONS"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Pure Storage API Extra options")))),(0,r.kt)("h2",l({},{id:"faq"}),"FAQ"),(0,r.kt)("h4",l({},{id:"how-can-i-test-the-plugin-and-what-are-the-main-options-for-"}),"How can I test the Plugin and what are the main options for ?"),(0,r.kt)("p",null,"Once the Centreon Plugin installed, you can test it directly on the Centreon poller by logging into the CLI with the ",(0,r.kt)("em",{parentName:"p"},"centreon-engine")," user and run the command hereafter:"),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"/usr/lib/centreon/plugins//centreon_purestorage_restapi.pl \\\n    --plugin=storage::purestorage::restapi::plugin \\\n    --mode=volume-usage \\\n    --hostname=192.168.1.1 \\\n    --api-path='/api/1.11' \\ \n    --username='centreon' \\\n    --password='centreon' \\\n    --filter-name='.*' \\\n    --units='%' \\\n    --warning-usage='80' \\\n    --critical-usage='90' \\\n    --warning-data-reduction='' \\\n    --critical-data-reduction='' \\\n    --warning-total-reduction=':5' \\\n    --critical-total-reduction=':4' \\\n    --verbose\n")),(0,r.kt)("p",null,"If everything's fine, it should output something similar to: "),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"OK: Volume 'PROD::CENTREON' Usage Total: 6.00 TB Used: 1.13 TB (18.85%) Free: 4.87 TB (81.15%), Data Reduction : 2.917, Total Reduction : 5.193, Snapshots : 0.00 B | \n'used'=1243773921694B;0:5277655813324;0:5937362789990;0;6597069766656\n'data_reduction'=2.873;;;0;\n'total_reduction'=5.201;;;0;\n'snapshots'=0B;;;0;\n")),(0,r.kt)("p",null,"This command checks the volumes usage (",(0,r.kt)("inlineCode",{parentName:"p"},"--mode=volume-usage"),") of a Pure Storage array device using the 1.11 API endpoint (",(0,r.kt)("inlineCode",{parentName:"p"},"--api-path='/api/1.11'"),"). The device's IP address is ",(0,r.kt)("em",{parentName:"p"},"192.168.1.1")," (",(0,r.kt)("inlineCode",{parentName:"p"},"--hostname=192.168.1.1"),") and the credentials used to authenticate against the API endpoint are ",(0,r.kt)("em",{parentName:"p"},"centreon/centreon")," (",(0,r.kt)("inlineCode",{parentName:"p"},"--username='centreon' --password='centreon'"),"). The above command would return all of the device's volumes as the name filter will match any result (",(0,r.kt)("inlineCode",{parentName:"p"},"--filter-name='.*'"),")."),(0,r.kt)("p",null,"This command will trigger a WARNING alarm if the volume usage exceeds 80% (",(0,r.kt)("inlineCode",{parentName:"p"},"--warning-usage='80'"),") and a CRITICAL alarm if it exceeds 90% (",(0,r.kt)("inlineCode",{parentName:"p"},"--critical-usage='90'"),"). "),(0,r.kt)("p",null,'It is besides possible to define WARNING and CRITICAL thresholds on a specific metric:\nin this example a WARNING alarm will be triggered if the total rate of "reduction" is less than 5 (',(0,r.kt)("inlineCode",{parentName:"p"},"--warning-total-reduction=':5'"),") and CRITICAL if it is less than 4 (",(0,r.kt)("inlineCode",{parentName:"p"},"--critical-total-reduction=':4'"),")."),(0,r.kt)("p",null,"The syntax of the different options of the thresholds as well as the list of options and their usage are detailed in the help of the mode by adding the parameter ",(0,r.kt)("inlineCode",{parentName:"p"},"--help")," to the command:"),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"/usr/lib/centreon/plugins/centreon_purestorage_restapi.pl \\\n    --plugin=storage::purestorage::restapi::plugin \\\n    --mode=volume-usage \\\n    --help\n")),(0,r.kt)("h4",l({},{id:"unknown-cannot-decode-json-response"}),'"UNKNOWN: Cannot decode json response"'),(0,r.kt)("p",null,"If you receive this message, set the ",(0,r.kt)("inlineCode",{parentName:"p"},"--debug")," option flag to get more information about the error. "),(0,r.kt)("p",null,"Most common reasons for this message are: "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"A Firewall drops the HTTPS flows between the Poller and the Pure Storage device.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The Pure Storage device uses a self-signed certificate. Add the option ",(0,r.kt)("inlineCode",{parentName:"p"},'--ssl-opt="SSL_verify_mode => SSL_VERIFY_NONE"')," in the  Host ",(0,r.kt)("em",{parentName:"p"},"EXTRAOPTIONS")," macro to prevent this error."))))}g.isMDXComponent=!0},7626:(e,t,a)=>{a.d(t,{Z:()=>i});var r=a(67294),n=a(86010);const o="tabItem_Ymn6";function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},l.apply(this,arguments)}function i({children:e,hidden:t,className:a}){return r.createElement("div",l({role:"tabpanel",className:(0,n.Z)(o,a)},{hidden:t}),e)}},67709:(e,t,a)=>{a.d(t,{Z:()=>m});var r=a(67294),n=a(86010),o=a(90980),l=a(35715),i=a(8854),s=a(8241);const p="tabList__CuJ",u="tabItem_LNqP";function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},c.apply(this,arguments)}function d(e){var t;const{lazy:a,block:o,defaultValue:d,values:m,groupId:g,className:h}=e,f=r.Children.map(e.children,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),k=null!=m?m:f.map((({props:{value:e,label:t,attributes:a}})=>({value:e,label:t,attributes:a}))),v=(0,l.l)(k,((e,t)=>e.value===t.value));if(v.length>0)throw new Error(`Docusaurus error: Duplicate values "${v.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);var b;const N=null===d?d:null!==(b=null!=d?d:null===(t=f.find((e=>e.props.default)))||void 0===t?void 0:t.props.value)&&void 0!==b?b:f[0].props.value;if(null!==N&&!k.some((e=>e.value===N)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${N}" but none of its children has the corresponding value. Available values are: ${k.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:y,setTabGroupChoices:P}=(0,i.U)(),[w,O]=(0,r.useState)(N),T=[],{blockElementScrollPositionUntilNextRender:I}=(0,s.o5)();if(null!=g){const e=y[g];null!=e&&e!==w&&k.some((t=>t.value===e))&&O(e)}const S=e=>{const t=e.currentTarget,a=T.indexOf(t),r=k[a].value;r!==w&&(I(t),O(r),null!=g&&P(g,String(r)))},C=e=>{let t=null;switch(e.key){case"ArrowRight":{const r=T.indexOf(e.currentTarget)+1;var a;t=null!==(a=T[r])&&void 0!==a?a:T[0];break}case"ArrowLeft":{const a=T.indexOf(e.currentTarget)-1;var r;t=null!==(r=T[a])&&void 0!==r?r:T[T.length-1];break}}null==t||t.focus()};return r.createElement("div",{className:(0,n.Z)("tabs-container",p)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,n.Z)("tabs",{"tabs--block":o},h)},k.map((({value:e,label:t,attributes:a})=>r.createElement("li",c({role:"tab",tabIndex:w===e?0:-1,"aria-selected":w===e,key:e,ref:e=>T.push(e),onKeyDown:C,onFocus:S,onClick:S},a,{className:(0,n.Z)("tabs__item",u,null==a?void 0:a.className,{"tabs__item--active":w===e})}),null!=t?t:e)))),a?(0,r.cloneElement)(f.filter((e=>e.props.value===w))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},f.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==w})))))}function m(e){const t=(0,o.Z)();return r.createElement(d,c({key:String(t)},e))}}}]);