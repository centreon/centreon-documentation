"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[57301],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,k=d["".concat(s,".").concat(m)]||d[m]||u[m]||o;return n?a.createElement(k,l(l({ref:t},p),{},{components:n})):a.createElement(k,l({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var c=2;c<o;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},96536:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>k,frontMatter:()=>s,metadata:()=>p,toc:()=>d});n(67294);var a=n(3905),r=n(67709),o=n(7626);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l.apply(this,arguments)}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const s={id:"applications-docker-restapi",title:"Docker"},c=void 0,p={unversionedId:"integrations/plugin-packs/procedures/applications-docker-restapi",id:"integrations/plugin-packs/procedures/applications-docker-restapi",title:"Docker",description:"Overview",source:"@site/pp/integrations/plugin-packs/procedures/applications-docker-restapi.md",sourceDirName:"integrations/plugin-packs/procedures",slug:"/integrations/plugin-packs/procedures/applications-docker-restapi",permalink:"/centreon-documentation/pr-preview/pr-2832/pp/integrations/plugin-packs/procedures/applications-docker-restapi",draft:!1,tags:[],version:"current",frontMatter:{id:"applications-docker-restapi",title:"Docker"},sidebar:"pp",previous:{title:"Cloud Foundry",permalink:"/centreon-documentation/pr-preview/pr-2832/pp/integrations/plugin-packs/procedures/cloud-cloudfoundry-api"},next:{title:"IBM Softlayer",permalink:"/centreon-documentation/pr-preview/pr-2832/pp/integrations/plugin-packs/procedures/cloud-ibm-softlayer-api"}},u={},d=[{value:"Overview",id:"overview",level:2},{value:"Plugin-pack assets",id:"plugin-pack-assets",level:2},{value:"Monitored objects",id:"monitored-objects",level:3},{value:"Monitored metrics",id:"monitored-metrics",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"API connection",id:"api-connection",level:3},{value:"Installation",id:"installation",level:2},{value:"Host Configuration",id:"host-configuration",level:2},{value:"FAQ",id:"faq",level:2},{value:"Why are some of my checks are very slow ?",id:"why-are-some-of-my-checks-are-very-slow-",level:4},{value:"How can I test my plugin through the CLI and what does the main command_line parameters mean ?",id:"how-can-i-test-my-plugin-through-the-cli-and-what-does-the-main-command_line-parameters-mean-",level:4}],m={toc:d};function k(e){var{components:t}=e,n=i(e,["components"]);return(0,a.kt)("wrapper",l({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",l({},{id:"overview"}),"Overview"),(0,a.kt)("p",null,"Docker is a set of platform as a service (PaaS) products that uses OS-level virtualization to deliver software in packages called containers. Containers are isolated from one another and bundle their own software, libraries and configuration files; they can communicate with each other through well-defined channels. All containers are run by a single operating system kernel and therefore use fewer resources than virtual machines."),(0,a.kt)("p",null,"The service has both free and premium tiers. The software that hosts the containers is called Docker Engine. It was first started in 2013 and is developed by Docker, Inc."),(0,a.kt)("h2",l({},{id:"plugin-pack-assets"}),"Plugin-pack assets"),(0,a.kt)("h3",l({},{id:"monitored-objects"}),"Monitored objects"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Nodes"),(0,a.kt)("li",{parentName:"ul"},"Containers")),(0,a.kt)("h2",l({},{id:"monitored-metrics"}),"Monitored metrics"),(0,a.kt)("p",null,"More information about gathered metrics can be found into Docker official API documentation : ",(0,a.kt)("a",l({parentName:"p"},{href:"https://docs.docker.com/engine/api/v1.30/"}),"https://docs.docker.com/engine/api/v1.30/")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(o.Z,{value:"Container-Usage",label:"Container-Usage",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",l({parentName:"tr"},{align:"left"}),"Metric name"),(0,a.kt)("th",l({parentName:"tr"},{align:"left"}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Name"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Name of the container.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"State_name"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Real state of the container.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"read_io"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The average number of read bytes from disk per second. Unit: Bytes/Second")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Write_io"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The average number of written bytes on disk per second. Unit: Bytes/Second")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Cpu_total_usage"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The percentage of CPU usage. Unit: Percent")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Cpu_system_usage"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The average amount of time taken per disk I/O write operation. Unit: Seconds")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Memory_usage"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The percentage of memory usage. Units: Percent & Bytes")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Traffic_in"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The percentage of inbound traffic usage. Units: Percent & Bytes/Second")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Traffic_out"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The percentage of outbound traffic usage. Units: Percent & Bytes/Second"))))),(0,a.kt)(o.Z,{value:"Nodes-Status",label:"Nodes-Status",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",l({parentName:"tr"},{align:"left"}),"Metric name"),(0,a.kt)("th",l({parentName:"tr"},{align:"left"}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Node-status"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The status of node. Unit: text")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Containers-running"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The number of running containers. Unit: counter")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Containers-stopped"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The number of stopped containers. Unit: counter")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Containers_paused"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"The Number of paused containers. Unit: counter")))))),(0,a.kt)("h2",l({},{id:"prerequisites"}),"Prerequisites"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"This monitoring plugin requires at least a Docker API version >= 1.21 (",(0,a.kt)("a",l({parentName:"li"},{href:"https://docs.docker.com/engine/api/v1.30/"}),"https://docs.docker.com/engine/api/v1.30/"),").")),(0,a.kt)("h3",l({},{id:"api-connection"}),"API connection"),(0,a.kt)("p",null,"Open your favorite ssh client and configure your API to allow connections from the outside: "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"vi /lib/systemd/system/docker.service"),(0,a.kt)("li",{parentName:"ul"},"Modify the line starting with ExecStart as shown below: ")),(0,a.kt)("pre",null,(0,a.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock -H=tcp://0.0.0.0:2375\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Save the changes"),(0,a.kt)("li",{parentName:"ul"},"Apply the changes made at the systemd level : ",(0,a.kt)("inlineCode",{parentName:"li"},"systemctl daemon-reload")),(0,a.kt)("li",{parentName:"ul"},"Restart the Docker engine: ",(0,a.kt)("inlineCode",{parentName:"li"},"systemctl restart docker")," ")),(0,a.kt)("h2",l({},{id:"installation"}),"Installation"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(o.Z,{value:"Online License",label:"Online License",mdxType:"TabItem"},(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Install the plugin on every poller expected to monitor Docker resources:")),(0,a.kt)("pre",null,(0,a.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"yum install centreon-plugin-Applications-Docker-Restapi\n")),(0,a.kt)("ol",l({},{start:2}),(0,a.kt)("li",{parentName:"ol"},'Install the "Docker-Restapi" Centreon Plugin-Pack from the "Configuration > Plugin packs > Manager" page'))),(0,a.kt)(o.Z,{value:"Offline License",label:"Offline License",mdxType:"TabItem"},(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Install the plugin on every poller expected to monitor Docker resources:")),(0,a.kt)("pre",null,(0,a.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"yum install centreon-plugin-Applications-Docker-Restapi\n")),(0,a.kt)("ol",l({},{start:2}),(0,a.kt)("li",{parentName:"ol"},"Install the Centreon Plugin-Pack RPM on your central server:")),(0,a.kt)("pre",null,(0,a.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"yum install centreon-pack-applications-docker-restapi\n")),(0,a.kt)("ol",l({},{start:3}),(0,a.kt)("li",{parentName:"ol"},'Install the "Docker-Restapi" Centreon Plugin-Pack from the "Configuration > Plugin packs > Manager" page')))),(0,a.kt)("h2",l({},{id:"host-configuration"}),"Host Configuration"),(0,a.kt)("p",null,'Apply the "App-Docker-Restapi-custom" template to your newly created host. Then fill the macros value fileds marked as mandatory below: '),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",l({parentName:"tr"},{align:"left"}),"Mandatory"),(0,a.kt)("th",l({parentName:"tr"},{align:"left"}),"Name"),(0,a.kt)("th",l({parentName:"tr"},{align:"left"}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"X"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"DOCKERENGINEPORT"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Docker API TCP port to use to query the Docker engine")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",l({parentName:"tr"},{align:"left"})),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"DOCKERENGINEEXTRAOPTIONS"),(0,a.kt)("td",l({parentName:"tr"},{align:"left"}),"Docker API engine extra options")))),(0,a.kt)("h2",l({},{id:"faq"}),"FAQ"),(0,a.kt)("h4",l({},{id:"why-are-some-of-my-checks-are-very-slow-"}),"Why are some of my checks are very slow ?"),(0,a.kt)("p",null,"The container stats endpoint can be pretty slow to return a result (between 1 and 2 second), so it's considered as normal that the container-stats check may take some time. "),(0,a.kt)("h4",l({},{id:"how-can-i-test-my-plugin-through-the-cli-and-what-does-the-main-command_line-parameters-mean-"}),"How can I test my plugin through the CLI and what does the main command_line parameters mean ?"),(0,a.kt)("p",null,"Once you've installed your monitoring plugin, you can use the centreon-engine user to test it! "),(0,a.kt)("pre",null,(0,a.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"/usr/lib/centreon/plugins//centreon_docker_restapi.pl \\\n--plugin=cloud::docker::restapi::plugin \\\n--mode=node-status \\\n--hostname='192.168.0.50' \\\n--port='2375'   \\\n--warning-node-status='' \\\n--critical-node-status='%{status} !~ /ready/ || %{manager_status} !~ /reachable|-/' \\\n--verbose\n\nOK: Node '192.168.0.50' Containers Running : 7, Containers Stopped : 2, Containers Paused : 0 | 'containers_running'=7;;;0; 'containers_stopped'=2;;;0; 'containers_paused'=0;;;0;\nNode '192.168.0.50' Containers Running : 7, Containers Stopped : 2, Containers Paused : 0\n")),(0,a.kt)("p",null,"This command checks your docker engine node status (",(0,a.kt)("inlineCode",{parentName:"p"},"--mode=node-status"),") using tcp port 2375 (",(0,a.kt)("inlineCode",{parentName:"p"},"--port='2375'"),"). It provides the overall status of the node and state of each container it manages."),(0,a.kt)("p",null,"A CRITICAL alert is triggered if your node is not considered as ready or the manager cannot be reached (",(0,a.kt)("inlineCode",{parentName:"p"},"--critical-node-status='%{status} !~ /ready/ || %{manager_status} !~ /reachable|-/'"),")"))}k.isMDXComponent=!0},7626:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(67294),r=n(86010);const o="tabItem_Ymn6";function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l.apply(this,arguments)}function i({children:e,hidden:t,className:n}){return a.createElement("div",l({role:"tabpanel",className:(0,r.Z)(o,n)},{hidden:t}),e)}},67709:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(67294),r=n(86010),o=n(90980),l=n(35715),i=n(8854),s=n(8241);const c="tabList__CuJ",p="tabItem_LNqP";function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u.apply(this,arguments)}function d(e){var t;const{lazy:n,block:o,defaultValue:d,values:m,groupId:k,className:f}=e,g=a.Children.map(e.children,(e=>{if((0,a.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),h=null!=m?m:g.map((({props:{value:e,label:t,attributes:n}})=>({value:e,label:t,attributes:n}))),y=(0,l.l)(h,((e,t)=>e.value===t.value));if(y.length>0)throw new Error(`Docusaurus error: Duplicate values "${y.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);var b;const v=null===d?d:null!==(b=null!=d?d:null===(t=g.find((e=>e.props.default)))||void 0===t?void 0:t.props.value)&&void 0!==b?b:g[0].props.value;if(null!==v&&!h.some((e=>e.value===v)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${v}" but none of its children has the corresponding value. Available values are: ${h.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:N,setTabGroupChoices:w}=(0,i.U)(),[O,T]=(0,a.useState)(v),P=[],{blockElementScrollPositionUntilNextRender:C}=(0,s.o5)();if(null!=k){const e=N[k];null!=e&&e!==O&&h.some((t=>t.value===e))&&T(e)}const I=e=>{const t=e.currentTarget,n=P.indexOf(t),a=h[n].value;a!==O&&(C(t),T(a),null!=k&&w(k,String(a)))},D=e=>{let t=null;switch(e.key){case"ArrowRight":{const a=P.indexOf(e.currentTarget)+1;var n;t=null!==(n=P[a])&&void 0!==n?n:P[0];break}case"ArrowLeft":{const n=P.indexOf(e.currentTarget)-1;var a;t=null!==(a=P[n])&&void 0!==a?a:P[P.length-1];break}}null==t||t.focus()};return a.createElement("div",{className:(0,r.Z)("tabs-container",c)},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":o},f)},h.map((({value:e,label:t,attributes:n})=>a.createElement("li",u({role:"tab",tabIndex:O===e?0:-1,"aria-selected":O===e,key:e,ref:e=>P.push(e),onKeyDown:D,onFocus:I,onClick:I},n,{className:(0,r.Z)("tabs__item",p,null==n?void 0:n.className,{"tabs__item--active":O===e})}),null!=t?t:e)))),n?(0,a.cloneElement)(g.filter((e=>e.props.value===O))[0],{className:"margin-top--md"}):a.createElement("div",{className:"margin-top--md"},g.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==O})))))}function m(e){const t=(0,o.Z)();return a.createElement(d,u({key:String(t)},e))}}}]);