"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[78947],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=u(n),m=r,k=d["".concat(s,".").concat(m)]||d[m]||c[m]||l;return n?a.createElement(k,i(i({ref:t},p),{},{components:n})):a.createElement(k,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var u=2;u<l;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},67915:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>u,default:()=>k,frontMatter:()=>s,metadata:()=>p,toc:()=>d});n(67294);var a=n(3905),r=n(67709),l=n(7626);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i.apply(this,arguments)}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const s={id:"cloud-aws-vpn",title:"AWS VPN"},u=void 0,p={unversionedId:"integrations/plugin-packs/procedures/cloud-aws-vpn",id:"integrations/plugin-packs/procedures/cloud-aws-vpn",title:"AWS VPN",description:"Vue d'ensemble",source:"@site/i18n/fr/docusaurus-plugin-content-docs-pp/current/integrations/plugin-packs/procedures/cloud-aws-vpn.md",sourceDirName:"integrations/plugin-packs/procedures",slug:"/integrations/plugin-packs/procedures/cloud-aws-vpn",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/pp/integrations/plugin-packs/procedures/cloud-aws-vpn",draft:!1,tags:[],version:"current",frontMatter:{id:"cloud-aws-vpn",title:"AWS VPN"},sidebar:"pp",previous:{title:"AWS Transit Gateway",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/pp/integrations/plugin-packs/procedures/cloud-aws-transitgateway"},next:{title:"Amazon SES",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/pp/integrations/plugin-packs/procedures/cloud-aws-ses"}},c={},d=[{value:"Vue d&#39;ensemble",id:"vue-densemble",level:2},{value:"Contenu du Plugin-Pack",id:"contenu-du-plugin-pack",level:2},{value:"Objets supervis\xe9s",id:"objets-supervis\xe9s",level:3},{value:"R\xe8gles de d\xe9couvertes",id:"r\xe8gles-de-d\xe9couvertes",level:3},{value:"M\xe9triques collect\xe9es",id:"m\xe9triques-collect\xe9es",level:2},{value:"Pr\xe9requis",id:"pr\xe9requis",level:2},{value:"Privil\xe8ges AWS",id:"privil\xe8ges-aws",level:3},{value:"D\xe9pendances du Plugin",id:"d\xe9pendances-du-plugin",level:3},{value:"Installation",id:"installation",level:2},{value:"Configuration",id:"configuration",level:2},{value:"H\xf4te",id:"h\xf4te",level:3},{value:"FAQ",id:"faq",level:2},{value:"Comment tester un contr\xf4le en ligne de commande et que signifient les options principales ?",id:"comment-tester-un-contr\xf4le-en-ligne-de-commande-et-que-signifient-les-options-principales-",level:3},{value:"J&#39;obtiens le message d&#39;erreur suivant:",id:"jobtiens-le-message-derreur-suivant",level:3},{value:"<code>UNKNOWN: No metrics. Check your options or use --zeroed option to set 0 on undefined values</code>",id:"unknown-no-metrics-check-your-options-or-use---zeroed-option-to-set-0-on-undefined-values",level:4},{value:"<code>UNKNOWN: Command error:  - An error occurred (AuthFailure) [...]</code>",id:"unknown-command-error----an-error-occurred-authfailure-",level:4},{value:"<code>UNKNOWN: 500 Can&#39;t connect to monitoring.eu-west-1.amazonaws.com:443 |</code>",id:"unknown-500-cant-connect-to-monitoringeu-west-1amazonawscom443-",level:4}],m={toc:d};function k(e){var{components:t}=e,n=o(e,["components"]);return(0,a.kt)("wrapper",i({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",i({},{id:"vue-densemble"}),"Vue d'ensemble"),(0,a.kt)("p",null,"AWS Virtual Private Network (AWS VPN) vous permet d'\xe9tablir un tunnel s\xe9curis\xe9 et priv\xe9 entre votre r\xe9seau ou appareil et le cloud AWS.\nVous pouvez \xe9tendre votre r\xe9seau sur site existant dans un VPC ou vous connecter \xe0 d'autres ressources AWS \xe0 partir d'un client.\nAWS VPN propose deux types de connexion priv\xe9e qui offrent chacun la haute disponibilit\xe9 et la s\xe9curit\xe9 robuste n\xe9cessaires pour vos donn\xe9es."),(0,a.kt)("p",null,"Le Plugin-Pack Centreon ",(0,a.kt)("em",{parentName:"p"},"AWS VPN")," s'appuie sur les APIs Amazon Cloudwatch pour la collecte des donn\xe9es et m\xe9triques relatives au service VPN."),(0,a.kt)("h2",i({},{id:"contenu-du-plugin-pack"}),"Contenu du Plugin-Pack"),(0,a.kt)("h3",i({},{id:"objets-supervis\xe9s"}),"Objets supervis\xe9s"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Connexions VPN Site-To-Site & VPC")),(0,a.kt)("h3",i({},{id:"r\xe8gles-de-d\xe9couvertes"}),"R\xe8gles de d\xe9couvertes"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Services",label:"Services",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Rule name"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Cloud-Aws-Vpn-Connections"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Discover VPN connections and monitor their status and traffic")))))),(0,a.kt)("h2",i({},{id:"m\xe9triques-collect\xe9es"}),"M\xe9triques collect\xe9es"),(0,a.kt)("p",null,"Vous pouvez vous renseigner en d\xe9tails sur les m\xe9triques pr\xe9sent\xe9es ci-apr\xe8s sur la documentation officiel du service VPN:\n",(0,a.kt)("a",i({parentName:"p"},{href:"https://docs.aws.amazon.com/fr_fr/vpn/latest/s2svpn/monitoring-cloudwatch-vpn"}),"https://docs.aws.amazon.com/fr_fr/vpn/latest/s2svpn/monitoring-cloudwatch-vpn")),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Vpn-Traffic-*",label:"Vpn-Traffic-*",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Metric name"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Description"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Unit"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("em",{parentName:"td"},"instance"),"#","vpn.tunnel.tunnelstate"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"The state of the tunnel. For static VPNs, 0 indicates DOWN and 1 indicates UP. For BGP VPNs, 1 indicates ESTABLISHED and 0 is used for all other states"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("em",{parentName:"td"},"instance"),"#","vpn.tunnel.datain.bytes"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"The bytes received through the VPN tunnel"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"B")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("em",{parentName:"td"},"instance"),"#","vpn.tunnel.datain.bytes"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"The bytes sent through the VPN tunnel"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"B")))),(0,a.kt)("p",null,"Il est possible d'afficher l'ensemble de ces m\xe9triques de fa\xe7on relative (par seconde) plut\xf4t que de mani\xe8re absolue. Pour cela,\najoutez simplement le param\xe8tre ",(0,a.kt)("inlineCode",{parentName:"p"}," --per-sec")," \xe0 la commande."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Le Mod\xe8le de Service ",(0,a.kt)("em",{parentName:"p"},"Vpn-Traffic-Global")," supervise par d\xe9faut l'ensemble des liens VPN de votre infrastructure AWS.\nUtilisez le module de ",(0,a.kt)("strong",{parentName:"p"},"d\xe9couverte automatique des Services")," afin d'obtenir un Service par ",(0,a.kt)("em",{parentName:"p"},"VPN ID"),".")))),(0,a.kt)("h2",i({},{id:"pr\xe9requis"}),"Pr\xe9requis"),(0,a.kt)("h3",i({},{id:"privil\xe8ges-aws"}),"Privil\xe8ges AWS"),(0,a.kt)("p",null,"Voici la liste des droits n\xe9cessaires au travers des access/secret key utilis\xe9es pour pouvoir utiliser le monitoring AWS/VPN:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"AWS Privilege"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"ec2:DescribeVpnConnections"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Describes one or more of your VPN connections")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"cloudwatch:listMetrics"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"List all metrics from Cloudwatch AWS/VPN namespace")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"cloudwatch:getMetricStatistics"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Get metrics values from Cloudwatch AWS/VPN namespace")))),(0,a.kt)("h3",i({},{id:"d\xe9pendances-du-plugin"}),"D\xe9pendances du Plugin"),(0,a.kt)("p",null,"Afin de r\xe9cup\xe9rer les informations n\xe9cessaires via les APIs AWS, il est possible d'utiliser soit le binaire ",(0,a.kt)("em",{parentName:"p"},"awscli"),", soit le SDK perl Paws. Le SDK est recommand\xe9 car plus performant."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Attention")," il n'est pas possible d'utiliser perl-Paws si la connexion s'effectue au travers d'un proxy."),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"perl-Paws-installation",label:"perl-Paws-installation",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"yum install perl-Paws\n"))),(0,a.kt)(l.Z,{value:"aws-cli-installation",label:"aws-cli-installation",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"yum install awscli\n")))),(0,a.kt)("h2",i({},{id:"installation"}),"Installation"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Online License",label:"Online License",mdxType:"TabItem"},(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Installer le Plugin sur tous les collecteurs Centreon supervisant des ressources AWS/VPN:")),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"yum install centreon-plugin-Cloud-Aws-Vpn-Api\n")),(0,a.kt)("ol",i({},{start:2}),(0,a.kt)("li",{parentName:"ol"},"Sur l'interface Web de Centreon, installer le Plugin-Pack ",(0,a.kt)("em",{parentName:"li"},"AWS VPN"),' depuis la page "Configuration > Plugin packs > Manager"'))),(0,a.kt)(l.Z,{value:"Offline License",label:"Offline License",mdxType:"TabItem"},(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Installer le Plugin sur tous les collecteurs Centreon supervisant des ressources AWS/VPN:")),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"yum install centreon-plugin-Cloud-Aws-Vpn-Api\n")),(0,a.kt)("ol",i({},{start:2}),(0,a.kt)("li",{parentName:"ol"},"Sur le serveur Central Centreon, installer le RPM du Plugin-Pack:")),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"yum install centreon-pack-cloud-aws-vpn.noarch\n")),(0,a.kt)("ol",i({},{start:3}),(0,a.kt)("li",{parentName:"ol"},"Sur l'interface Web de Centreon, installer le Plugin-Pack ",(0,a.kt)("em",{parentName:"li"},"AWS VPN"),' depuis la page "Configuration > Plugin packs > Manager"')))),(0,a.kt)("h2",i({},{id:"configuration"}),"Configuration"),(0,a.kt)("h3",i({},{id:"h\xf4te"}),"H\xf4te"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Ajoutez un H\xf4te \xe0 Centreon, remplissez le champ ",(0,a.kt)("em",{parentName:"li"},"Adresse IP/DNS")," avec l'adresse 127.0.0.1 et appliquez-lui le Mod\xe8le d'H\xf4te ",(0,a.kt)("em",{parentName:"li"},"Cloud-Aws-Vpn-custom"),"."),(0,a.kt)("li",{parentName:"ul"},"Une fois le mod\xe8le appliqu\xe9, les Macros ci-dessous indiqu\xe9es comme requises (",(0,a.kt)("em",{parentName:"li"},"Mandatory"),") doivent \xeatre renseign\xe9es:")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Mandatory"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Nom"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"X"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"AWSSECRETKEY"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"AWS Secret key of your IAM role. Password checkbox must be checked")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"X"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"AWSACESSKEY"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"AWS Access key of your IAM role. Password checkbox must be checked")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"X"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"AWSREGION"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Region where the instance is running")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"X"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"AWSCUSTOMMODE"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Custom mode to get metrics, 'awscli' is the default, you can also use 'paws' perl library")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"})),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"PROXYURL"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Configure proxy URL")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"})),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"EXTRAOPTIONS"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Any extra option you may want to add to every command","_","line (eg. a --verbose flag)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"})),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"DUMMYSTATUS"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Host state. Default is OK, do not modify it unless you know what you are doing")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"})),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"DUMMYOUTPUT"),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Host check output. Default is 'This is a dummy check'. Customize it with your own if needed")))),(0,a.kt)("h2",i({},{id:"faq"}),"FAQ"),(0,a.kt)("h3",i({},{id:"comment-tester-un-contr\xf4le-en-ligne-de-commande-et-que-signifient-les-options-principales-"}),"Comment tester un contr\xf4le en ligne de commande et que signifient les options principales ?"),(0,a.kt)("p",null,"Une fois le Plugin install\xe9, vous pouvez tester celui-ci directement en ligne de commande depuis votre collecteur Centreon en vous\nconnectant avec l'utilisateur ",(0,a.kt)("em",{parentName:"p"},"centreon-engine")," (certaines options comme ",(0,a.kt)("inlineCode",{parentName:"p"},"--proxyurl")," doivent \xeatre ajust\xe9es en fonction du contexte):"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"/usr/lib/centreon/plugins//centreon_aws_vpn_api.pl \\\n    --plugin=cloud::aws::vpn::plugin \\\n    --mode=traffic \\\n    --custommode='awscli' \\\n    --aws-secret-key='*******************' \\\n    --aws-access-key='**********' \\\n    --region='eu-west-1' \\\n    --proxyurl='http://myproxy.mycompany.org:8080' \\\n    --filter-vpn='vpn-123abc456def789gh' \\\n    --filter-metric='' \\\n    --statistic='average' \\\n    --timeframe='600' \\\n    --period='60' \\\n    --warning-tunnel-state='1:' \\\n    --critical-tunnel-state='0.5:'\n    --verbose\n")),(0,a.kt)("p",null,"La commande devrait retourner un message de sortie de la forme ci-dessous : "),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{}),"OK: 'vpn-123abc456def789gh' Statistic 'Average' Metrics Tunnel Data Out: 328.69 KB, Tunnel State: 1.00, Tunnel Data In: 715.10 KB | 'vpn-123abc456def789gh~average#vpn.tunnel.dataout.bytes'=336576.82B;;;;\n'vpn-123abc456def789gh~average#vpn.tunnel.tunnelstate'=1.00;1:;0.5:;; 'vpn-123abc456def789gh~average#vpn.tunnel.datain.bytes'=732257.42B;;;;\n")),(0,a.kt)("p",null,"La commande ci-dessus contr\xf4le le trafic et le statut (",(0,a.kt)("inlineCode",{parentName:"p"},"--mode=traffic"),") du lien VPN dont l'ID est  ",(0,a.kt)("em",{parentName:"p"},"vpn-123abc456def789gh")," (",(0,a.kt)("inlineCode",{parentName:"p"},"--name='vpn-123abc456def789gh'"),").\nCe lien VPN est rattach\xe9 \xe0 une ressource h\xe9berg\xe9e dans la r\xe9gion AWS ",(0,a.kt)("em",{parentName:"p"},"eu-west-1")," (",(0,a.kt)("inlineCode",{parentName:"p"},"--region='eu-west-1'"),").\nLa m\xe9trique obtenue est une moyenne de valeurs (",(0,a.kt)("inlineCode",{parentName:"p"},"--statistic='average'"),") sur un intervalle de 10 minutes / 600 secondes  (",(0,a.kt)("inlineCode",{parentName:"p"},"--timeframe='600'"),")\navec un point par minute / 60 secondes (",(0,a.kt)("inlineCode",{parentName:"p"},"--period='60'"),")."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Remarque: il est possible de filtrer et d'afficher les r\xe9sultats en utilisant la d\xe9nomination des ",(0,a.kt)("em",{parentName:"p"},"liens VPN")," plut\xf4t que l'ID.\nPour cela, ajoutez simplement le param\xe8tre ",(0,a.kt)("inlineCode",{parentName:"p"},"--name")," \xe0 la commande.")),(0,a.kt)("p",null,"Dans cet exemple, une alarme WARNING sera d\xe9clench\xe9e si le statut bool\xe9en du lien est inf\xe9rieur \xe0 1; l'alarme sera de type CRITICAL s'il est inf\xe9rieur \xe0 0.5.\nLes liens AWS VPN Site-To-Site peuvent en effet disposer de plusieurs tunnels sur diff\xe9rentes passerelles. Le Plugin r\xe9cup\xe8re ici la valeur moyenne de l'\xe9tat de tous les tunnels."),(0,a.kt)("p",null,"La liste de toutes les m\xe9triques, seuils associ\xe9s et options compl\xe9mentairespeut \xeatre affich\xe9e en ajoutant le param\xe8tre ",(0,a.kt)("inlineCode",{parentName:"p"},"--help")," \xe0 la commande:"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"/usr/lib/centreon/plugins/centreon_aws_vpn_api.pl \\\n    --plugin=cloud::aws::vpn::plugin \\\n    --mode=traffic \\\n    --help\n")),(0,a.kt)("h3",i({},{id:"jobtiens-le-message-derreur-suivant"}),"J'obtiens le message d'erreur suivant:"),(0,a.kt)("h4",i({},{id:"unknown-no-metrics-check-your-options-or-use---zeroed-option-to-set-0-on-undefined-values"}),(0,a.kt)("inlineCode",{parentName:"h4"},"UNKNOWN: No metrics. Check your options or use --zeroed option to set 0 on undefined values")),(0,a.kt)("p",null,"Lors du d\xe9ploiement de mes contr\xf4les, j'obtiens le message suivant 'UNKNOWN: No metrics. Check your options or use --zeroed option to set 0 on undefined values'."),(0,a.kt)("p",null,"Cela signifie qu'Amazon Cloudwatch n'a pas consolid\xe9 de donn\xe9es sur la p\xe9riode.\nVous pouvez ajouter ",(0,a.kt)("inlineCode",{parentName:"p"},"--zeroed")," \xe0 la macro ",(0,a.kt)("strong",{parentName:"p"},"EXTRAOPTIONS")," du ",(0,a.kt)("em",{parentName:"p"},"Service")," en question afin de forcer le stockage d'un 0 et ainsi \xe9viter un statut UNKNOWN."),(0,a.kt)("h4",i({},{id:"unknown-command-error----an-error-occurred-authfailure-"}),(0,a.kt)("inlineCode",{parentName:"h4"},"UNKNOWN: Command error:  - An error occurred (AuthFailure) [...]")),(0,a.kt)("p",null,"Cette erreur signifie que le r\xf4le IAM associ\xe9 au combo access-key/secret-key n'a pas les droits suffisants pour r\xe9aliser une op\xe9ration donn\xe9e."),(0,a.kt)("h4",i({},{id:"unknown-500-cant-connect-to-monitoringeu-west-1amazonawscom443-"}),(0,a.kt)("inlineCode",{parentName:"h4"},"UNKNOWN: 500 Can't connect to monitoring.eu-west-1.amazonaws.com:443 |")),(0,a.kt)("p",null,"Lors du d\xe9ploiement de mes contr\xf4les, j'obtiens le message suivant : ",(0,a.kt)("inlineCode",{parentName:"p"},"UNKNOWN: 500 Can't connect to monitoring.eu-west-1.amazonaws.com:443 |"),"."),(0,a.kt)("p",null,"Cela signifie que Centreon n'a pas r\xe9ussi \xe0 se connecter \xe0 l'API AWS Cloudwatch."),(0,a.kt)("p",null,"Si l'utilisation d'un proxy est requise pour les connexions HTTP depuis le collecteur Centreon, il est n\xe9cessaire de le pr\xe9ciser dans la commande en\nutilisant l'option ",(0,a.kt)("inlineCode",{parentName:"p"},"--proxyurl='http://proxy.mycompany.com:8080'"),"."))}k.isMDXComponent=!0},7626:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(67294),r=n(86010);const l="tabItem_Ymn6";function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i.apply(this,arguments)}function o({children:e,hidden:t,className:n}){return a.createElement("div",i({role:"tabpanel",className:(0,r.Z)(l,n)},{hidden:t}),e)}},67709:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(67294),r=n(86010),l=n(90980),i=n(35715),o=n(8854),s=n(8241);const u="tabList__CuJ",p="tabItem_LNqP";function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},c.apply(this,arguments)}function d(e){var t;const{lazy:n,block:l,defaultValue:d,values:m,groupId:k,className:f}=e,v=a.Children.map(e.children,(e=>{if((0,a.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),g=null!=m?m:v.map((({props:{value:e,label:t,attributes:n}})=>({value:e,label:t,attributes:n}))),N=(0,i.l)(g,((e,t)=>e.value===t.value));if(N.length>0)throw new Error(`Docusaurus error: Duplicate values "${N.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);var b;const h=null===d?d:null!==(b=null!=d?d:null===(t=v.find((e=>e.props.default)))||void 0===t?void 0:t.props.value)&&void 0!==b?b:v[0].props.value;if(null!==h&&!g.some((e=>e.value===h)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${h}" but none of its children has the corresponding value. Available values are: ${g.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:y,setTabGroupChoices:w}=(0,o.U)(),[P,C]=(0,a.useState)(h),O=[],{blockElementScrollPositionUntilNextRender:S}=(0,s.o5)();if(null!=k){const e=y[k];null!=e&&e!==P&&g.some((t=>t.value===e))&&C(e)}const A=e=>{const t=e.currentTarget,n=O.indexOf(t),a=g[n].value;a!==P&&(S(t),C(a),null!=k&&w(k,String(a)))},T=e=>{let t=null;switch(e.key){case"ArrowRight":{const a=O.indexOf(e.currentTarget)+1;var n;t=null!==(n=O[a])&&void 0!==n?n:O[0];break}case"ArrowLeft":{const n=O.indexOf(e.currentTarget)-1;var a;t=null!==(a=O[n])&&void 0!==a?a:O[O.length-1];break}}null==t||t.focus()};return a.createElement("div",{className:(0,r.Z)("tabs-container",u)},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":l},f)},g.map((({value:e,label:t,attributes:n})=>a.createElement("li",c({role:"tab",tabIndex:P===e?0:-1,"aria-selected":P===e,key:e,ref:e=>O.push(e),onKeyDown:T,onFocus:A,onClick:A},n,{className:(0,r.Z)("tabs__item",p,null==n?void 0:n.className,{"tabs__item--active":P===e})}),null!=t?t:e)))),n?(0,a.cloneElement)(v.filter((e=>e.props.value===P))[0],{className:"margin-top--md"}):a.createElement("div",{className:"margin-top--md"},v.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==P})))))}function m(e){const t=(0,l.Z)();return a.createElement(d,c({key:String(t)},e))}}}]);