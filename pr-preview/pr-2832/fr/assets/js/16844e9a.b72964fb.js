"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[94798],{3905:(e,n,r)=>{r.d(n,{Zo:()=>c,kt:()=>m});var t=r(67294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function l(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=t.createContext({}),u=function(e){var n=t.useContext(i),r=n;return e&&(r="function"==typeof e?e(n):s(s({},n),e)),r},c=function(e){var n=u(e.components);return t.createElement(i.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=u(r),m=a,v=d["".concat(i,".").concat(m)]||d[m]||p[m]||o;return r?t.createElement(v,s(s({ref:n},c),{},{components:r})):t.createElement(v,s({ref:n},c))}));function m(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=r.length,s=new Array(o);s[0]=d;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l.mdxType="string"==typeof e?e:a,s[1]=l;for(var u=2;u<o;u++)s[u]=r[u];return t.createElement.apply(null,s)}return t.createElement.apply(null,r)}d.displayName="MDXCreateElement"},7626:(e,n,r)=>{r.d(n,{Z:()=>l});var t=r(67294),a=r(86010);const o="tabItem_Ymn6";function s(){return s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},s.apply(this,arguments)}function l({children:e,hidden:n,className:r}){return t.createElement("div",s({role:"tabpanel",className:(0,a.Z)(o,r)},{hidden:n}),e)}},67709:(e,n,r)=>{r.d(n,{Z:()=>m});var t=r(67294),a=r(86010),o=r(90980),s=r(35715),l=r(8854),i=r(8241);const u="tabList__CuJ",c="tabItem_LNqP";function p(){return p=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},p.apply(this,arguments)}function d(e){var n;const{lazy:r,block:o,defaultValue:d,values:m,groupId:v,className:f}=e,b=t.Children.map(e.children,(e=>{if((0,t.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),g=null!=m?m:b.map((({props:{value:e,label:n,attributes:r}})=>({value:e,label:n,attributes:r}))),k=(0,s.l)(g,((e,n)=>e.value===n.value));if(k.length>0)throw new Error(`Docusaurus error: Duplicate values "${k.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);var h;const y=null===d?d:null!==(h=null!=d?d:null===(n=b.find((e=>e.props.default)))||void 0===n?void 0:n.props.value)&&void 0!==h?h:b[0].props.value;if(null!==y&&!g.some((e=>e.value===y)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${y}" but none of its children has the corresponding value. Available values are: ${g.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:j,setTabGroupChoices:N}=(0,l.U)(),[O,w]=(0,t.useState)(y),x=[],{blockElementScrollPositionUntilNextRender:E}=(0,i.o5)();if(null!=v){const e=j[v];null!=e&&e!==O&&g.some((n=>n.value===e))&&w(e)}const C=e=>{const n=e.currentTarget,r=x.indexOf(n),t=g[r].value;t!==O&&(E(n),w(t),null!=v&&N(v,String(t)))},T=e=>{let n=null;switch(e.key){case"ArrowRight":{const t=x.indexOf(e.currentTarget)+1;var r;n=null!==(r=x[t])&&void 0!==r?r:x[0];break}case"ArrowLeft":{const r=x.indexOf(e.currentTarget)-1;var t;n=null!==(t=x[r])&&void 0!==t?t:x[x.length-1];break}}null==n||n.focus()};return t.createElement("div",{className:(0,a.Z)("tabs-container",u)},t.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":o},f)},g.map((({value:e,label:n,attributes:r})=>t.createElement("li",p({role:"tab",tabIndex:O===e?0:-1,"aria-selected":O===e,key:e,ref:e=>x.push(e),onKeyDown:T,onFocus:C,onClick:C},r,{className:(0,a.Z)("tabs__item",c,null==r?void 0:r.className,{"tabs__item--active":O===e})}),null!=n?n:e)))),r?(0,t.cloneElement)(b.filter((e=>e.props.value===O))[0],{className:"margin-top--md"}):t.createElement("div",{className:"margin-top--md"},b.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==O})))))}function m(e){const n=(0,o.Z)();return t.createElement(d,p({key:String(n)},e))}},84574:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>p,contentTitle:()=>u,default:()=>v,frontMatter:()=>i,metadata:()=>c,toc:()=>d});r(67294);var t=r(3905),a=r(67709),o=r(7626);function s(){return s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},s.apply(this,arguments)}function l(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const i={id:"update-centreon-ha",title:"Mise \xe0 jour d'une plateforme Centreon-HA"},u=void 0,c={unversionedId:"update/update-centreon-ha",id:"version-23.10/update/update-centreon-ha",title:"Mise \xe0 jour d'une plateforme Centreon-HA",description:"La proc\xe9dure suivante est \xe0 utiliser lors de l'application d'une mise \xe0 jour mineure sur un cluster Centreon-HA install\xe9 suivant cette documentation, dans le cas o\xf9 il n'y a pas de rupture de compatibilit\xe9 Engine/broker entre l'ancienne et la nouvelle version. Celle-ci peut se faire sans interrompre la supervision, mais en rendant l'interface indisponible pendant un court instant.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-23.10/update/update-centreon-ha.md",sourceDirName:"update",slug:"/update/update-centreon-ha",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/docs/update/update-centreon-ha",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/next/i18n/fr/docusaurus-plugin-content-docs/version-23.10/update/update-centreon-ha.md",tags:[],version:"23.10",lastUpdatedAt:1700565273,formattedLastUpdatedAt:"21 nov. 2023",frontMatter:{id:"update-centreon-ha",title:"Mise \xe0 jour d'une plateforme Centreon-HA"},sidebar:"version-23.10/docs",previous:{title:"D\xe9panner Centreon-HA",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/docs/administration/centreon-ha/troubleshooting-guide"},next:{title:"Mont\xe9e de version de Centreon HA depuis Centreon 21.04",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/docs/upgrade/centreon-ha/upgrade-centreon-ha-from-21-04"}},p={},d=[{value:"Suspension de la gestion des resources par le cluster",id:"suspension-de-la-gestion-des-resources-par-le-cluster",level:2},{value:"D\xe9roulement de la mise \xe0 jour",id:"d\xe9roulement-de-la-mise-\xe0-jour",level:2},{value:"Mise \xe0 jour de Centreon-Web",id:"mise-\xe0-jour-de-centreon-web",level:3},{value:"Suppression des crons",id:"suppression-des-crons",level:3},{value:"Mise \xe0 jour des extensions",id:"mise-\xe0-jour-des-extensions",level:3},{value:"Mise \xe0 jour des connecteurs de supervision",id:"mise-\xe0-jour-des-connecteurs-de-supervision",level:3},{value:"Mise \xe0 jour des pollers",id:"mise-\xe0-jour-des-pollers",level:3},{value:"Export de la configuration Broker/Engine",id:"export-de-la-configuration-brokerengine",level:3},{value:"R\xe9tablissement de la gestion des ressources par le cluster",id:"r\xe9tablissement-de-la-gestion-des-ressources-par-le-cluster",level:2},{value:"V\xe9rification de la stabilit\xe9 de la plateforme",id:"v\xe9rification-de-la-stabilit\xe9-de-la-plateforme",level:2}],m={toc:d};function v(e){var{components:n}=e,r=l(e,["components"]);return(0,t.kt)("wrapper",s({},m,r,{components:n,mdxType:"MDXLayout"}),(0,t.kt)("p",null,"La proc\xe9dure suivante est \xe0 utiliser lors de l'application d'une mise \xe0 jour mineure sur un cluster Centreon-HA install\xe9 suivant ",(0,t.kt)("a",s({parentName:"p"},{href:"/centreon-documentation/pr-preview/pr-2832/fr/docs/installation/installation-of-centreon-ha/installation-2-nodes"}),"cette documentation"),", dans le cas o\xf9 il n'y a pas de rupture de compatibilit\xe9 Engine/broker entre l'ancienne et la nouvelle version. Celle-ci peut se faire sans interrompre la supervision, mais en rendant l'interface indisponible pendant un court instant."),(0,t.kt)("h2",s({},{id:"suspension-de-la-gestion-des-resources-par-le-cluster"}),"Suspension de la gestion des resources par le cluster"),(0,t.kt)("p",null,"Cette op\xe9ration n\xe9cessite de suspendre la gestion des ressources Centreon et MariaDB par le cluster pour \xe9viter qu'une bascule se produise en pleine mise \xe0 jour."),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"pcs resource unmanage centreon\npcs resource unmanage ms_mysql\n")),(0,t.kt)("h2",s({},{id:"d\xe9roulement-de-la-mise-\xe0-jour"}),"D\xe9roulement de la mise \xe0 jour"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"Assurez-vous que tous les utilisateurs sont d\xe9connect\xe9s avant de commencer\nla proc\xe9dure de mise \xe0 jour.")),(0,t.kt)("h3",s({},{id:"mise-\xe0-jour-de-centreon-web"}),"Mise \xe0 jour de Centreon-Web"),(0,t.kt)("p",null,"Lancer la mise \xe0 jour sur les deux serveurs centraux :"),(0,t.kt)(a.Z,{groupId:"sync",mdxType:"Tabs"},(0,t.kt)(o.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"dnf update\n")))),(0,t.kt)("p",null,"Une fois les mises \xe0 jour termin\xe9es sur les deux serveurs, il reste \xe0 appliquer la mise \xe0 jour via l'interface web en fermant la session en cours ou en rafraichissant la page de login."),(0,t.kt)("p",null,'En parall\xe8le, sur le central "esclave", il faut d\xe9placer le r\xe9pertoire "install" pour \xe9viter d\'afficher \xe0 nouveau l\'interface de mise \xe0 jour suite \xe0 une bascule et reg\xe9n\xe9rer le cache Symfony :'),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"mv /usr/share/centreon/www/install /var/lib/centreon/installs/install-update-YYYY-MM-DD\nsudo -u apache /usr/share/centreon/bin/console cache:clear\n")),(0,t.kt)("h3",s({},{id:"suppression-des-crons"}),"Suppression des crons"),(0,t.kt)("p",null,"Les crons sont remis en place lors de la mise \xe0 jour des RPMs. Supprimer les sur les deux noeuds centraux afin d'\xe9viter les executions concurrentes."),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"rm /etc/cron.d/centreon\nrm /etc/cron.d/centstorage\nrm /etc/cron.d/centreon-auto-disco\n")),(0,t.kt)("h3",s({},{id:"mise-\xe0-jour-des-extensions"}),"Mise \xe0 jour des extensions"),(0,t.kt)("p",null,"Les extensions (ou modules) Centreon n\xe9cessitent \xe9galement d'\xeatre mis \xe0 jour ",(0,t.kt)("em",{parentName:"p"},"via"),' l\'interface, depuis le menu "Administration > Extensions > Gestionnaire" en utilisant le bouton "Update all".'),(0,t.kt)("h3",s({},{id:"mise-\xe0-jour-des-connecteurs-de-supervision"}),"Mise \xe0 jour des connecteurs de supervision"),(0,t.kt)("p",null,"Afin de maintenir la compatibilit\xe9 entre les ",(0,t.kt)("a",s({parentName:"p"},{href:"/centreon-documentation/pr-preview/pr-2832/fr/docs/monitoring/pluginpacks"}),"connecteurs de supervision")," et les plugins install\xe9s (qui  ont \xe9t\xe9 mis \xe0 jour sur les serveurs centraux par la commande ",(0,t.kt)("inlineCode",{parentName:"p"},"yum update"),") il faut appliquer les mises \xe0 jour des connecteurs de supervision depuis le menu ",(0,t.kt)("strong",{parentName:"p"},"Configuration > Gestionnaire de connecteurs de supervision"),"."),(0,t.kt)("h3",s({},{id:"mise-\xe0-jour-des-pollers"}),"Mise \xe0 jour des pollers"),(0,t.kt)("p",null,"Il est recommand\xe9 de mettre \xe9galement \xe0 jour les pollers Centreon, ",(0,t.kt)("strong",{parentName:"p"},"en particulier dans le cas o\xf9 les paquets ",(0,t.kt)("inlineCode",{parentName:"strong"},"centreon-engine")," et/ou ",(0,t.kt)("inlineCode",{parentName:"strong"},"centreon-broker")," ont \xe9t\xe9 mis \xe0 jour"),"."),(0,t.kt)(a.Z,{groupId:"sync",mdxType:"Tabs"},(0,t.kt)(o.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"dnf update\n")))),(0,t.kt)("h3",s({},{id:"export-de-la-configuration-brokerengine"}),"Export de la configuration Broker/Engine"),(0,t.kt)("p",null,'G\xe9n\xe9rer une nouvelle configuration pour tous les pollers (central compris) via le menu "Configuration -> Pollers" en cochant les options :'),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"G\xe9n\xe9rer les fichiers de configuration"),(0,t.kt)("li",{parentName:"ul"},"Lancer le d\xe9bogage du moteur de supervision (-v)"),(0,t.kt)("li",{parentName:"ul"},"Deplacer les fichiers g\xe9n\xe9r\xe9s")),(0,t.kt)("p",null,"Puis les red\xe9marrer ",(0,t.kt)("strong",{parentName:"p"},"un \xe0 un"),' \xe0 partir du m\xeame menu, en s\xe9lectionnant l\'option "Red\xe9marrer" plut\xf4t que "Recharger" dans le cas o\xf9 les paquets ',(0,t.kt)("inlineCode",{parentName:"p"},"centreon-engine")," et/ou ",(0,t.kt)("inlineCode",{parentName:"p"},"centreon-broker")," ont \xe9t\xe9 mis \xe0 jour."),(0,t.kt)("p",null,"En compl\xe9ment, dans le cas o\xf9 ",(0,t.kt)("inlineCode",{parentName:"p"},"centreon-broker")," a \xe9t\xe9 mis \xe0 jour, il faut red\xe9marrer le broker central ",(0,t.kt)("strong",{parentName:"p"},"sur le serveur central ma\xeetre")," :"),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"service cbd-sql restart\n")),(0,t.kt)("p",null,"Dans le cas o\xf9 des ",(0,t.kt)("a",s({parentName:"p"},{href:"/centreon-documentation/pr-preview/pr-2832/fr/docs/installation/architectures#description"}),"Remote Servers")," seraient pr\xe9sents, il faut y red\xe9marrer le service ",(0,t.kt)("inlineCode",{parentName:"p"},"cbd")," :"),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"service cbd restart\n")),(0,t.kt)("h2",s({},{id:"r\xe9tablissement-de-la-gestion-des-ressources-par-le-cluster"}),"R\xe9tablissement de la gestion des ressources par le cluster"),(0,t.kt)("p",null,"Tous les composants devraient \xe0 pr\xe9sent \xeatre \xe0 jour et fonctionnels, il faut donc r\xe9tablir la gestion des ressources par le cluster :"),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"pcs resource manage centreon\npcs resource manage ms_mysql\n")),(0,t.kt)("h2",s({},{id:"v\xe9rification-de-la-stabilit\xe9-de-la-plateforme"}),"V\xe9rification de la stabilit\xe9 de la plateforme"),(0,t.kt)("p",null,"Il est toujours recommand\xe9, apr\xe8s une mise \xe0 jour, de contr\xf4ler que tout fonctionne bien :"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Acc\xe8s aux menus dans l'interface."),(0,t.kt)("li",{parentName:"ul"},"G\xe9n\xe9ration de configuration + reload ou restart de Centreon Engine"),(0,t.kt)("li",{parentName:"ul"},'Plannifier un contr\xf4le imm\xe9diat dans le menu "Monitoring" et contr\xf4ler que c\'est bien pris en compte (dans un d\xe9lai raisonnable). Faire de m\xeame avec un acquittement, un arr\xeat pr\xe9vu...'),(0,t.kt)("li",{parentName:"ul"},"Migrer une ressource ou un groupe de ressources d'un n\u0153ud \xe0 l'autre, rebooter un serveur ma\xeetre et contr\xf4ler que tout continue de fonctionner (refaire le tests ci-dessus).")))}v.isMDXComponent=!0}}]);