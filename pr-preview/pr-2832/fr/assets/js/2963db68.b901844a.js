"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[45955],{3905:(e,n,r)=>{r.d(n,{Zo:()=>i,kt:()=>m});var t=r(67294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function l(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var u=t.createContext({}),c=function(e){var n=t.useContext(u),r=n;return e&&(r="function"==typeof e?e(n):s(s({},n),e)),r},i=function(e){var n=c(e.components);return t.createElement(u.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},p=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,i=l(e,["components","mdxType","originalType","parentName"]),p=c(r),m=a,b=p["".concat(u,".").concat(m)]||p[m]||d[m]||o;return r?t.createElement(b,s(s({ref:n},i),{},{components:r})):t.createElement(b,s({ref:n},i))}));function m(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=r.length,s=new Array(o);s[0]=p;var l={};for(var u in n)hasOwnProperty.call(n,u)&&(l[u]=n[u]);l.originalType=e,l.mdxType="string"==typeof e?e:a,s[1]=l;for(var c=2;c<o;c++)s[c]=r[c];return t.createElement.apply(null,s)}return t.createElement.apply(null,r)}p.displayName="MDXCreateElement"},7626:(e,n,r)=>{r.d(n,{Z:()=>l});var t=r(67294),a=r(86010);const o="tabItem_Ymn6";function s(){return s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},s.apply(this,arguments)}function l({children:e,hidden:n,className:r}){return t.createElement("div",s({role:"tabpanel",className:(0,a.Z)(o,r)},{hidden:n}),e)}},67709:(e,n,r)=>{r.d(n,{Z:()=>m});var t=r(67294),a=r(86010),o=r(90980),s=r(35715),l=r(8854),u=r(8241);const c="tabList__CuJ",i="tabItem_LNqP";function d(){return d=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},d.apply(this,arguments)}function p(e){var n;const{lazy:r,block:o,defaultValue:p,values:m,groupId:b,className:E}=e,f=t.Children.map(e.children,(e=>{if((0,t.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),v=null!=m?m:f.map((({props:{value:e,label:n,attributes:r}})=>({value:e,label:n,attributes:r}))),g=(0,s.l)(v,((e,n)=>e.value===n.value));if(g.length>0)throw new Error(`Docusaurus error: Duplicate values "${g.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);var N;const h=null===p?p:null!==(N=null!=p?p:null===(n=f.find((e=>e.props.default)))||void 0===n?void 0:n.props.value)&&void 0!==N?N:f[0].props.value;if(null!==h&&!v.some((e=>e.value===h)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${h}" but none of its children has the corresponding value. Available values are: ${v.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:A,setTabGroupChoices:y}=(0,l.U)(),[_,T]=(0,t.useState)(h),S=[],{blockElementScrollPositionUntilNextRender:C}=(0,u.o5)();if(null!=b){const e=A[b];null!=e&&e!==_&&v.some((n=>n.value===e))&&T(e)}const L=e=>{const n=e.currentTarget,r=S.indexOf(n),t=v[r].value;t!==_&&(C(n),T(t),null!=b&&y(b,String(t)))},k=e=>{let n=null;switch(e.key){case"ArrowRight":{const t=S.indexOf(e.currentTarget)+1;var r;n=null!==(r=S[t])&&void 0!==r?r:S[0];break}case"ArrowLeft":{const r=S.indexOf(e.currentTarget)-1;var t;n=null!==(t=S[r])&&void 0!==t?t:S[S.length-1];break}}null==n||n.focus()};return t.createElement("div",{className:(0,a.Z)("tabs-container",c)},t.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":o},E)},v.map((({value:e,label:n,attributes:r})=>t.createElement("li",d({role:"tab",tabIndex:_===e?0:-1,"aria-selected":_===e,key:e,ref:e=>S.push(e),onKeyDown:k,onFocus:L,onClick:L},r,{className:(0,a.Z)("tabs__item",i,null==r?void 0:r.className,{"tabs__item--active":_===e})}),null!=n?n:e)))),r?(0,t.cloneElement)(f.filter((e=>e.props.value===_))[0],{className:"margin-top--md"}):t.createElement("div",{className:"margin-top--md"},f.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==_})))))}function m(e){const n=(0,o.Z)();return t.createElement(p,d({key:String(n)},e))}},51270:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>b,frontMatter:()=>u,metadata:()=>i,toc:()=>p});r(67294);var t=r(3905),a=r(67709),o=r(7626);function s(){return s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},s.apply(this,arguments)}function l(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const u={id:"troubleshooting-guide",title:"D\xe9panner Centreon-HA"},c=void 0,i={unversionedId:"administration/centreon-ha/troubleshooting-guide",id:"version-23.10/administration/centreon-ha/troubleshooting-guide",title:"D\xe9panner Centreon-HA",description:"Une ressource ne d\xe9marre pas",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-23.10/administration/centreon-ha/troubleshooting-guide.md",sourceDirName:"administration/centreon-ha",slug:"/administration/centreon-ha/troubleshooting-guide",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/docs/administration/centreon-ha/troubleshooting-guide",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/next/i18n/fr/docusaurus-plugin-content-docs/version-23.10/administration/centreon-ha/troubleshooting-guide.md",tags:[],version:"23.10",lastUpdatedAt:1700565273,formattedLastUpdatedAt:"21 nov. 2023",frontMatter:{id:"troubleshooting-guide",title:"D\xe9panner Centreon-HA"},sidebar:"version-23.10/docs",previous:{title:"Guide d'exploitation du cluster",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/docs/administration/centreon-ha/operating-guide"},next:{title:"Mise \xe0 jour d'une plateforme Centreon-HA",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/docs/update/update-centreon-ha"}},d={},p=[{value:"Une ressource ne d\xe9marre pas",id:"une-ressource-ne-d\xe9marre-pas",level:2},{value:"Une ressource ou un groupe de ressources ne d\xe9marre sur aucun des n\u0153uds",id:"une-ressource-ou-un-groupe-de-ressources-ne-d\xe9marre-sur-aucun-des-n\u0153uds",level:2}],m={toc:p};function b(e){var{components:n}=e,r=l(e,["components"]);return(0,t.kt)("wrapper",s({},m,r,{components:n,mdxType:"MDXLayout"}),(0,t.kt)("h2",s({},{id:"une-ressource-ne-d\xe9marre-pas"}),"Une ressource ne d\xe9marre pas"),(0,t.kt)("p",null,"Si une ressource (par exemple une ressource du groupe centreon) ne d\xe9marre pas correctement, des ",(0,t.kt)("em",{parentName:"p"},"failed actions")," appara\xeetront dans ",(0,t.kt)("inlineCode",{parentName:"p"},"crm_mon"),". Par exemple ci-dessous, ",(0,t.kt)("inlineCode",{parentName:"p"},"centreontrapd")," a rencontr\xe9 une erreur :"),(0,t.kt)(a.Z,{groupId:"sync",mdxType:"Tabs"},(0,t.kt)(o.Z,{value:"RHEL 8 / Oracle Linux 8",label:"RHEL 8 / Oracle Linux 8",mdxType:"TabItem"},(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"Cluster Summary:\n  * Stack: corosync\n  * Current DC: @CENTRAL_MASTER_NAME@ (version 2.0.5-9.0.1.el8_4.1-ba59be7122) - partition with quorum\n  * Last updated: Wed Sep 15 16:35:47 2021\n  * Last change:  Wed Sep 15 10:41:50 2021 by root via crm_attribute on @CENTRAL_MASTER_NAME@\n  * 2 nodes configured\n  * 14 resource instances configured\nNode List:\n  * Online: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]\nFull List of Resources:\n  * Clone Set: ms_mysql-clone [ms_mysql] (promotable):\n    * Masters: [ @CENTRAL_MASTER_NAME@ ]\n    * Slaves: [ @CENTRAL_SLAVE_NAME@ ]\n  * Clone Set: php-clone [php]:\n    * Started: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]\n  * Clone Set: cbd_rrd-clone [cbd_rrd]:\n    * Started: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]\n  * Resource Group: centreon:\n    * vip       (ocf::heartbeat:IPaddr2):        Started @CENTRAL_MASTER_NAME@\n    * http      (systemd:httpd):         Started @CENTRAL_MASTER_NAME@\n    * gorgone   (systemd:gorgoned):      Started @CENTRAL_MASTER_NAME@\n    * centreon_central_sync     (systemd:centreon-central-sync):         Started @CENTRAL_MASTER_NAME@\n    * cbd_central_broker        (systemd:cbd-sql):       Started @CENTRAL_MASTER_NAME@\n    * centengine        (systemd:centengine):    Started @CENTRAL_MASTER_NAME@\n    * centreontrapd     (systemd:centreontrapd):         Stopped\n    * snmptrapd (systemd:snmptrapd):     Stopped\n\nFailed Resource Actions:\n* centreontrapd_start_0 on @CENTRAL_MASTER_NAME@ 'not running' (7): call=82, status=complete, exitreason='',\n    last-rc-change='Wed Sep 15 13:42:19 2021', queued=1ms, exec=2122ms\n")))),(0,t.kt)("p",null,"Afin d'avoir plus d'informations sur la cause de cette panne, se connecter via SSH au n\u0153ud ma\xeetre (celui o\xf9 la ressource devrait tourner) et lancer la commande suivante :"),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"systemctl status centreontrapd -l\n")),(0,t.kt)("p",null,"Si jamais la sortie de cette commande ne suffit pas, il est possible d'en savoir plus via la commande "),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"pcs resource debug-start centreontrapd\n")),(0,t.kt)("p",null,'Une fois la cause identifi\xe9e et corrig\xe9e, la commande \xe0 lancer pour que le cluster "oublie" ces erreurs et relance le service est :'),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"pcs resource cleanup centreontrapd\n")),(0,t.kt)("h2",s({},{id:"une-ressource-ou-un-groupe-de-ressources-ne-d\xe9marre-sur-aucun-des-n\u0153uds"}),"Une ressource ou un groupe de ressources ne d\xe9marre sur aucun des n\u0153uds"),(0,t.kt)("p",null,"Si suite \xe0 une bascule, qu'elle soit manuelle ou \xe0 cause d'une panne ou de l'arr\xeat d'un serveur, la situation suivante se produit :"),(0,t.kt)(a.Z,{groupId:"sync",mdxType:"Tabs"},(0,t.kt)(o.Z,{value:"RHEL 8 / Oracle Linux 8",label:"RHEL 8 / Oracle Linux 8",mdxType:"TabItem"},(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"Cluster Summary:\n  * Stack: corosync\n  * Current DC: @CENTRAL_MASTER_NAME@ (version 2.0.5-9.0.1.el8_4.1-ba59be7122) - partition with quorum\n  * Last updated: Wed Sep 15 16:35:47 2021\n  * Last change:  Wed Sep 15 10:41:50 2021 by root via crm_attribute on @CENTRAL_MASTER_NAME@\n  * 2 nodes configured\n  * 14 resource instances configured\nNode List:\n  * Online: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]\nFull List of Resources:\n  * Clone Set: ms_mysql-clone [ms_mysql] (promotable):\n    * Slaves: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]\n  * Clone Set: php-clone [php]:\n    * Started: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]\n  * Clone Set: cbd_rrd-clone [cbd_rrd]:\n    * Started: [ @CENTRAL_MASTER_NAME@ @CENTRAL_SLAVE_NAME@ ]\n")))),(0,t.kt)("p",null,"Aucune erreur n'est remont\xe9e, mais le groupe centreon n'appara\xeet plus, et aucune de ses ressources n'est donc d\xe9marr\xe9e. Ce cas de figure est g\xe9n\xe9ralement d\xfb \xe0 un enchainement de deux bascules (",(0,t.kt)("inlineCode",{parentName:"p"},"pcs resource move ..."),") sans avoir supprim\xe9 la contrainte par la suite. Pour le v\xe9rifier lancer:"),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"pcs constraint show\n")),(0,t.kt)(a.Z,{groupId:"sync",mdxType:"Tabs"},(0,t.kt)(o.Z,{value:"RHEL 8 / Oracle Linux 8",label:"RHEL 8 / Oracle Linux 8",mdxType:"TabItem"},(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"Location Constraints:\n    Disabled on: @CENTRAL_SLAVE_NAME@ (score:-INFINITY) (role: Started)\n    Disabled on: @CENTRAL_MASTER_NAME@ (score:-INFINITY) (role: Started)\nOrdering Constraints:\nColocation Constraints:\n  centreon with ms_mysql-clone (score:INFINITY) (rsc-role:Started) (with-rsc-role:Master)\n  ms_mysql-clone with centreon (score:INFINITY) (rsc-role:Master) (with-rsc-role:Started)\nTicket Constraints:\n")))),(0,t.kt)("p",null,'On constate que le groupe centreon n\'est plus "autoris\xe9" \xe0 d\xe9marrer sur aucun des n\u0153uds.'),(0,t.kt)("p",null,"Pour lib\xe9rer le groupe de ressources de ces contraintes, il faut lancer la commande :"),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"language-bash"}),"pcs resource clear centreon\n")),(0,t.kt)("p",null,"Les ressources devraient alors imm\xe9diatement se lancer."))}b.isMDXComponent=!0}}]);