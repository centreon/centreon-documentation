"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[19408],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=u(n),m=r,k=c["".concat(s,".").concat(m)]||c[m]||d[m]||l;return n?a.createElement(k,i(i({ref:t},p),{},{components:n})):a.createElement(k,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var u=2;u<l;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},68987:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>u,default:()=>k,frontMatter:()=>s,metadata:()=>p,toc:()=>c});n(67294);var a=n(3905),r=n(67709),l=n(7626);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i.apply(this,arguments)}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const s={id:"operatingsystems-linux-nrpe3",title:"Linux NRPE3"},u=void 0,p={unversionedId:"integrations/plugin-packs/procedures/operatingsystems-linux-nrpe3",id:"integrations/plugin-packs/procedures/operatingsystems-linux-nrpe3",title:"Linux NRPE3",description:"Vue d'ensemble",source:"@site/i18n/fr/docusaurus-plugin-content-docs-pp/current/integrations/plugin-packs/procedures/operatingsystems-linux-nrpe3.md",sourceDirName:"integrations/plugin-packs/procedures",slug:"/integrations/plugin-packs/procedures/operatingsystems-linux-nrpe3",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/pp/integrations/plugin-packs/procedures/operatingsystems-linux-nrpe3",draft:!1,tags:[],version:"current",frontMatter:{id:"operatingsystems-linux-nrpe3",title:"Linux NRPE3"},sidebar:"pp",previous:{title:"Linux NRPE",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/pp/integrations/plugin-packs/procedures/operatingsystems-linux-nrpe"},next:{title:"Linux SNMP",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/pp/integrations/plugin-packs/procedures/operatingsystems-linux-snmp"}},d={},c=[{value:"Vue d&#39;ensemble",id:"vue-densemble",level:2},{value:"Contenu du Plugin-Pack",id:"contenu-du-plugin-pack",level:2},{value:"Objets supervis\xe9s",id:"objets-supervis\xe9s",level:3},{value:"Types d&#39;\xe9quipements",id:"types-d\xe9quipements",level:4},{value:"M\xe9triques collect\xe9es",id:"m\xe9triques-collect\xe9es",level:3},{value:"Pr\xe9requis",id:"pr\xe9requis",level:2},{value:"Flux r\xe9seau",id:"flux-r\xe9seau",level:3},{value:"Installation de l&#39;agent NRPE packag\xe9 par Centreon et sonde Linux locale",id:"installation-de-lagent-nrpe-packag\xe9-par-centreon-et-sonde-linux-locale",level:3},{value:"Configuration de NRPE",id:"configuration-de-nrpe",level:3},{value:"Installation",id:"installation",level:2},{value:"Plugin-Pack",id:"plugin-pack",level:3},{value:"Centreon NRPE3 Plugin",id:"centreon-nrpe3-plugin",level:3},{value:"Validation de l&#39;ensemble des pr\xe9requis",id:"validation-de-lensemble-des-pr\xe9requis",level:3},{value:"Configuration de l&#39;h\xf4te dans Centreon",id:"configuration-de-lh\xf4te-dans-centreon",level:2},{value:"FAQ",id:"faq",level:2},{value:"Comment \xe7a marche ?",id:"comment-\xe7a-marche-",level:3},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"<code>connect to address x.x.x.x port 5666: Connection refused</code>",id:"connect-to-address-xxxx-port-5666-connection-refused",level:4},{value:"<code>CHECK_NRPE STATE CRITICAL: Socket timeout after 10 seconds</code>",id:"check_nrpe-state-critical-socket-timeout-after-10-seconds",level:4},{value:"<code>NRPE: Command &#39;my_command&#39; not defined</code>",id:"nrpe-command-my_command-not-defined",level:4}],m={toc:c};function k(e){var{components:t}=e,n=o(e,["components"]);return(0,a.kt)("wrapper",i({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",i({},{id:"vue-densemble"}),"Vue d'ensemble"),(0,a.kt)("p",null,"NRPE (Nagios Remote Plugin Executor) est un protocole qui a \xe9t\xe9 con\xe7u pour lancer \xe0 distance des commandes de supervision locales sur les serveurs supervis\xe9s. "),(0,a.kt)("p",null,"Ce pack de plugin repose sur 3 composants, qui sont d\xe9taill\xe9s dans le tableau ci-dessous."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:null}),"Composant"),(0,a.kt)("th",i({parentName:"tr"},{align:null}),"Type"),(0,a.kt)("th",i({parentName:"tr"},{align:null}),"Emplacement"),(0,a.kt)("th",i({parentName:"tr"},{align:null}),"R\xf4le"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:null}),(0,a.kt)("inlineCode",{parentName:"td"},"centreon_nrpe3_plugin")),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Binaire ex\xe9cutable"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Poller"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Transmet un nom de commande et des arguments associ\xe9s \xe0 celle-ci")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:null}),(0,a.kt)("inlineCode",{parentName:"td"},"centreon_linux_local.pl")),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Script Perl"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Serveur supervis\xe9"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"S'ex\xe9cute localement et retourne un statut, un message d'information et des m\xe9triques")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:null}),(0,a.kt)("inlineCode",{parentName:"td"},"centreon-nrpe3")),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Service/daemon"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Serveur supervis\xe9"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"\xc9coute sur le port 5666 et ex\xe9cute les commandes demand\xe9es si elles sont d\xe9finies dans sa configuration")))),(0,a.kt)("h2",i({},{id:"contenu-du-plugin-pack"}),"Contenu du Plugin-Pack"),(0,a.kt)("h3",i({},{id:"objets-supervis\xe9s"}),"Objets supervis\xe9s"),(0,a.kt)("h4",i({},{id:"types-d\xe9quipements"}),"Types d'\xe9quipements"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Serveur Linux CentOS 7 / RHEL7 (document\xe9 dans la pr\xe9sente proc\xe9dure)"),(0,a.kt)("li",{parentName:"ul"},"Serveur Linux d'autres distributions, \xe0 condition d'y installer manuellement le plugin et le ",(0,a.kt)("em",{parentName:"li"},"daemon")," NRPE3 (2e et 3e lignes du tableau ci-dessus).")),(0,a.kt)("h3",i({},{id:"m\xe9triques-collect\xe9es"}),"M\xe9triques collect\xe9es"),(0,a.kt)("p",null,"Seules les m\xe9triques sont d\xe9taill\xe9es dans cette section, mais sachez qu'un grand nombre de tests et de m\xe9triques peuvent \xeatre fournies par le Plugin ",(0,a.kt)("inlineCode",{parentName:"p"},"centreon_linux_local.pl"),". En voici une liste non exhaustive :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Cmd-Generic :  V\xe9rifier le retour d'une commande"),(0,a.kt)("li",{parentName:"ul"},"Connections-Generic : V\xe9rifier les connections TCP/UDP"),(0,a.kt)("li",{parentName:"ul"},"Cpu-Detailed : V\xe9rifier l'utilisation moyenne des CPU (User, Nice, System,\nIdle, Wait, Interrupt, SoftIRQ, Steal, Guest, GuestNice)"),(0,a.kt)("li",{parentName:"ul"},"Disk-Generic-Name : V\xe9rifier l'utilisation des disques (une seule partition)"),(0,a.kt)("li",{parentName:"ul"},"Disk-Global : V\xe9rifier l'utilisation des disques (toutes les partitions ou\nfiltrage par expression r\xe9guli\xe8re)"),(0,a.kt)("li",{parentName:"ul"},"Disk-IO-Generic-Name : V\xe9rifier les IO disques (une seule partition)"),(0,a.kt)("li",{parentName:"ul"},"Disk-IO-Global : V\xe9rifier les IO disques (toutes les partitions ou filtrage\npar expression r\xe9guli\xe8re)"),(0,a.kt)("li",{parentName:"ul"},"File-Date-Generic : V\xe9rifier la date (modification, cr\xe9ation) d'un fichier ou\nd'un r\xe9pertoire"),(0,a.kt)("li",{parentName:"ul"},"File-Size-Generic : V\xe9rifier la taille d'un fichier ou d'un r\xe9pertoire"),(0,a.kt)("li",{parentName:"ul"},"Inodes-Generic-Name : V\xe9rifier l'utilisation des inodes (une seule partition)"),(0,a.kt)("li",{parentName:"ul"},"Inodes-Global : V\xe9rifier l'utilisation des inodes (toutes les partitions ou\nfiltrage par expression r\xe9guli\xe8re)"),(0,a.kt)("li",{parentName:"ul"},"Is-File-Generic : V\xe9rifier la pr\xe9sence d'un fichier"),(0,a.kt)("li",{parentName:"ul"},"Is-Not-File-Generic : V\xe9rifier l'absence d'un fichier"),(0,a.kt)("li",{parentName:"ul"},"Packet-Errors-Generic-Name : V\xe9rifier le nomdre de paquets r\xe9seau en erreur\n(une seule interface)"),(0,a.kt)("li",{parentName:"ul"},"Packet-Errors-Global : V\xe9rifier le nomdre de paquets r\xe9seau en erreur (toutes\nles partitions ou filtrage par expression r\xe9guli\xe8re)"),(0,a.kt)("li",{parentName:"ul"},"Process-Generic : V\xe9rifier qu'un processus est en cours d'ex\xe9cution"),(0,a.kt)("li",{parentName:"ul"},"Traffic-Generic-Name : V\xe9rifier la consommation de bande passante sur une interface"),(0,a.kt)("li",{parentName:"ul"},"Traffic-Global : V\xe9rifier la consommation de bande passante (toutes les\npartitions ou filtrage par expression r\xe9guli\xe8re)")),(0,a.kt)("p",null,"Voici les m\xe9triques collect\xe9es pour les services li\xe9s au mod\xe8le dh\xf4te par d\xe9faut :"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Cpu",label:"Cpu",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"M\xe9trique"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Description"),(0,a.kt)("th",i({parentName:"tr"},{align:"center"}),"Unit\xe9"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"0#core.cpu.utilization.percentage")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Utilisation moyenne du c\u0153ur 0"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"%")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"1#core.cpu.utilization.percentage")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Utilisation moyenne du c\u0153ur 1"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"%")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"..."),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"..."),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"%")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"cpu.utilization.percentage")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Utilisation moyenne globale"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"%"))))),(0,a.kt)(l.Z,{value:"Load",label:"Load",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"M\xe9trique"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Description"),(0,a.kt)("th",i({parentName:"tr"},{align:"center"}),"Unit\xe9"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"load1")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Charge syst\xe8me moyenne sur 1 minute"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"load5")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Charge syst\xe8me moyenne sur 5 minutes"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"load15")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Charge syst\xe8me moyenne sur 15 minutes"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"})))))),(0,a.kt)(l.Z,{value:"Memory",label:"Memory",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"M\xe9trique"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Description"),(0,a.kt)("th",i({parentName:"tr"},{align:"center"}),"Unit\xe9"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"buffer")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"M\xe9moire allou\xe9e aux buffers"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"B")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"cached")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"M\xe9moire allou\xe9e en cache"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"B")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"slab")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Allocation Slab"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"B")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"used")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"M\xe9moire consomm\xe9e totale"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"B"))))),(0,a.kt)(l.Z,{value:"Swap",label:"Swap",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"M\xe9trique"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Description"),(0,a.kt)("th",i({parentName:"tr"},{align:"center"}),"Unit\xe9"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"swap.free.bytes")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Espace d'\xe9change non utilis\xe9"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"B")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"swap.usage.bytes")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Espace d'\xe9change utilis\xe9"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"B")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"swap.usage.percentage")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Utilisation de l'espace d'\xe9change"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"%"))))),(0,a.kt)(l.Z,{value:"Uptime",label:"Uptime",mdxType:"TabItem"},(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"M\xe9trique"),(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Description"),(0,a.kt)("th",i({parentName:"tr"},{align:"center"}),"Unit\xe9"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),(0,a.kt)("inlineCode",{parentName:"td"},"uptime")),(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"Temps \xe9coul\xe9 depuis le dernier red\xe9marrage"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"s")))))),(0,a.kt)("h2",i({},{id:"pr\xe9requis"}),"Pr\xe9requis"),(0,a.kt)("p",null,"Les pr\xe9requis ci-dessous sont indispendables pour que le plugin pack puisse fonctionner correctement."),(0,a.kt)("h3",i({},{id:"flux-r\xe9seau"}),"Flux r\xe9seau"),(0,a.kt)("p",null,"Le port TCP par d\xe9faut pour le protocole NRPE est le port 5666."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:null}),"Source"),(0,a.kt)("th",i({parentName:"tr"},{align:null}),"Destination"),(0,a.kt)("th",i({parentName:"tr"},{align:null}),"Protocole"),(0,a.kt)("th",i({parentName:"tr"},{align:null}),"Port"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Poller"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"H\xf4te supervis\xe9"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"TCP"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"5666")))),(0,a.kt)("h3",i({},{id:"installation-de-lagent-nrpe-packag\xe9-par-centreon-et-sonde-linux-locale"}),"Installation de l'agent NRPE packag\xe9 par Centreon et sonde Linux locale"),(0,a.kt)("p",null,"Les h\xf4tes supervis\xe9s ont besoin de deux composants pour que cela fonctionne :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"la sonde ",(0,a.kt)("inlineCode",{parentName:"li"},"centreon_linux_local.pl")),(0,a.kt)("li",{parentName:"ul"},"L'agent (",(0,a.kt)("em",{parentName:"li"},"daemon"),") NRPE3")),(0,a.kt)("p",null,"Installer les paquets suivants :"),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"RHEL / CentOS / Oracle Linux 8",label:"RHEL / CentOS / Oracle Linux 8",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-shell"}),"dnf install -y https://yum.centreon.com/standard/21.10/el8/stable/noarch/RPMS/centreon-release-21.10-5.el8.noarch.rpm\ndnf install centreon-nrpe3-daemon.x86_64 centreon-plugin-Operatingsystems-Linux-Local.noarch\n"))),(0,a.kt)(l.Z,{value:"CentOS 7",label:"CentOS 7",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-shell"}),"yum install -y https://yum.centreon.com/standard/21.10/el7/stable/noarch/RPMS/centreon-release-21.10-5.el7.centos.noarch.rpm\nyum install centreon-nrpe3-daemon.x86_64 centreon-plugin-Operatingsystems-Linux-Local.noarch\n")))),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"NB :")," Pour \xe9viter l'ajout du d\xe9p\xf4t Centreon sur tous vos serveurs, il est possible d'installer directement les paquets ",(0,a.kt)("inlineCode",{parentName:"p"},"https://yum.centreon.com/standard/21.10/el7/stable/noarch/RPMS/centreon-plugin-Operatingsystems-Linux-Local-20201006-142255.el7.centos.noarch.rpm")," et ",(0,a.kt)("inlineCode",{parentName:"p"},"https://yum.centreon.com/standard/21.10/el7/stable/x86_64/RPMS/centreon-nrpe3-daemon-3.2.1-8.el7.centos.x86_64.rpm")," (versions courantes au moment de la r\xe9daction de cette documentation) ",(0,a.kt)("strong",{parentName:"p"},"mais dans ce cas il ne sera pas possible de les mettre \xe0 jour par un ",(0,a.kt)("inlineCode",{parentName:"strong"},"yum update")),".")),(0,a.kt)("h3",i({},{id:"configuration-de-nrpe"}),"Configuration de NRPE"),(0,a.kt)("p",null,"Pour que le(s) poller(s) puisse(nt) superviser les h\xf4tes, il est n\xe9cessaire d'adapter le param\xe8tre ",(0,a.kt)("inlineCode",{parentName:"p"},"allowed_hosts")," dans le fichier ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/nrpe/centreon-nrpe3.cfg")," "),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-ini"}),"[...]\n# ALLOWED HOST ADDRESSES\n# This is an optional comma-delimited list of IP address or hostnames\n# that are allowed to talk to the NRPE daemon. Network addresses with a bit mask\n# (i.e. 192.168.1.0/24) are also supported. Hostname wildcards are not currently\n# supported.\nallowed_hosts=127.0.0.1,::1\n[...]\n")),(0,a.kt)("p",null,"Et red\xe9marrer le service :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"systemctl restart centreon-nrpe3.service\n")),(0,a.kt)("h2",i({},{id:"installation"}),"Installation"),(0,a.kt)("h3",i({},{id:"plugin-pack"}),"Plugin-Pack"),(0,a.kt)("p",null,"L'installation du Plugin-Pack en lui-m\xeame ne concerne que le serveur central et la proc\xe9dure d\xe9pend du type de licence."),(0,a.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"Licence IMP/EPP Online & IT-100 Editions",label:"Licence IMP/EPP Online & IT-100 Editions",mdxType:"TabItem"},(0,a.kt)("p",null,'Installer le Plugin-Pack "Linux NRPE3" depuis la page "Configuration > Plugin Packs > Manager".')),(0,a.kt)(l.Z,{value:"Licence IMP/EPP Offline",label:"Licence IMP/EPP Offline",mdxType:"TabItem"},(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Installer le RPM du Plugin-Pack contenant les mod\xe8les de supervision sur le serveur Centreon Central:")),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"yum install centreon-pack-operatingsystems-linux-nrpe3\n")),(0,a.kt)("ol",i({},{start:2}),(0,a.kt)("li",{parentName:"ol"},'Installer le Plugin-Pack "Linux NRPE3" depuis la page "Configuration > Plugin Packs > Manager".')))),(0,a.kt)("h3",i({},{id:"centreon-nrpe3-plugin"}),"Centreon NRPE3 Plugin"),(0,a.kt)("p",null,"Pour commencer, installer le plugin NRPE3, qui permettra au poller de communiquer avec les agents NRPE3 :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"yum install centreon-nrpe3-plugin\n")),(0,a.kt)("h3",i({},{id:"validation-de-lensemble-des-pr\xe9requis"}),"Validation de l'ensemble des pr\xe9requis"),(0,a.kt)("p",null,"Si tout a \xe9t\xe9 correctement install\xe9 et configur\xe9, la commande :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"/usr/lib64/nagios/plugins/check_centreon_nrpe3 -H monitored_host_ip -p 5666\n")),(0,a.kt)("p",null,"devrait aboutir au r\xe9sultat suivant :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-text"}),"NRPE v3.2.1\n")),(0,a.kt)("p",null,"Dans le cas contraire, se r\xe9f\xe9rer \xe0 la section ",(0,a.kt)("a",i({parentName:"p"},{href:"#troubleshooting"}),"troubleshooting"),"."),(0,a.kt)("h2",i({},{id:"configuration-de-lh\xf4te-dans-centreon"}),"Configuration de l'h\xf4te dans Centreon"),(0,a.kt)("p",null,'Cr\xe9er un nouvel h\xf4te dans Centreon et lui appliquer le mod\xe8le d\'h\xf4te "OS-Linux-NRPE3-custom". '),(0,a.kt)("p",null,"Une fois le mod\xe8le appliqu\xe9, il est possible de modifier les macros suivantes :"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",i({parentName:"tr"},{align:"left"}),"Nom"),(0,a.kt)("th",i({parentName:"tr"},{align:null}),"Description"),(0,a.kt)("th",i({parentName:"tr"},{align:"center"}),"Obligatoire"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"NRPECLIENT"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Nom de la sonde employ\xe9e pour dialoguer avec l'agent NRPE3 (par d\xe9faut ",(0,a.kt)("inlineCode",{parentName:"td"},"check_centreon_nrpe3"),")"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"X")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"NRPEPORT"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Port sur lequel \xe9coute l'agent NRPE3 (par d\xe9faut 5666)"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"X")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"NRPETIMEOUT"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Temps maximum autoris\xe9 pour ex\xe9cuter la commande (par d\xe9faut 5s)"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}),"X")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",i({parentName:"tr"},{align:"left"}),"NRPEEXTRAOPTIONS"),(0,a.kt)("td",i({parentName:"tr"},{align:null}),"Options suppl\xe9mentaires (par d\xe9faut ",(0,a.kt)("inlineCode",{parentName:"td"},"-u")," pour que la sonde NRPE retourne un \xe9tat ",(0,a.kt)("inlineCode",{parentName:"td"},"UNKNOWN")," en cas d'erreur de connexion \xe0 l'agent)"),(0,a.kt)("td",i({parentName:"tr"},{align:"center"}))))),(0,a.kt)("h2",i({},{id:"faq"}),"FAQ"),(0,a.kt)("h3",i({},{id:"comment-\xe7a-marche-"}),"Comment \xe7a marche ?"),(0,a.kt)("p",null,"Voici une commande qui permet de surveiller la consommation CPU d'un serveur Linux dont l'adresse IP est ",(0,a.kt)("inlineCode",{parentName:"p"},"x.x.x.x")," :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"/usr/lib64/nagios/plugins/check_centreon_nrpe3 \\\n    -H x.x.x.x \\\n    -p 5666 -t 5 -u \\\n    -c check_centreon_plugins \\\n    -a 'os::linux::local::plugin' 'cpu'  '  --statefile-dir=/var/log/nrpe/centplugins'\n")),(0,a.kt)("p",null,"Cette commande devrait afficher un retour de la forme :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-text"}),"OK: CPU(s) average usage is: 1.16% | 'cpu0'=1.64%;;;0;100 'cpu1'=0.98%;;;0;100 'cpu2'=1.09%;;;0;100 'cpu3'=0.94%;;;0;100 'total_cpu_avg'=1.16%;;;0;100\n")),(0,a.kt)("p",null,"Que s'est-il pass\xe9 ?"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Le Plugin ",(0,a.kt)("inlineCode",{parentName:"li"},"check_centreon_nrpe3"),' a demand\xe9 \xe0 l\'agent NRPE d\'ex\xe9cuter sa commande "check_centreon_plugins" associ\xe9e aux arguments "os::linux::local::plugin", "cpu"  et "  --statefile-dir=/var/log/nrpe/centplugins".'),(0,a.kt)("li",{parentName:"ul"},"L'agent NRPE met bout-\xe0-bout la commande telle que d\xe9finie dans ses fichiers de configuration et les arguments envoy\xe9s pour former la ligne de commande suivante :")),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"/usr/lib/centreon/plugins/centreon_linux_local.pl --plugin=os::linux::local::plugin --mode=cpu --statefile-dir=/var/log/nrpe/centplugins\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Cette commande est alors ex\xe9cut\xe9e par l'utilisateur ",(0,a.kt)("inlineCode",{parentName:"li"},"centreon-engine")," puis l'agent renvoie les r\xe9sultats (code retour et message affich\xe9) au Plugin ",(0,a.kt)("inlineCode",{parentName:"li"},"check_centreon_nrpe3")," qui attend ce retour.")),(0,a.kt)("h3",i({},{id:"troubleshooting"}),"Troubleshooting"),(0,a.kt)("p",null,"Les erreurs les plus courantes sont d\xe9taill\xe9es ci-dessous."),(0,a.kt)("h4",i({},{id:"connect-to-address-xxxx-port-5666-connection-refused"}),(0,a.kt)("inlineCode",{parentName:"h4"},"connect to address x.x.x.x port 5666: Connection refused")),(0,a.kt)("p",null,"Si le message retourn\xe9 est le suivant :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-text"}),"connect to address x.x.x.x port 5666: Connection refused\n")),(0,a.kt)("p",null,"C'est probablement que l'adresse IP x.x.x.x d'o\xf9 est venue la requ\xeate (",(0,a.kt)("em",{parentName:"p"},"ie.")," le poller) n'est pas autoris\xe9e \xe0 interroger l'agent NRPE. "),(0,a.kt)("p",null,"Il faut alors v\xe9rifier le param\xe8tre ",(0,a.kt)("inlineCode",{parentName:"p"},"allowed_hosts")," dans le fichier ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/nrpe/centreon-nrpe3.cfg")," (",(0,a.kt)("a",i({parentName:"p"},{href:"#configuration-de-nrpe"}),(0,a.kt)("em",{parentName:"a"},"cf")," plus haut"),"."),(0,a.kt)("p",null,"Puis red\xe9marrer le service."),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"systemctl restart centreon-nrpe3.service\n")),(0,a.kt)("h4",i({},{id:"check_nrpe-state-critical-socket-timeout-after-10-seconds"}),(0,a.kt)("inlineCode",{parentName:"h4"},"CHECK_NRPE STATE CRITICAL: Socket timeout after 10 seconds")),(0,a.kt)("p",null,"Si le message retourn\xe9 est le suivant :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-text"}),"CHECK_NRPE STATE CRITICAL: Socket timeout after 10 seconds.\n")),(0,a.kt)("p",null,"V\xe9rifier alors les points suivants :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"le service ",(0,a.kt)("inlineCode",{parentName:"li"},"centreon-nrpe3")," est bien d\xe9marr\xe9")),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"systemctl status centreon-nrpe3.service\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"le port utilis\xe9 par la sonde (",(0,a.kt)("inlineCode",{parentName:"li"},"-p 5666")," par exemple) est conforme \xe0 la configuration de l'agent, si le port a \xe9t\xe9 personnalis\xe9"),(0,a.kt)("li",{parentName:"ul"},"aucun pare-feu local ne bloque le port NRPE (",(0,a.kt)("inlineCode",{parentName:"li"},"iptables -L"),")"),(0,a.kt)("li",{parentName:"ul"},"aucun \xe9quipement de type firewall ne filtre ce port sur le r\xe9seau")),(0,a.kt)("h4",i({},{id:"nrpe-command-my_command-not-defined"}),(0,a.kt)("inlineCode",{parentName:"h4"},"NRPE: Command 'my_command' not defined")),(0,a.kt)("p",null,"Si le message retourn\xe9 est le suivant :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-text"}),"NRPE: Command 'my_command' not defined\n")),(0,a.kt)("p",null,"Cela signifie que l'on demande \xe0 l'agent NRPE d'ex\xe9cuter une commande qui lui est inconnue."),(0,a.kt)("p",null,"Pour qu'une commande soit reconnue, il faut qu'elle soit convenablement d\xe9clar\xe9e avec la syntaxe suivante :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-ini"}),"[my_command]=/full/path/to/command --argument --other-argument\n")),(0,a.kt)("p",null,"Et red\xe9marrer le service :"),(0,a.kt)("pre",null,(0,a.kt)("code",i({parentName:"pre"},{className:"language-bash"}),"systemctl restart centreon-nrpe3.service\n")))}k.isMDXComponent=!0},7626:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(67294),r=n(86010);const l="tabItem_Ymn6";function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i.apply(this,arguments)}function o({children:e,hidden:t,className:n}){return a.createElement("div",i({role:"tabpanel",className:(0,r.Z)(l,n)},{hidden:t}),e)}},67709:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(67294),r=n(86010),l=n(90980),i=n(35715),o=n(8854),s=n(8241);const u="tabList__CuJ",p="tabItem_LNqP";function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},d.apply(this,arguments)}function c(e){var t;const{lazy:n,block:l,defaultValue:c,values:m,groupId:k,className:g}=e,N=a.Children.map(e.children,(e=>{if((0,a.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),f=null!=m?m:N.map((({props:{value:e,label:t,attributes:n}})=>({value:e,label:t,attributes:n}))),b=(0,i.l)(f,((e,t)=>e.value===t.value));if(b.length>0)throw new Error(`Docusaurus error: Duplicate values "${b.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);var h;const v=null===c?c:null!==(h=null!=c?c:null===(t=N.find((e=>e.props.default)))||void 0===t?void 0:t.props.value)&&void 0!==h?h:N[0].props.value;if(null!==v&&!f.some((e=>e.value===v)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${v}" but none of its children has the corresponding value. Available values are: ${f.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:y,setTabGroupChoices:x}=(0,o.U)(),[P,C]=(0,a.useState)(v),E=[],{blockElementScrollPositionUntilNextRender:O}=(0,s.o5)();if(null!=k){const e=y[k];null!=e&&e!==P&&f.some((t=>t.value===e))&&C(e)}const T=e=>{const t=e.currentTarget,n=E.indexOf(t),a=f[n].value;a!==P&&(O(t),C(a),null!=k&&x(k,String(a)))},q=e=>{let t=null;switch(e.key){case"ArrowRight":{const a=E.indexOf(e.currentTarget)+1;var n;t=null!==(n=E[a])&&void 0!==n?n:E[0];break}case"ArrowLeft":{const n=E.indexOf(e.currentTarget)-1;var a;t=null!==(a=E[n])&&void 0!==a?a:E[E.length-1];break}}null==t||t.focus()};return a.createElement("div",{className:(0,r.Z)("tabs-container",u)},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":l},g)},f.map((({value:e,label:t,attributes:n})=>a.createElement("li",d({role:"tab",tabIndex:P===e?0:-1,"aria-selected":P===e,key:e,ref:e=>E.push(e),onKeyDown:q,onFocus:T,onClick:T},n,{className:(0,r.Z)("tabs__item",p,null==n?void 0:n.className,{"tabs__item--active":P===e})}),null!=t?t:e)))),n?(0,a.cloneElement)(N.filter((e=>e.props.value===P))[0],{className:"margin-top--md"}):a.createElement("div",{className:"margin-top--md"},N.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==P})))))}function m(e){const t=(0,l.Z)();return a.createElement(c,d({key:String(t)},e))}}}]);