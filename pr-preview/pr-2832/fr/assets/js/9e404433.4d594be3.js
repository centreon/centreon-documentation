"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[47894],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>d});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=n.createContext({}),p=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(o.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),m=p(a),d=r,f=m["".concat(o,".").concat(d)]||m[d]||c[d]||l;return a?n.createElement(f,s(s({ref:t},u),{},{components:a})):n.createElement(f,s({ref:t},u))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,s=new Array(l);s[0]=m;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var p=2;p<l;p++)s[p]=a[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},7626:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(67294),r=a(86010);const l="tabItem_Ymn6";function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s.apply(this,arguments)}function i({children:e,hidden:t,className:a}){return n.createElement("div",s({role:"tabpanel",className:(0,r.Z)(l,a)},{hidden:t}),e)}},67709:(e,t,a)=>{a.d(t,{Z:()=>d});var n=a(67294),r=a(86010),l=a(90980),s=a(35715),i=a(8854),o=a(8241);const p="tabList__CuJ",u="tabItem_LNqP";function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},c.apply(this,arguments)}function m(e){var t;const{lazy:a,block:l,defaultValue:m,values:d,groupId:f,className:v}=e,g=n.Children.map(e.children,(e=>{if((0,n.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),k=null!=d?d:g.map((({props:{value:e,label:t,attributes:a}})=>({value:e,label:t,attributes:a}))),N=(0,s.l)(k,((e,t)=>e.value===t.value));if(N.length>0)throw new Error(`Docusaurus error: Duplicate values "${N.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);var h;const y=null===m?m:null!==(h=null!=m?m:null===(t=g.find((e=>e.props.default)))||void 0===t?void 0:t.props.value)&&void 0!==h?h:g[0].props.value;if(null!==y&&!k.some((e=>e.value===y)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${y}" but none of its children has the corresponding value. Available values are: ${k.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:b,setTabGroupChoices:x}=(0,i.U)(),[O,_]=(0,n.useState)(y),w=[],{blockElementScrollPositionUntilNextRender:C}=(0,o.o5)();if(null!=f){const e=b[f];null!=e&&e!==O&&k.some((t=>t.value===e))&&_(e)}const P=e=>{const t=e.currentTarget,a=w.indexOf(t),n=k[a].value;n!==O&&(C(t),_(n),null!=f&&x(f,String(n)))},E=e=>{let t=null;switch(e.key){case"ArrowRight":{const n=w.indexOf(e.currentTarget)+1;var a;t=null!==(a=w[n])&&void 0!==a?a:w[0];break}case"ArrowLeft":{const a=w.indexOf(e.currentTarget)-1;var n;t=null!==(n=w[a])&&void 0!==n?n:w[w.length-1];break}}null==t||t.focus()};return n.createElement("div",{className:(0,r.Z)("tabs-container",p)},n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":l},v)},k.map((({value:e,label:t,attributes:a})=>n.createElement("li",c({role:"tab",tabIndex:O===e?0:-1,"aria-selected":O===e,key:e,ref:e=>w.push(e),onKeyDown:E,onFocus:P,onClick:P},a,{className:(0,r.Z)("tabs__item",u,null==a?void 0:a.className,{"tabs__item--active":O===e})}),null!=t?t:e)))),a?(0,n.cloneElement)(g.filter((e=>e.props.value===O))[0],{className:"margin-top--md"}):n.createElement("div",{className:"margin-top--md"},g.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==O})))))}function d(e){const t=(0,l.Z)();return n.createElement(m,c({key:String(t)},e))}},19055:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>p,default:()=>f,frontMatter:()=>o,metadata:()=>u,toc:()=>m});a(67294);var n=a(3905),r=a(67709),l=a(7626);function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s.apply(this,arguments)}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}const o={id:"postfix",title:"Configurer l'envoi d'emails"},p=void 0,u={unversionedId:"administration/postfix",id:"version-23.10/administration/postfix",title:"Configurer l'envoi d'emails",description:"Pour que votre Centreon puisse envoyer des emails de notification, un serveur smtp local doit \xeatre configur\xe9. Si votre syst\xe8me d'exploitation est RHEL ou Oracle Linux, Postfix est d\xe9j\xe0 install\xe9.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-23.10/administration/postfix.md",sourceDirName:"administration",slug:"/administration/postfix",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/docs/administration/postfix",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/next/i18n/fr/docusaurus-plugin-content-docs/version-23.10/administration/postfix.md",tags:[],version:"23.10",lastUpdatedAt:1700565273,formattedLastUpdatedAt:"21 nov. 2023",frontMatter:{id:"postfix",title:"Configurer l'envoi d'emails"},sidebar:"version-23.10/docs",previous:{title:"Statistiques de la plateforme",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/docs/administration/platform-statistics"},next:{title:"Mise \xe0 jour d'une plateforme Centreon 23.04",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/docs/update/update-centreon-platform"}},c={},m=[{value:"\xc9tape 1 : Configurer Postfix",id:"\xe9tape-1--configurer-postfix",level:2},{value:"\xc9tape 2 : Configurer les identifiants du compte qui enverra les emails",id:"\xe9tape-2--configurer-les-identifiants-du-compte-qui-enverra-les-emails",level:2},{value:"D\xe9panner l&#39;envoi d&#39;emails avec Postfix",id:"d\xe9panner-lenvoi-demails-avec-postfix",level:2},{value:"Configuration sp\xe9cifique \xe0 Gmail",id:"configuration-sp\xe9cifique-\xe0-gmail",level:2}],d={toc:m};function f(e){var{components:t}=e,o=i(e,["components"]);return(0,n.kt)("wrapper",s({},d,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Pour que votre Centreon puisse envoyer des emails de notification, un serveur smtp local doit \xeatre configur\xe9. Si votre syst\xe8me d'exploitation est RHEL ou Oracle Linux, Postfix est d\xe9j\xe0 install\xe9."),(0,n.kt)("p",null,"Cette page donne un exemple de configuration. Consultez la  ",(0,n.kt)("a",s({parentName:"p"},{href:"http://www.postfix.org/BASIC_CONFIGURATION_README"}),"documentation officielle Postfix")," pour plus d'informations."),(0,n.kt)("p",null,"Les commandes de notifications sont ex\xe9cut\xe9es par le collecteur qui supervise la ressource : il est n\xe9cessaire de configurer le relais mail sur tous les collecteurs."),(0,n.kt)("p",null,"Nous vous recommandons d'utiliser un compte mail d\xe9di\xe9 \xe0 l'envoi des notifications."),(0,n.kt)("h2",s({},{id:"\xe9tape-1--configurer-postfix"}),"\xc9tape 1 : Configurer Postfix"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Dans le terminal de votre serveur, entrez la commande suivante :")),(0,n.kt)(r.Z,{groupId:"sync",mdxType:"Tabs"},(0,n.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 8",label:"Alma / RHEL / Oracle Linux 8",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"dnf install mailx cyrus-sasl-plain\n"))),(0,n.kt)(l.Z,{value:"Alma / RHEL / Oracle Linux 9",label:"Alma / RHEL / Oracle Linux 9",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"dnf install s-nail cyrus-sasl-plain\n"))),(0,n.kt)(l.Z,{value:"Debian 11",label:"Debian 11",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"apt install mailx cyrus-sasl-plain\n")))),(0,n.kt)("ol",s({},{start:2}),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Red\xe9marrez Postfix : "),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"systemctl restart postfix\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Configurez Postfix pour qu'il s'ex\xe9cute au d\xe9marrage :"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"systemctl enable postfix\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"\xc9ditez le fichier suivant :"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"vi /etc/postfix/main.cf\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Ajoutez les informations suivantes :"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"myhostname = hostname\nrelayhost = [smtp.isp.com]:port\nsmtp_use_tls = yes\nsmtp_sasl_auth_enable = yes\nsmtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd\nsmtp_tls_CAfile = /etc/ssl/certs/ca-bundle.crt\nsmtp_sasl_security_options = noanonymous\nsmtp_sasl_tls_security_options = noanonymous\n")),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Le param\xe8tre ",(0,n.kt)("strong",{parentName:"li"},"myhostname")," est le hostname du serveur Centreon."),(0,n.kt)("li",{parentName:"ul"},"Le param\xe8tre ",(0,n.kt)("strong",{parentName:"li"},"relayhost")," correspond au serveur de messagerie du compte qui enverra les emails.")),(0,n.kt)("p",{parentName:"li"},"Dans l'exemple suivant, Centreon utilisera un compte Gmail pour envoyer les notifications :"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"myhostname = centreon-central\nrelayhost = [smtp.gmail.com]:587\nsmtp_use_tls = yes\nsmtp_sasl_auth_enable = yes\nsmtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd\nsmtp_tls_CAfile = /etc/ssl/certs/ca-bundle.crt\nsmtp_sasl_security_options = noanonymous\nsmtp_sasl_tls_security_options = noanonymous\n")))),(0,n.kt)("h2",s({},{id:"\xe9tape-2--configurer-les-identifiants-du-compte-qui-enverra-les-emails"}),"\xc9tape 2 : Configurer les identifiants du compte qui enverra les emails"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Cr\xe9ez un fichier ",(0,n.kt)("inlineCode",{parentName:"p"},"/etc/postfix/sasl_passwd")," :"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"touch /etc/postfix/sasl_passwd\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Ajoutez la ligne suivante, en rempla\xe7ant ",(0,n.kt)("inlineCode",{parentName:"p"},"identifiant:motdepasse")," par les informations de connexion du compte qui enverra les emails de notification :"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"[smtp.fai.com]:port identifiant:motdepasse\n")),(0,n.kt)("p",{parentName:"li"},"Exemple:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"[smtp.gmail.com]:587 username@gmail.com:XXXXXXXX\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Enregistrez le fichier.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Dans le terminal, entrez la commande suivante : "),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"postmap /etc/postfix/sasl_passwd\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Pour plus de s\xe9curit\xe9, changez les permissions sur le fichier ",(0,n.kt)("inlineCode",{parentName:"p"},"sasl_passwd")," :"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"chown root:postfix /etc/postfix/sasl_passwd*\nchmod 640 /etc/postfix/sasl_passwd*\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Rechargez Postfix pour prendre en compte les modifications:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"systemctl reload postfix\n")))),(0,n.kt)("h2",s({},{id:"d\xe9panner-lenvoi-demails-avec-postfix"}),"D\xe9panner l'envoi d'emails avec Postfix"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Pour envoyer un email de test, utilisez la commande suivante :"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),'echo "Test" | mail -s "Test" utilisateur@fai.com\n')),(0,n.kt)("p",{parentName:"li"},"  Remplacez ",(0,n.kt)("inlineCode",{parentName:"p"},"utilisateur@fai.com")," par une v\xe9ritable adresse email : le destinataire devrait recevoir l'email de test.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Si le destinataire n'a pas re\xe7u l'email, v\xe9rifiez le fichier de log suivant :"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"tail -f /var/log/maillog\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Pour v\xe9rifier si votre service Postfix tourne, entrez:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",s({parentName:"pre"},{className:"language-shell"}),"systemctl status postfix\n")),(0,n.kt)("p",{parentName:"li"},"  Le r\xe9sultat devrait ressembler \xe0 \xe7a :"),(0,n.kt)("p",{parentName:"li"},"  ",(0,n.kt)("img",{alt:"image",src:a(90043).Z,width:"644",height:"323"})))),(0,n.kt)("h2",s({},{id:"configuration-sp\xe9cifique-\xe0-gmail"}),"Configuration sp\xe9cifique \xe0 Gmail"),(0,n.kt)("p",null,"Si vous souhaitez envoyer des emails en utilisant un compte Gmail, vous devrez activer l'option ",(0,n.kt)("strong",{parentName:"p"},"Acc\xe8s pour les applications moins s\xe9curis\xe9es")," sur celui-ci : voir la page ",(0,n.kt)("a",s({parentName:"p"},{href:"https://support.google.com/accounts/answer/6010255"}),"Autoriser les applications moins s\xe9curis\xe9es \xe0 acc\xe9der \xe0 votre compte"),"."))}f.isMDXComponent=!0},90043:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/postfix-status-ae9e2ca7127885e00ec2733602c5b75d.png"}}]);