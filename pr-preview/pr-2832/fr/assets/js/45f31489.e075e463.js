"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[63563],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),p=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(n),d=a,h=c["".concat(i,".").concat(d)]||c[d]||m[d]||o;return n?r.createElement(h,l(l({ref:t},u),{},{components:n})):r.createElement(h,l({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=c;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,l[1]=s;for(var p=2;p<o;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},21044:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>p,default:()=>h,frontMatter:()=>i,metadata:()=>u,toc:()=>c});n(67294);var r=n(3905),a=n(67709),o=n(7626);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const i={id:"collect-openmetrics",title:"Collecter des OpenMetrics"},p=void 0,u={unversionedId:"integrations/plugin-packs/getting-started/how-to-guides/collect-openmetrics",id:"integrations/plugin-packs/getting-started/how-to-guides/collect-openmetrics",title:"Collecter des OpenMetrics",description:"Le format d'exposition des m\xe9triques des exporteurs Prometheus a fait l'objet",source:"@site/i18n/fr/docusaurus-plugin-content-docs-pp/current/integrations/plugin-packs/getting-started/how-to-guides/collect-openmetrics.md",sourceDirName:"integrations/plugin-packs/getting-started/how-to-guides",slug:"/integrations/plugin-packs/getting-started/how-to-guides/collect-openmetrics",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/pp/integrations/plugin-packs/getting-started/how-to-guides/collect-openmetrics",draft:!1,tags:[],version:"current",frontMatter:{id:"collect-openmetrics",title:"Collecter des OpenMetrics"},sidebar:"pp",previous:{title:"Centreon NSClient++",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/pp/integrations/plugin-packs/getting-started/how-to-guides/centreon-nsclient-tutorial"},next:{title:"Troubleshooting Plugin errors",permalink:"/centreon-documentation/pr-preview/pr-2832/fr/pp/integrations/plugin-packs/getting-started/how-to-guides/troubleshooting-plugins"}},m={},c=[{value:"Installation",id:"installation",level:2},{value:"Configuration",id:"configuration",level:2},{value:"App-Monitoring-Openmetrics-File-custom",id:"app-monitoring-openmetrics-file-custom",level:3},{value:"App-Monitoring-Openmetrics-Web-custom",id:"app-monitoring-openmetrics-web-custom",level:3},{value:"How To",id:"how-to",level:2},{value:"Collecter une m\xe9trique en ligne de commande",id:"collecter-une-m\xe9trique-en-ligne-de-commande",level:3},{value:"Prometheus",id:"prometheus",level:4},{value:"Ajouter cette m\xe9trique \xe0 ma supervision",id:"ajouter-cette-m\xe9trique-\xe0-ma-supervision",level:3}],d={toc:c};function h(e){var{components:t}=e,i=s(e,["components"]);return(0,r.kt)("wrapper",l({},d,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Le format d'exposition des m\xe9triques des exporteurs Prometheus a fait l'objet\nd'une standardisation sous le nom d'OpenMetrics afin de pouvoir \xeatre r\xe9utilis\xe9\nailleurs. Certains produits ont adopt\xe9 ce format comme par exemple la suite\nd'InfluxData, InfluxDB, et Google Cloud Platform."),(0,r.kt)("h2",l({},{id:"installation"}),"Installation"),(0,r.kt)(a.Z,{groupId:"sync",mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"Online License",label:"Online License",mdxType:"TabItem"},(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Installer le code du connecteur sur l'ensemble des collecteurs r\xe9cup\xe9rant\ndes openmetrics :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"yum install centreon-plugin-Applications-Monitoring-Openmetrics\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Installer le pack depuis la page ",(0,r.kt)("inlineCode",{parentName:"p"},"Configuration > Plugin Packs"),".")))),(0,r.kt)(o.Z,{value:"Offline License",label:"Offline License",mdxType:"TabItem"},(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Installer le code du connecteur sur l'ensemble des collecteurs r\xe9cup\xe9rant\ndes openmetrics :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"yum install centreon-plugin-Applications-Monitoring-Openmetrics\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Installer le RPM contenant les mod\xe8les de supervision sur le serveur Central\n:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"yum install centreon-pack-applications-monitoring-openmetrics\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Installer le pack depuis la page ",(0,r.kt)("inlineCode",{parentName:"p"},"Configuration > Plugin Packs"),"."))))),(0,r.kt)("h2",l({},{id:"configuration"}),"Configuration"),(0,r.kt)("p",null,"Le pack de supervision permet de r\xe9cup\xe9rer des openmetrics via un fichier\npr\xe9sent sur un collecteur contenant des openmetrics (le mod\xe8le sera\nApp-Monitoring-Openmetrics-File-custom) ou une API exposant des openmetrics (le\nmod\xe8le sera App-Monitoring-Openmetrics-Web-custom). Selon le mod\xe8le \xe0 utiliser\nplusieurs macros seront \xe0 configurer :"),(0,r.kt)("h3",l({},{id:"app-monitoring-openmetrics-file-custom"}),"App-Monitoring-Openmetrics-File-custom"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Mandatory"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Name"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"X"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSFILEPATH"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Path of the file that containts openmetrics (eg. /var/data/metrics)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"})),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSEXTRAOPTIONS"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Any extraoptions you may want to add to every command line (eg. a --verbose flag)")))),(0,r.kt)("h3",l({},{id:"app-monitoring-openmetrics-web-custom"}),"App-Monitoring-Openmetrics-Web-custom"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Mandatory"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Name"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"X"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSPORT"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Port use by the endpoint (eg '80', '443' or '9000')")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"X"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSPROTO"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Protocol use by the endpoint ('http' or 'https')")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"X"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSURLPATH"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Path of the url that expose openmetrics (eg. /metrics)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"})),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSUSERNAME"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Username in case of authentication required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"})),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSPASSWORD"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Password in case of authentication required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"})),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSEXTRAOPTIONS"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"Any extraoptions you may want to add to every command line (eg. a --verbose flag)")))),(0,r.kt)("p",null,'Ces 2 mod\xe8les d\'h\xf4tes vont d\xe9ployer automatiquement un service "Scrape-Metrics"\n\xe0 votre h\xf4te. Ce service pourra \xeatre dupliqu\xe9 autant de fois que n\xe9cessaire\nselon le nombre de m\xe9triques \xe0 r\xe9cup\xe9rer.'),(0,r.kt)("h2",l({},{id:"how-to"}),"How To"),(0,r.kt)("h3",l({},{id:"collecter-une-m\xe9trique-en-ligne-de-commande"}),"Collecter une m\xe9trique en ligne de commande"),(0,r.kt)("p",null,"Nous avons un serveur/conteneur Prometheus qui expose des m\xe9triques? Ou un\nserveur/conteneur Cadvisor qui expose des m\xe9triques ? Nous allons voir quelques\nexemples pour collecter ces m\xe9triques de ces endpoints."),(0,r.kt)("h4",l({},{id:"prometheus"}),"Prometheus"),(0,r.kt)("p",null,"Notre serveur/conteneur Prometheus expose des donn\xe9es sur l'URL suivante :\n",(0,r.kt)("inlineCode",{parentName:"p"},"<http://prometheus.int.centreon.com:9090/metrics>")," :"),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-text"}),'# HELP prometheus_http_requests_total Counter of HTTP requests.\n# TYPE prometheus_http_requests_total counter\nprometheus_http_requests_total{code="200",handler="/alerts"} 1\nprometheus_http_requests_total{code="200",handler="/api/v1/label/:name/values"} 24\nprometheus_http_requests_total{code="200",handler="/api/v1/labels"} 3\nprometheus_http_requests_total{code="200",handler="/api/v1/query"} 5454\nprometheus_http_requests_total{code="200",handler="/api/v1/query_range"} 3390\nprometheus_http_requests_total{code="200",handler="/api/v1/targets"} 3\nprometheus_http_requests_total{code="200",handler="/config"} 2\nprometheus_http_requests_total{code="200",handler="/flags"} 2\nprometheus_http_requests_total{code="200",handler="/graph"} 17\nprometheus_http_requests_total{code="200",handler="/metrics"} 155749\nprometheus_http_requests_total{code="200",handler="/new/*filepath"} 6\nprometheus_http_requests_total{code="200",handler="/service-discovery"} 2\nprometheus_http_requests_total{code="200",handler="/static/*filepath"} 54\nprometheus_http_requests_total{code="200",handler="/status"} 5\nprometheus_http_requests_total{code="200",handler="/targets"} 11\nprometheus_http_requests_total{code="302",handler="/"} 20\nprometheus_http_requests_total{code="400",handler="/api/v1/query"} 1\nprometheus_http_requests_total{code="400",handler="/api/v1/query_range"} 4\n')),(0,r.kt)("p",null,"Nous souhaiterions ici r\xe9cup\xe9rer le nombre total de requ\xeates sur l'url\n'/api/v1/query","_","range', pour ce faire commen\xe7ons tout d'abord par collecter les\nm\xe9triques \"prometheus","_","http","_","requests","_",'total" :'),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"/usr/lib/centreon/plugins/centreon_monitoring_openmetrics.pl \\\n --plugin apps::monitoring::openmetrics::plugin \\\n --custommode web \\\n --mode scrape-metrics \\\n --hostname='prometheus.int.centreon.com' \\\n --port='9090' \\\n --proto='http' \\\n --urlpath='/metrics' \\\n --filter-metrics='prometheus_http_requests_total'\n")),(0,r.kt)("p",null,"La commande renvoie alors :"),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"OK: All metrics are ok | 'prometheus_http_requests_total'=1;;;; 'prometheus_http_requests_total'=24;;;; 'prometheus_http_requests_total'=3;;;; 'prometheus_http_requests_total'=5454;;;; 'prometheus_http_requests_total'=3390;;;; 'prometheus_http_requests_total'=3;;;; 'prometheus_http_requests_total'=2;;;; 'prometheus_http_requests_total'=2;;;; 'prometheus_http_requests_total'=17;;;; 'prometheus_http_requests_total'=155790;;;; 'prometheus_http_requests_total'=6;;;; 'prometheus_http_requests_total'=2;;;; 'prometheus_http_requests_total'=54;;;; 'prometheus_http_requests_total'=5;;;; 'prometheus_http_requests_total'=11;;;; 'prometheus_http_requests_total'=20;;;; 'prometheus_http_requests_total'=1;;;; 'prometheus_http_requests_total'=4;;;;\n")),(0,r.kt)("p",null,"Nous avons utilis\xe9 les options : custommode web (",(0,r.kt)("inlineCode",{parentName:"p"},"--custommode web"),") afin de\nrequ\xeater en HTTP/HTTPS prometheus. Nous avons ensuite configur\xe9 toutes les\ninformations de connexion : le nom d'h\xf4te\n(",(0,r.kt)("inlineCode",{parentName:"p"},"--hostname='prometheus.int.centreon.com'"),"), le port (",(0,r.kt)("inlineCode",{parentName:"p"},"--port='9090'"),"), le\nprotocole (",(0,r.kt)("inlineCode",{parentName:"p"},"--proto='http'"),") et le chemin d'acc\xe8s aux m\xe9triques\n(",(0,r.kt)("inlineCode",{parentName:"p"},"--urlpath='/metrics'"),"). Enfin nous avons filtr\xe9 uniquement les m\xe9triques\n'prometheus","_","http","_","requests","_","total'\n(",(0,r.kt)("inlineCode",{parentName:"p"},"filter-metrics='prometheus_http_requests_total'"),")."),(0,r.kt)("p",null,"Maintenant nous aimerions filtrer uniquement le nombre de requ\xeates sur l'url\n'/api/v1/query","_","range', nous allons donc utiliser l'option ",(0,r.kt)("inlineCode",{parentName:"p"},"--instance")," pour\navoir la possibilit\xe9 de filtrer sur un champs, et ensuite utiliser\n",(0,r.kt)("inlineCode",{parentName:"p"},"--filter-instance")," pour filtrer sur la valeur de ces champs :"),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"/usr/lib/centreon/plugins/centreon_monitoring_openmetrics.pl \\\n --plugin apps::monitoring::openmetrics::plugin \\\n --custommode web \\\n --mode scrape-metrics \\\n --hostname='prometheus.int.centreon.com' \\\n --port='9090' \\\n --proto='http' \\\n --urlpath='/metrics' \\\n --filter-metrics='prometheus_http_requests_total' \\\n --instance='handler' \\\n --filter-instance='/api/v1/query_range'\n")),(0,r.kt)("p",null,"La commande renvoie alors :"),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"OK: All metrics are ok | '/api/v1/query_range#prometheus_http_requests_total'=3390;;;; '/api/v1/query_range#prometheus_http_requests_total'=4;;;;\n")),(0,r.kt)("p",null,"Nous filtrons maintenant sur les 'handlers' (",(0,r.kt)("inlineCode",{parentName:"p"},"--instance='handler'"),") et nous ne\nr\xe9cup\xe8rons plus que les m\xe9triques dont le handler correspond \xe0\n'/api/v1/query","_","range' (",(0,r.kt)("inlineCode",{parentName:"p"},"--filter-instance='/api/v1/query_range'"),")."),(0,r.kt)("p",null,"Et pour finir, nous allons filtrer uniquement les requ\xeates qui ont retourn\xe9es un\ncode '200' pour avoir la possibilit\xe9 d'avoir un graphique de performance et de\nl'alerting dans Centreon :"),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"/usr/lib/centreon/plugins/centreon_monitoring_openmetrics.pl \\\n --plugin apps::monitoring::openmetrics::plugin \\\n --custommode web \\\n --mode scrape-metrics \\\n --hostname='prometheus.int.centreon.com' \\\n --port='9090' \\\n --proto='http' \\\n --urlpath='/metrics' \\\n --filter-metrics='prometheus_http_requests_total' \\\n --instance='handler' \\\n --filter-instance='/api/v1/query_range' \\\n --subinstance='code' \\\n --filter-subinstance='200' \\\n --warning='5000' \\\n --critical='10000'\n")),(0,r.kt)("p",null,"La commande renvoie alors :"),(0,r.kt)("pre",null,(0,r.kt)("code",l({parentName:"pre"},{className:"language-bash"}),"OK: All metrics are ok | '/api/v1/query_range~200#prometheus_http_requests_total'=3390;;;;\n")),(0,r.kt)("p",null,"Ici, nous avons ajout\xe9 l'option ",(0,r.kt)("inlineCode",{parentName:"p"},"--subinstance='code'")," pour obtenir un second\nfiltre sur les codes HTTP, et nous filtrons ensuite sur le code '200 \xe0 l'aide de\nl'option ",(0,r.kt)("inlineCode",{parentName:"p"},"--filter-subinstance='200'"),". Pour les seuils, les options\n",(0,r.kt)("inlineCode",{parentName:"p"},"--warning='5000' --critical='10000'")," sont utilis\xe9es pour obtenir un WARNING si\nla valeur de la m\xe9trique r\xe9cup\xe9r\xe9e est sup\xe9rieure \xe0 5000 et un CRITICAL si elle\nest sup\xe9rieure \xe0 10000."),(0,r.kt)("p",null,"Toutes les options des diff\xe9rents modes sont consultables via le help (",(0,r.kt)("inlineCode",{parentName:"p"},"--help"),")"),(0,r.kt)("h3",l({},{id:"ajouter-cette-m\xe9trique-\xe0-ma-supervision"}),"Ajouter cette m\xe9trique \xe0 ma supervision"),(0,r.kt)("p",null,"Nous allons configurer l'h\xf4te Prometheus en d\xe9finissant les param\xe8tres suivants\n:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Param\xe8tre"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Valeur"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"NAME"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"prometheus.int.centreon.com")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"ALIAS"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"internal prometheus")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"IPADDRESS/FQDN"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"prometheus.int.centreon.com")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"TEMPLATE"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"App-Monitoring-Openmetrics-Web-custom")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSPORT"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"80")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSPROTO"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"http")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"OPENMETRICSURLPATH"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"/metrics")))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(21224).Z,width:"1364",height:"820"})),(0,r.kt)("p",null,'Nous pouvons maintenant \xe9diter le service "Scrape-Metrics" qui a \xe9t\xe9 cr\xe9\xe9\nautomatiquement en utilisant le template "App-Monitoring-Openmetrics-Web-custom"\npour configurer les macros comme dans l\'exemple en CLI :'),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Param\xe8tre"),(0,r.kt)("th",l({parentName:"tr"},{align:"left"}),"Valeur"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"FILTERMETRICS"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"prometheus","_","http","_","requests","_","total")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"WARNING"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"5000")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"CRITICAL"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"10000")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"INSTANCE"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"handler")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"FILTERINSTANCE"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"/api/v1/query","_","range")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"SUBINSTANCE"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"code")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"FILTERSUBINTACE"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"200")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"EXTRAOPTIONS"),(0,r.kt)("td",l({parentName:"tr"},{align:"left"}),"-","-verbose")))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(82093).Z,width:"1011",height:"670"})),(0,r.kt)("p",null,'Et nous renommons le service en "Query-Api-Number". Ce service pourra \xeatre\ndupliqu\xe9 et modifi\xe9 pour obtenir d\'autres m\xe9triques prometheus.'),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(33649).Z,width:"1268",height:"208"})))}h.isMDXComponent=!0},7626:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(67294),a=n(86010);const o="tabItem_Ymn6";function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function s({children:e,hidden:t,className:n}){return r.createElement("div",l({role:"tabpanel",className:(0,a.Z)(o,n)},{hidden:t}),e)}},67709:(e,t,n)=>{n.d(t,{Z:()=>d});var r=n(67294),a=n(86010),o=n(90980),l=n(35715),s=n(8854),i=n(8241);const p="tabList__CuJ",u="tabItem_LNqP";function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}function c(e){var t;const{lazy:n,block:o,defaultValue:c,values:d,groupId:h,className:g}=e,f=r.Children.map(e.children,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),k=null!=d?d:f.map((({props:{value:e,label:t,attributes:n}})=>({value:e,label:t,attributes:n}))),N=(0,l.l)(k,((e,t)=>e.value===t.value));if(N.length>0)throw new Error(`Docusaurus error: Duplicate values "${N.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);var _;const b=null===c?c:null!==(_=null!=c?c:null===(t=f.find((e=>e.props.default)))||void 0===t?void 0:t.props.value)&&void 0!==_?_:f[0].props.value;if(null!==b&&!k.some((e=>e.value===b)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${b}" but none of its children has the corresponding value. Available values are: ${k.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:v,setTabGroupChoices:y}=(0,s.U)(),[q,O]=(0,r.useState)(b),T=[],{blockElementScrollPositionUntilNextRender:P}=(0,i.o5)();if(null!=h){const e=v[h];null!=e&&e!==q&&k.some((t=>t.value===e))&&O(e)}const C=e=>{const t=e.currentTarget,n=T.indexOf(t),r=k[n].value;r!==q&&(P(t),O(r),null!=h&&y(h,String(r)))},E=e=>{let t=null;switch(e.key){case"ArrowRight":{const r=T.indexOf(e.currentTarget)+1;var n;t=null!==(n=T[r])&&void 0!==n?n:T[0];break}case"ArrowLeft":{const n=T.indexOf(e.currentTarget)-1;var r;t=null!==(r=T[n])&&void 0!==r?r:T[T.length-1];break}}null==t||t.focus()};return r.createElement("div",{className:(0,a.Z)("tabs-container",p)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":o},g)},k.map((({value:e,label:t,attributes:n})=>r.createElement("li",m({role:"tab",tabIndex:q===e?0:-1,"aria-selected":q===e,key:e,ref:e=>T.push(e),onKeyDown:E,onFocus:C,onClick:C},n,{className:(0,a.Z)("tabs__item",u,null==n?void 0:n.className,{"tabs__item--active":q===e})}),null!=t?t:e)))),n?(0,r.cloneElement)(f.filter((e=>e.props.value===q))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},f.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==q})))))}function d(e){const t=(0,o.Z)();return r.createElement(c,m({key:String(t)},e))}},21224:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/openmetrics_prometheus_01_configuration_host-1501db778b5122e7423ee99d86f6aadd.png"},82093:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/openmetrics_prometheus_01_configuration_service-e2f7f3657749df4f5a3fa564e7225792.png"},33649:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/openmetrics_prometheus_01_monitoring-357652f7d0bae2d7478e0be66e187f22.png"}}]);