Report publication rules \{#publication_rules\}
=========================

The \"Reporting \> Business Intelligence \> Publication rules\” menu
allows you to publish the reports generated by CBIS on different
platforms using different protocols.

In order to publish all the generated reports on the monitoring server,
a default rule must be defined using SFTP.

On the monitoring server
------------------------

A system user \"centreonBI\" user has been created. Set a password for
this user for future SSH communications between the two servers:

    passwd centreonBI

On the reporting server
-----------------------

Generate SSH keys for the system user \"centreonBI\" in order to avoid
using the password when CBIS copies the generated reports onto the
monitoring server.:

    su - centreonBI
    ssh-keygen
      Enter file in which to save the key (/home/centreonBI/.ssh/id_rsa):
      > Created directory '/usr/local/centreon-bi/.ssh'.
      > Enter passphrase (empty for no passphrase):
      > Enter same passphrase again:
      > Your identification has been saved in /home/centreonBI/.ssh/id_rsa.

::: \{.note\}
::: \{.title\}
Note
:::

At the \"Enter passphrase\" request, confirm without entering a
passphrase.
:::

Transfer the key to the **Centreon** server. The **centreonBI** user
must be configured with a password on the monitoring server):

    ssh-copy-id -i ~/.ssh/id_rsa.pub centreonBI@\{MONITORING_IP_ADDRESS\}

Test the SSH connection from the reporting server:

    ssh centreonBI@\{MONITORING_IP_ADDRESS\}

You should be able to connect without entering any password.

On the interface Centreon
-------------------------

In the \"Reporting \> Business Intelligence \> Publication rules\" menu of
Centreon, edit the \"default\" publication rule and specify the
following configuration:

  --------------------------------------------------------------------------------
  **Field**                        **Value**
  -------------------------------- -----------------------------------------------
  Name                             Default

  Publication protocol             SFTP

  Global                           \(x\) Yes

  Description                      Default publication rule

  Host                             **\<Centreon server IP address\>**

  Port                             22

  Authentication type              User/Key

  User                             centreonBI

  Path to the SSH key              /home/centreonBI/.ssh/id\_rsa

  Passphrase for SSH key           

  Confirm passphrase for SSH key   

  Root directory                   /var/lib/centreon/centreon-bi-server/archives

  Subdirectory                     \@JOBNAME@
  --------------------------------------------------------------------------------

Click the \"Test\" button to validate the configuration and save the
form.

Go to the next chapter to continue the installation.
